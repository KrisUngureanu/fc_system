{"version":3,"file":"or3-module.js","mappings":";;;;;;;;;;;;;;;;AAA+B;AAC/B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,+BAA+B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAAoB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gKAAgK;AAChK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yFAAyF,aAAa;AACtG;AACA;AACA,sFAAsF,aAAa;AACnG;AACA;AACA,sFAAsF,aAAa;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI,gDAAU,wBAAwB,kDAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,gIAAgI;AAC1J;AACA;AACA,0BAA0B,gIAAgI;AAC1J;AACA;AACA;AACA;AACA,gBAAgB,sJAAsJ;AACtK;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,KAAK,sBAAsB,UAAU,GAAG,OAAO;AAC/F;AACA;AACA;AACA,6BAA6B,OAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,KAAK,sBAAsB,UAAU,GAAG,OAAO;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,KAAK,sBAAsB,SAAS,GAAG,MAAM;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,KAAK,sBAAsB,SAAS,GAAG,MAAM;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,+FAA+F;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+GAA+G;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,mEAAmE,eAAe;AAClF,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,gBAAgB,+CAA+C;AAC/D,IAAI,6CAA6C;AACjD,IAAI,+CAA+C;AACnD,IAAI,kDAAkD;AACtD,IAAI,sDAAsD;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,mEAAmE,eAAe;AAClF,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN,8CAA8C,iBAAiB,kBAAkB;AACjF;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,MAAM,EAAE,KAAK;AACpC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,+BAA+B;AACvC,QAAQ,+BAA+B;AACvC,QAAQ,+BAA+B;AACvC,QAAQ;AACR;AACA,KAAK;AACL;AACA;AACA,QAAQ,iCAAiC;AACzC,QAAQ,+BAA+B;AACvC,QAAQ,iCAAiC;AACzC,QAAQ;AACR;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB,YAAY,UAAU,2BAA2B,YAAY,2BAA2B;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,iBAAiB,kBAAkB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAW,mBAAmB;AACpE,GAAG;AACH;AACA;AACA;AACA;AACA,sCAAsC,WAAW,mBAAmB;AACpE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC57BsC;AACtC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,MAAM;AACN;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,MAAM;AACN;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0CAA0C;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACrH4C;AAC5C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,EAAE,gDAAU;AACZ,GAAG,2DAAqB;AACxB;AACA,oEAAoE;AACpE,+DAA+D;AAC/D;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,oDAAc;AACrB;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC7JO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;AC/GO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC1D+B;AAC/B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,kEAAkE;AACvG;AACA;AACA;AACA,kCAAkC;AAClC;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,kBAAkB,8CAAQ;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;;;;;;;;AC7E4C;AACP;AACA;AACG;AACK;AAC7C;AACO,kCAAkC,gDAAQ;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gDAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,IAAI,oDAAc;AAClB,kEAAkE,8CAAQ;AAC1E;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,cAAc,mDAAmD;AACjE;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,8BAA8B;AAChE;AACA,iCAAiC,wDAAwD;AACzF;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA,iCAAiC,eAAe;AAChD;AACA,oCAAoC,yCAAyC;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,kLAAkL;AAClO;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,IAAI,oDAAc;AAClB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,2DAAqB;AAC1B;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,2DAAqB;AAC1B;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,SAAS;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP,uBAAuB,UAAU;AACjC,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT,kDAAkD,2BAA2B;AAC7E,4CAA4C,2BAA2B;AACvE;AACA;AACA;AACA,2CAA2C,2BAA2B;AACtE,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,gBAAgB,iBAAiB;AACpG,QAAQ;AACR;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,sCAAsC;AACtC;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,gBAAgB;AAChB,OAAO;AACP,gBAAgB;AAChB;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,2BAA2B;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,yEAAyE,mGAAmG,aAAa;AACzL,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,iDAAiD,gCAAgC,kCAAkC;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,kDAAkD;AAClD;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,iDAAiD,gCAAgC,kCAAkC;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,qDAAqD;AACrD;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,iDAAiD,gCAAgC,kCAAkC;AACnH,aAAa;AACb,kDAAkD,4FAA4F;AAC9I;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,mCAAmC,cAAc,yEAAyE,iFAAiF;AAC3M;AACA;AACA;AACA,MAAM,2BAA2B;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM,uDAAiB;AACvB;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM,6BAA6B;AACnC;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,OAAO,uDAAiB;AACxB;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA,iCAAiC,6BAA6B;AAC9D;AACA;AACA;AACA;AACA;AACA,KAAK,sEAA6B;AAClC,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,yBAAyB,gBAAgB;AACzC;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,QAAQ;AACR;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA,OAAO;AACP,iBAAiB,sBAAsB;AACvC,MAAM;AACN,eAAe,YAAY;AAC3B,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,WAAW;AACX,iDAAiD;AACjD;AACA;AACA,QAAQ;AACR,OAAO;AACP;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,0BAA0B;AACtE;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,uDAAuD,cAAc;AACrE;AACA,2DAA2D,iBAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,kBAAkB;AAC/D;AACA,oEAAoE;AACpE,2DAA2D,kCAAkC;AAC7F,0EAA0E;AAC1E;AACA,qCAAqC;AACrC;AACA,sCAAsC;AACtC;AACA,uCAAuC,iBAAiB;AACxD;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,qBAAqB,cAAc;AACnC;AACA,sBAAsB,cAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,IAAI,2DAAqB;AACzB;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM,gDAAU,eAAe,gDAAU;AACzC;AACA,OAAO;AACP,MAAM,oDAAc;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,uEAA6B;AAC1C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA,aAAa,2EAAiC;AAC9C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA,aAAa,0EAAgC;AAC7C;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,4CAA4C,wDAAkB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA,yBAAyB;AACzB,yBAAyB;AACzB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA,gDAAgD;AAChD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA,aAAa;AACb,YAAY,gDAAU,sBAAsB,gDAAU;AACtD;AACA;AACA,WAAW;AACX;AACA,WAAW,oDAAc;AACzB;AACA,WAAW;AACX,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,gFAAmC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY,IAAI,2EAAiC;AACxF;AACA;AACA;AACA,WAAW,oIAAoI;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8CAAQ;AACvD;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,wCAAwC,qDAAe;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,oDAAc,CAAC,2EAAiC;AACxD;AACA;AACA;AACA;AACA,wBAAwB;AACxB,QAAQ;AACR,OAAO,gDAAU,CAAC,0EAAgC,EAAE,gDAAU;AAC9D;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,gFAAmC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY,IAAI,2EAAiC;AACxF;AACA;AACA;AACA,WAAW,oIAAoI;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,8CAAQ;AACtD;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,wCAAwC,sDAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI,oDAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,8EAAoC;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,2EAAiC;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,UAAU,yEAA+B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY,IAAI,2EAAiC;AACxF;AACA;AACA,WAAW,oIAAoI;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,8CAAQ;AACtD;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,wCAAwC,2DAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,sBAAsB,8CAAQ;AAC9B;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gDAAU,eAAe,gDAAU;AACvC,KAAK;AACL,IAAI,oDAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,WAAW;AACpD;AACA;AACA;AACA;AACA,sEAAsE,8CAAQ;AAC9E;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,0CAA0C,4DAAsB;AAChE,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,YAAY,uEAA6B;AACzC;AACA;AACA,OAAO,oDAAc;AACrB;AACA;AACA;AACA,MAAM;AACN;AACA,YAAY,0EAAgC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB;AACA,4CAA4C,8CAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA,IAAI;AACJ,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8CAAQ;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,oDAAc,CAAC,2EAAiC;AAClD,aAAa;AACb;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,oDAAc,CAAC,8EAAoC;AACrD,aAAa;AACb;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc,CAAC,2EAAiC;AAClD,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,wEAAwE,yEAA+B;AACvG;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,gBAAgB;AAChB;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gDAAU,eAAe,gDAAU;AACvC,KAAK;AACL,2CAA2C,8CAAQ;AACnD;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB,kBAAkB,eAAe;AACjC,kDAAkD,8CAAQ;AAC1D;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,2EAAiC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,sDAAgB;AACxD,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,yDAAmB;AAC3D,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,UAAU,uEAA6B;AACvC;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,UAAU,2EAAiC;AAC3C;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,YAAY;AACZ,WAAW,gDAAU,sBAAsB,gDAAU;AACrD;AACA,GAAG,wBAAwB,4CAA4C;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,2EAAiC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,8CAAQ;AAC9C,KAAK,2DAAqB;AAC1B;AACA,2BAA2B,gDAAU;AACrC,QAAQ;AACR;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS,2EAAiC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,+EAAqC;AAC/C;AACA;AACA;AACA;AACA;AACA,sEAAsE,8CAAQ;AAC9E;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACtsG+B;AACc;AAChB;AAC7B;AACO;AACP;AACA;AACA;AACA;AACA;AACA,cAAc,uDAAiB;AAC/B;AACA;AACA,EAAE,kDAAY;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,6DAAgB;AAClB;AACA;AACA,sBAAsB,wCAAG;AACzB;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,GAAG;AACH;AACA;AACA,wBAAwB,8BAA8B;AACtD;AACA;AACA,GAAG;AACH;AACA;AACA,wBAAwB,8BAA8B;AACtD;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0BAA0B;AAC3D,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6IAA6I,KAAK;AAClJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,8CAAQ;AACjB;AACA;AACA;AACA;AACA,GAAG,gDAAU;AACb;AACA;AACA;AACA;AACA,mGAAmG,8CAAQ;AAC3G,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,MAAM;AACN,KAAK,gDAAU;AACf;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gJAAgJ,KAAK;AACrJ;AACA,cAAc,sBAAsB,8CAAQ;AAC5C;AACA,GAAG,gDAAU;AACb;AACA;AACA,4BAA4B,+CAAU,EAAE,6CAAQ;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8CAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN,KAAK,gDAAU;AACf;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gDAAU;AACZ;AACA;AACA,KAAK,gDAAU;AACf;AACA;AACA,KAAK,gDAAU;AACf;AACA,kGAAkG,8CAAQ;AAC1G,KAAK;AACL,IAAI,yDAAmB;AACvB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,KAAK;AACL,IAAI,gDAAU;AACd;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,gDAAU;AACb,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8CAAQ;AACxB;AACA,KAAK,gDAAU;AACf;AACA;AACA;AACA,OAAO,yDAAmB;AAC1B;AACA;AACA,QAAQ;AACR,QAAQ;AACR,MAAM,gDAAU;AAChB;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,EAAE,gDAAU;AACZ;AACA;AACA;AACA,gDAAgD,mDAAmD,WAAW;AAC9G,6CAA6C;AAC7C,qBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA,wDAAwD,qDAAe,gFAAgF,qDAAe,0BAA0B,qDAAe;AAC/M;AACA;AACA;AACA,kDAAkD,eAAe;AACjE;AACA;AACA;AACA;AACA,yFAAyF,uBAAuB,qDAAe;AAC/H;AACA,oCAAoC,kBAAkB,8CAA8C,qBAAqB;AACzH;AACA;AACA,qEAAqE,uBAAuB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,OAAO,gDAAU;AACjB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,0GAA0G,8CAAQ;AAClH;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,8CAAQ;AAChF;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,6DAAgB;AAClB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9c4C;AACD;AACE;AACV;AACc;AACZ;AACrC;AACyC;AACH;AACO;AACR;AACA;AACE;AACV;AACE;AACkB;AACF;AAChB;AAC/B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,kDAAY;AACd,4BAA4B,qCAAqC;AACjE;AACA;AACA;AACA;AACA;AACA,EAAE,6DAAgB;AAClB,qBAAqB,oEAAuB;AAC5C;AACA,qBAAqB,iDAAO;AAC5B;AACA;AACA,gBAAgB,sDAAU;AAC1B;AACA;AACA,sBAAsB,mDAAQ;AAC9B;AACA;AACA,0BAA0B,wDAAmB;AAC7C;AACA;AACA;AACA,sBAAsB,2CAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,gDAAO;AAC5B;AACA;AACA,mBAAmB,8CAAM;AACzB;AACA;AACA;AACA,0BAA0B,4DAAa;AACvC;AACA;AACA;AACA,sBAAsB,oDAAS;AAC/B;AACA;AACA;AACA,qBAAqB,iDAAQ;AAC7B;AACA;AACA;AACA,kBAAkB,2CAAI;AACtB;AACA;AACA,sBAAsB,yCAAG;AACzB;AACA,kBAAkB,6DAAa;AAC/B;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH,EAAE,qDAAa;AACf;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG,gDAAU;AACb;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE,wEAAyB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,4CAA4C,gCAAgC;AAC5E;AACA;AACA,wBAAwB;AACxB,eAAe;AACf,KAAK;AACL,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,GAAG,2DAAqB;AACxB;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,gBAAgB,oDAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gJAAgJ;AAChJ;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,oDAAoD,KAAK,SAAS,YAAY;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,IAAI;AACR;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,yBAAyB,WAAW,UAAU,IAAI,UAAU;AACtG;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL,oBAAoB;AACpB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,2DAAqB;AAC1B;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE,cAAc;AACd;AACA;AACA;AACA,wEAAwE,8CAAQ;AAChF,MAAM;AACN;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,0CAA0C;AAC1C;AACA,sBAAsB,cAAc,MAAM;AAC1C,mDAAmD;AACnD,yCAAyC;AACzC;AACA,4BAA4B;AAC5B;AACA;AACA,GAAG;AACH;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,WAAW,EAAE,IAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;;ACrmB4C;AACC;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gDAAU,CAAC,yFAA+C,EAAE,kDAAY;AAC5E;AACA,IAAI,gDAAU,CAAC,uFAA6C,EAAE,kDAAY;AAC1E;AACA,IAAI,gDAAU,CAAC,uFAA6C,EAAE,kDAAY;AAC1E;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,oDAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qCAAqC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc,CAAC,6EAAmC;AACpD,aAAa;AACb;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACvO+B;AACc;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,oDAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG,oDAAc;AACjB,aAAa,kDAAY;AACzB;AACA;AACA,IAAI;AACJ,GAAG,oDAAc;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,kDAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gDAAU;AACrB;AACA;AACA,UAAU;AACV;AACA,QAAQ;AACR,cAAc;AACd;AACA,gBAAgB,gDAAU,CAAC,0EAAgC,EAAE,gDAAU;AACvE;AACA,MAAM;AACN;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,yEAAyE,8CAAQ;AACjF,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,8CAAQ;AACjF;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA,KAAK;AACL,IAAI,gDAAU,UAAU,gDAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,iDAAiD,8CAAQ;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,MAAM,gDAAU;AAChB,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,gDAAU,eAAe,+CAAS;AAC3C;AACA,QAAQ;AACR,OAAO;AACP,OAAO;AACP,eAAe,gDAAU,WAAW,gDAAU;AAC9C;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,MAAM,gDAAU;AAChB;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,gFAAsC;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,gDAAU;AACjB;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,gCAAgC,mDAAmD;AACnF;AACA,sBAAsB,6BAA6B;AACnD,8GAA8G;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,QAAQ;AACR;AACA,2BAA2B;AAC3B,QAAQ;AACR,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO,gDAAU;AACjB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC/X+B;AAC/B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG,gDAAU;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,IAAI;AACJ,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,kDAAkD;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;;AC9O4C;AAC5C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,oDAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,oDAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,2DAAqB;AAC5B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU;AACV;AACA;AACA,QAAQ;AACR,OAAO;AACP;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA,MAAM;AACN,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,oDAAc;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AC/P4C;AACC;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,aAAa,kFAAwC;AACrD,GAAG,yDAAmB;AACtB;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gEAAgE;AACnF;AACA;AACA;AACA,mBAAmB,8DAA8D;AACjF;AACA;AACA;AACA,mBAAmB,iEAAiE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,yBAAyB,yCAAyC;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA,MAAM;AACN,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,oDAAc,CAAC,6EAAmC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;;;AChT4C;AACC;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,kDAAkD,8CAAQ;AAC1D,YAAY,2DAAqB;AACjC;AACA,+DAA+D;AAC/D;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,8CAAQ;AACtE,wBAAwB,2DAAqB;AAC7C;AACA;AACA,2EAA2E;AAC3E,iFAAiF;AACjF,8BAA8B;AAC9B,sCAAsC,0EAAgC,EAAE,gDAAU;AAClF;AACA,yBAAyB;AACzB,qBAAqB;AACrB,kBAAkB;AAClB,+CAA+C,gDAAU;AACzD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8CAAQ;AACxD,YAAY,2DAAqB;AACjC;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,0BAA0B,0EAAgC;AAC1D;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8CAAQ;AACxD,YAAY,2DAAqB;AACjC;AACA;AACA;AACA;AACA,8DAA8D,8CAAQ;AACtE,wBAAwB,2DAAqB;AAC7C;AACA;AACA,2EAA2E;AAC3E,iFAAiF;AACjF,8BAA8B;AAC9B,sCAAsC,0EAAgC;AACtE;AACA,yBAAyB;AACzB,qBAAqB;AACrB,kBAAkB;AAClB,0BAA0B,0EAAgC;AAC1D;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA,oBAAoB,2DAAqB;AACzC;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB,cAAc;AACd;AACA;AACA,SAAS;AACT;AACA;;;;;;;;;;;;;;;ACvH+B;AAC/B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,8CAAQ;AAC1D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;;;;;;;;;;;;;;;;ACpC+C;AAChB;AACF;AAC7B;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,6BAA6B;AAC/C;AACA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,aAAa,WAAW,8CAAQ;AAChC;AACA;AACA;AACA,yBAAyB,qBAAqB;AAC9C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,oDAAc;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,qBAAqB;AAC9C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;AACA,mBAAmB,8CAAQ;AAC3B;AACA;AACA,OAAO;AACP;AACA,oDAAoD,8CAAQ;AAC5D;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,QAAQ;AACR;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP,MAAM,oDAAc;AACpB;AACA,OAAO,gDAAU;AACjB;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mHAAmH,8CAAQ;AAC3H;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,mHAAmH,8CAAQ;AAC3H;AACA;AACA;AACA;AACA,OAAO;AACP,8CAA8C,8CAAQ;AACtD;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,gDAAgD,2DAAqB;AACrE,kBAAkB,+CAAU,EAAE,6CAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,8CAAQ;AACtB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,QAAQ,gDAAU,QAAQ,gDAAU;AACpC;AACA,mBAAmB;AACnB;AACA;AACA,OAAO;AACP;AACA,OAAO,gDAAU,QAAQ,gDAAU;AACnC,kBAAkB;AAClB;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,qCAAqC,0CAA0C;AAC/E,8GAA8G,wBAAwB,mFAAmF,YAAY;AACrO;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,sDAAsD,iBAAiB;AACzF,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,uHAAuH,2EAAiC;AACxJ;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,MAAM,yDAAmB;AACzB,OAAO;AACP,MAAM,gDAAU;AAChB,OAAO;AACP,MAAM,iDAAW;AACjB,OAAO;AACP;AACA,MAAM,wDAAkB;AACxB,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP,MAAM,gDAAU;AAChB,OAAO;AACP,MAAM,gDAAU,iBAAiB,gDAAU;AAC3C,OAAO;AACP,MAAM,gDAAU,mBAAmB,kDAAY;AAC/C,OAAO;AACP,MAAM,gDAAU;AAChB,OAAO;AACP,MAAM,gDAAU,qBAAqB,gDAAU;AAC/C,OAAO;AACP,MAAM,gDAAU,uBAAuB,kDAAY;AACnD,OAAO;AACP,MAAM,gDAAU;AAChB,OAAO;AACP;AACA,MAAM,oDAAc;AACpB,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP,gCAAgC,mBAAmB;AACnD,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA,QAAQ;AACR;AACA,OAAO,oDAAc;AACrB,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA,OAAO;AACP,MAAM,uDAAiB;AACvB,OAAO;AACP,MAAM,sDAAgB;AACtB;AACA,cAAc,kCAAkC;AAChD;AACA,cAAc,iBAAiB;AAC/B;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8CAAQ;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACpcsC;AACL;AACjC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,eAAe;AACf;AACA,KAAK,2DAAqB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,SAAS;AACT,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0CAA0C;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8CAAQ;AAChC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,kCAAkC,kDAAkD;AACpF;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACjQqC;AACN;AACc;AACL;AACxC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG,sEAA6B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,UAAU;AACV;AACA;AACA,UAAU;AACV,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,QAAQ;AACR,QAAQ;AACR;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,WAAW;AACX;AACA;AACA,WAAW;AACX,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,cAAc;AACd;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;AACA,UAAU,4DAAoB;AAC9B;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,wCAAwC,6DAAqB;AAC7D;AACA,SAAS,4DAAoB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,4DAAoB,IAAI,6DAAqB;AACnG;AACA;AACA;AACA;AACA;AACA,OAAO,6DAAqB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,6DAAqB;AAClE;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,6CAA6C,6DAAqB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,8CAA8C,6DAAqB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,8CAA8C,6DAAqB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA,UAAU,4DAAoB;AAC9B;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,uEAA6B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,kBAAkB;AAClF;AACA,+CAA+C,sDAAgB;AAC/D,WAAW;AACX;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,UAAU;AACV;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,uCAAuC,wBAAwB;AAC/D,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wBAAwB;AAC3D;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,uCAAuC,wBAAwB;AAC/D,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,8BAA8B,kDAAkD;AAChF,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG,gBAAgB;AACjH;AACA,8DAA8D,iBAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,qCAAqC,gBAAgB;AACrD;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,gBAAgB;AAChB;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,WAAW;AACX;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gBAAgB;AACzC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mDAAmD;AACxF;AACA;AACA,4BAA4B,mDAAmD;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,UAAU;AACtD;AACA;AACA;AACA,4CAA4C,UAAU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,wCAAwC;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,mBAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,gDAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,uDAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,kBAAkB,uDAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA,wBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAS;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,KAAK,gDAAU;AACf;AACA,IAAI;AACJ,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0BAA0B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,yBAAyB,4CAA4C;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,yBAAyB,gDAAgD;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,uDAAiB;AAC3B;AACA;AACA;AACA;AACA;AACA,eAAe,uDAAiB;AAChC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,yBAAyB,+DAA+D;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0BAA0B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,yBAAyB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0BAA0B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,4BAA4B,yBAAyB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,eAAe,8CAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,oBAAoB,qBAAqB;AACzC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,sDAAgB;AACrB;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,qBAAqB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sBAAsB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,sBAAsB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,WAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC5zDO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;AC7EO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACtD6C;AACA;AAC7C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,oEAA+B;AACjC,EAAE,wEAAmC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,mEAA8B,CAAC,0EAAqC;AACjF,WAAW,mEAA8B;AACzC,WAAW,uEAAkC;AAC7C;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,yBAAyB,YAAY;AACrC;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,oEAA+B;AAClC,GAAG,wEAAmC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,mEAA8B,CAAC,0EAAqC;AACjF,WAAW,mEAA8B;AACzC,WAAW,uEAAkC;AAC7C;AACA;AACA,qBAAqB,cAAc;AACnC,SAAS;AACT,qBAAqB,cAAc;AACnC;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,WAAW,yEAA+B;AAC1C;AACA;AACA,8FAA8F,eAAe,gBAAgB;AAC7H;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,yEAA+B;AAC1C;AACA;AACA,8FAA8F,eAAe,gBAAgB;AAC7H;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sBAAsB,sBAAsB,wBAAwB,wBAAwB;AAC9H,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA,aAAa,sBAAsB;AACnC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,6DAA6D,EAAE;AAC/D;AACA;AACA,MAAM;AACN;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;UCtWA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;;ACNqC;AACQ;AACd;AACE;AACjC;AACqD","sources":["webpack://or3web/./analytic.js","webpack://or3web/./archive.js","webpack://or3web/./autocomplete.js","webpack://or3web/./errors.js","webpack://or3web/./events.js","webpack://or3web/./help.js","webpack://or3web/./ifc.js","webpack://or3web/./login.js","webpack://or3web/./main.js","webpack://or3web/./monitor.js","webpack://or3web/./navigation.js","webpack://or3web/./nca.js","webpack://or3web/./notifications.js","webpack://or3web/./orders.js","webpack://or3web/./personalPhoto.js","webpack://or3web/./ping.js","webpack://or3web/./polling.js","webpack://or3web/./processes.js","webpack://or3web/./tables.js","webpack://or3web/./tooltip.js","webpack://or3web/./translation.js","webpack://or3web/./util.js","webpack://or3web/webpack/bootstrap","webpack://or3web/webpack/runtime/define property getters","webpack://or3web/webpack/runtime/hasOwnProperty shorthand","webpack://or3web/webpack/runtime/make namespace object","webpack://or3web/./index.js"],"sourcesContent":["import {Util} from './util.js';\r\n\r\nexport class Analytic {\r\n//\tOLAP_URL = \"http://10.61.42.157:7303/analytic/rest/\";\r\n\t// OLAP_URL = \"http://192.168.13.170:8081/analytic/rest/\";\r\n//\tOLAP_URL = \"http://145.249.246.98:8081/analytic/rest/\";\r\n\tOLAP_URL = \"\";\r\n\tnameX = \"Category\";\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t\tthis.OLAP_URL = app.OLAP_URL;\r\n\t\t$.extend($.fn.combotree.defaults, {width: '260px', height: '22px'});\r\n\t}\r\n\t\r\n\tinit(cont) {\t\r\n\t\tconsole.log(\"analitic olap port \" + this.OLAP_URL);\r\n\t\tlet this_ = this;\r\n\r\n\t\tif (cont == null) cont = $('body');\r\n\t\tvar analytics = cont.find('.or3-analytic');\r\n\t\tfor (var i=0; i<analytics.length; i++) {\r\n\t\t\tvar analytic = $(analytics.get(i));\r\n\t\t\tthis_.analyticInit(analytic.attr(\"id\"));\r\n\t\t}\r\n\t}\r\n\r\n\tgetOlapPort() {\r\n\t\tlet this_ = this;\r\n\t\tlet par = {\"sfunc\":1,\"cls\":\"MainPage\",\"name\":\"otherMethods\", \"arg0\":this_.app.userId, \"arg1\": \"getOlapPort\"};\r\n\t\tthis_.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\tconsole.log(json);\r\n\t\t\t\t\tif(json) {\r\n\t\t\t\t\t\tif(json.olapPort) {\r\n\t\t\t\t\t\t\tthis_.OLAP_URL = json.olapPort;\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t} \r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t}\r\n\t\r\n\tanalyticInit(id) {\r\n\t\tlet this_ = this;\r\n\r\n\t\tvar xAxes;\r\n\t\tvar yAxes;\r\n\t\tvar zAxis;\r\n\t\tvar nodesNamesX;\r\n\t\tvar nodesNamesY;\r\n\t\tvar nodesNamesZ;\r\n\t\tvar parentXId;\r\n\t\tvar parentYId;\r\n\t\tvar selectedZIds = {};\r\n\t\tvar fact;\r\n\t\tvar aggType;\r\n\t\tvar aggField;\r\n\t\tvar chartContainer = {};\r\n\t\r\n\t\t$('.analytic-dimension').next().next().insertAfter($('.analytic-tree:last'));\r\n\t\t$('.analytic-dimension').next().insertAfter($('.analytic-tree:last'));\r\n\t\t$('.analytic-dimension').insertAfter($('.analytic-tree:last'));\r\n\t\t\r\n\t\t$('#type_' + id).next().remove();\r\n\t\t$('#type_' + id).remove();\r\n\t\t$('#xaxes_' + id).next().remove();\r\n\t\t$('#xaxes_' + id).remove();\r\n\t\t$('#yaxes_' + id).next().remove();\r\n\t\t$('#yaxes_' + id).remove();\r\n\t\t\r\n\t\t// удаляем линшие стрелочки\r\n\t\t$('.analytic-dimension-title:first p').text('Выберите тип диаграммы');\r\n\t\t$('.analytic-dimension-title .arrow-width').remove();\r\n\t\t$('.analytic-cnt-coll-pan .analytic-dimension-title').get(1).remove();\r\n\t\t$('.analytic-cnt-coll-pan hr').remove();\r\n\t\t$('#filter_' + id).next().remove();\r\n\t\t$('#filter_' + id).remove();\r\n\t\t\r\n\t\r\n\t\tlet splitPane = $('<div id=\"analytic-split-pane\" class=\"easyui-layout\" data-options=\"fit:true\">');\r\n\t\tlet westDiv = $('<div id=\"analytic-params-pane\" data-options=\"region:\\'west\\', collapsed:true, title: \\'Параметры диаграммы\\', split:true\" style=\"width:400px;\"></div>');\r\n    \tlet centerDiv = $('<div id=\"analytic-chart-pane\" data-options=\"region:\\'center\\', split:true\"></div>');\r\n\t\tsplitPane.append(westDiv);\r\n\t\tsplitPane.append(centerDiv);\r\n\t\twestDiv.append($('#cnt0acc_' + id).removeClass('cnt-coll-pan-v'));\r\n\t\tcenterDiv.append($('#axes_title_' + id));\r\n\t\tcenterDiv.append($('#' + id));\r\n\t\t\r\n\t\t$('#ui-body > div').empty();\r\n\t\t$('#ui-body > div').append(splitPane);\r\n\t\t$('#analytic-split-pane').layout();\r\n\t\t\r\n\t\t$('.icon-clearAll').after('<span>Снять все</span>');\r\n\t\t$('.icon-selectAll').after('<span>Выделить все</span>');\r\n\r\n\t\tvar combo1 = $('<input id=\"type_' + id + '\" class=\"easyui-combobox\" style=\"width:100%; height: 35px;\"/>');\r\n\t\tcombo1.insertAfter($('.analytic-dimension-title'));\r\n\t\t$('#type_' + id).combobox();\r\n\t\tcombo1 = $('<input id=\"xaxes_' + id + '\" class=\"easyui-combobox\" style=\"width:100%; height: 35px;\"/>');\r\n\t\tcombo1.insertBefore($('#x_' + id));\r\n\t\t$('#xaxes_' + id).combobox();\r\n\t\tcombo1 = $('<input id=\"yaxes_' + id + '\" class=\"easyui-combobox\" style=\"width:100%; height: 35px;\"/>');\r\n\t\tcombo1.insertBefore($('#y_' + id));\r\n\t\t$('#yaxes_' + id).combobox();\r\n\r\n\t\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: window.mainUrl + \"&cmd=getAnalyticProps&id=\" + id,\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\txAxes = data.xAxisId;\r\n\t\t\t\tyAxes = data.yAxisId;\r\n\t\t\t\tzAxis = data.zAxisId;\r\n\t\t\t\tparentXId = data.firstXAxis;\r\n\t\t\t\tparentYId = data.firstYAxis;\r\n\t\t\t\tfact = data.fact;\r\n\t\t\t\tchartContainer.type = data.type;\r\n\t\t\t\tchartContainer.showLegend = data.showLegend;\r\n\t\t\t\taggType = data.aggType;\r\n\t\t\t\taggField = data.aggField;\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: this_.OLAP_URL + \"dim/dimension/\" + parentXId.id + \"?fact=\" + fact,\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tnodesNamesX = data;\r\n\t\t\t},\r\n\t\t\terror: function (ex) {\r\n\t\t\t\tconsole.log(ex);\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: this_.OLAP_URL + \"dim/dimension/\" + parentYId.id + \"?fact=\" + fact,\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tnodesNamesY = data;\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\t\r\n\t\tzAxis.forEach(filter => {\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"GET\",\r\n\t\t\t\turl: this_.OLAP_URL + \"dim/dimension/\" + filter.id + \"?fact=\" + fact,\r\n\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\tnodesNamesZ = data;\r\n\t\t\t\t},\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tasync: false\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tvar onSelect = function () {\r\n\t\t\tlet checkedX = $('#x_' + id).tree('getChecked');\r\n\t\t\tlet checkedY = $('#y_' + id).tree('getChecked');\r\n\t\t\tlet checkedZs = {};\r\n\t\t\t\r\n\t\t\tzAxis.forEach(filter => {\r\n\t\t\t\tlet tree = $('#filter_' + id + '_' + filter.id).combotree('tree');\r\n\t\t\t\tlet checkedZ = tree.tree('getChecked');\r\n\t\t\t\tcheckedZs[filter.id] = checkedZ;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (!checkedX.length || !checkedY.length) {\r\n\t\t\t\tUtil.alert(\"Выберите измерения!\", Util.WARNING);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\tlet newNodesNamesX = [];\r\n\t\t\tlet newNodesNamesY = [];\r\n\t\t\tlet newSelectedZIds = {};\r\n\t\t\t\r\n\t\t\tfor (var i in checkedX) {\r\n\t\t\t\tnewNodesNamesX.push({ id: checkedX[i].id, name: checkedX[i].text, isLeaf: $('#x_' + id).tree('isLeaf', checkedX[i].target), color: checkedX[i].color });\r\n\t\t\t}\r\n\t\t\tfor (i in checkedY) {\r\n\t\t\t\tnewNodesNamesY.push({ id: checkedY[i].id, name: checkedY[i].text, isLeaf: $('#y_' + id).tree('isLeaf', checkedY[i].target), color: checkedY[i].color });\r\n\t\t\t}\r\n\t\t\t$.each(checkedZs, function(filterId, checkedZ) {\r\n\t\t\t\tlet arr = [];\r\n\t\t\t\tfor (i in checkedZ) {\r\n\t\t\t\t\tarr.push({ id: checkedZ[i].id, name: checkedZ[i].text, isLeaf: $('#filter_' + id + '_' + filterId).tree('isLeaf', checkedZ[i].target), color: checkedZ[i].color });\r\n\t\t\t\t}\r\n\t\t\t\tnewSelectedZIds[filterId] = arr;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (JSON.stringify(nodesNamesX) === JSON.stringify(newNodesNamesX)\r\n\t\t\t\t&& JSON.stringify(nodesNamesY) === JSON.stringify(newNodesNamesY)\r\n\t\t\t\t&& JSON.stringify(selectedZIds) === JSON.stringify(newSelectedZIds)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tnodesNamesX = newNodesNamesX;\r\n\t\t\tnodesNamesY = newNodesNamesY;\r\n\t\t\tselectedZIds = newSelectedZIds;\r\n\t\t\tthis_.loadAnalytic(id, chartContainer, parentXId, parentYId, zAxis, nodesNamesX, nodesNamesY, selectedZIds, fact, aggType, aggField);\r\n\t\t\tthis_.initAxesTitle(id, parentXId, parentYId);\r\n\t\t}\r\n\t\t$('#btn_' + id).click(onSelect);\r\n\t\r\n\t\tthis_.initAxesTitle(id, parentXId, parentYId);\r\n\t\tthis_.initBtn('#btn_' + id);\r\n\t\tthis_.initTglLegBtn('#tgl_leg_' + id, chartContainer);\r\n\t\t$('#hide_btn_' + id).click(() => this_.hideBtn(id));\r\n\t\tthis_.initCombobox(id, xAxes, fact, nodesNamesX, \"x\", parentXId);\r\n\t\tthis_.initCombobox(id, yAxes, fact, nodesNamesY, \"y\", parentYId);\r\n\t\tif (zAxis.length > 0) {\r\n\t\t\tzAxis.forEach(filter => {\r\n\t\t\t\tthis_.loadNodes(id, fact, nodesNamesZ, filter.id, filter.value, \"filter\", true);\r\n\t\t\t\tselectedZIds[filter.id] = [];\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis_.initSelectBtns(id);\r\n\t\r\n\t\tthis_.loadAnalytic(id, chartContainer, parentXId, parentYId, zAxis, nodesNamesX, nodesNamesY, selectedZIds, fact, aggType, aggField);\r\n\t\r\n\t\tfunction toggleLegClick() {\r\n\t\t\tif (chartContainer.chart.legend.disabled) {\r\n\t\t\t\tchartContainer.showLegend = true;\r\n\t\t\t\tthis_.setShowLegend(chartContainer, true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tchartContainer.showLegend = false;\r\n\t\t\t\tthis_.setShowLegend(chartContainer, false);\r\n\t\t\t}\r\n\t\t\tthis_.initTglLegBtn('#tgl_leg_' + id, chartContainer);\r\n\t\t}\r\n\t\t$('#tgl_leg_' + id).click(toggleLegClick);\r\n\t\r\n\t\t$('#' + id).parent().click(() => this_.hideBtn(id));\r\n\t}\r\n\t\r\n\tprocessOut(hoveredSeries, chart) {\r\n\t\tchart.series.each(function (series) {\r\n\t\t\tseries.segments.each(function (segment) {\r\n\t\t\t\tsegment.setState(\"default\");\r\n\t\t\t})\r\n\t\t\tseries.bulletsContainer.setState(\"default\");\r\n\t\t});\r\n\t}\r\n\t\r\n\tprocessOver(hoveredSeries, chart) {\r\n\t\thoveredSeries.toFront();\r\n\t\r\n\t\thoveredSeries.segments.each(function (segment) {\r\n\t\t\tsegment.setState(\"hover\");\r\n\t\t});\r\n\t\r\n\t\tchart.series.each(function (series) {\r\n\t\t\tif (series != hoveredSeries) {\r\n\t\t\t\tseries.segments.each(function (segment) {\r\n\t\t\t\t\tsegment.setState(\"dimmed\");\r\n\t\t\t\t});\r\n\t\t\t\tseries.bulletsContainer.setState(\"dimmed\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Create series\r\n\tcreateBarSeries(chart, nodeNameY, i) {\r\n\t\tlet field = nodeNameY.id;\r\n\t\tlet name = nodeNameY.name;\r\n\t\r\n\t\r\n\t\t// Set up series\r\n\t\tvar series = chart.series.push(new am4charts.ColumnSeries());\r\n\t\r\n\t\r\n\t\tseries.columns.template.propertyFields.fill = \"color\" + i;\r\n\t\tseries.columns.template.propertyFields.stroke = \"color\" + i;\r\n\t\r\n\t\tseries.name = name;\r\n\t\tseries.dataFields.valueY = field;\r\n\t\tseries.dataFields.categoryX = this.nameX;\r\n\t\tseries.sequencedInterpolation = true;\r\n\t\r\n\t\t// Make it stacked\r\n\t\tseries.stacked = true;\r\n\t\r\n\t\t// Configure columns\r\n\t\tseries.columns.template.width = am4core.percent(60);\r\n\t\tseries.columns.template.tooltipText = \"[bold]{name}[/]\\n[font-size:14px]{categoryX}: {valueY}\";\r\n\t\r\n\t\t// Add label\r\n\t\tvar labelBullet = series.bullets.push(new am4charts.LabelBullet());\r\n\t\tlabelBullet.label.text = \"{valueY}\";\r\n\t\tlabelBullet.locationY = 0.5;\r\n\t\tlabelBullet.label.hideOversized = true;\r\n\t\r\n\t\treturn series;\r\n\t}\r\n\t\r\n\tcreate3DBarSeries(chart, field, name, i) {\r\n\t\tvar series = chart.series.push(new am4charts.ColumnSeries3D());\r\n\t\tseries.columns.template.propertyFields.fill = \"color\" + i;\r\n\t\tseries.columns.template.propertyFields.stroke = \"color\" + i;\r\n\t\tseries.name = name;\r\n\t\tseries.dataFields.valueY = field;\r\n\t\tseries.dataFields.categoryX = this.nameX;\r\n\t\tseries.clustered = false;\r\n\t\tseries.columns.template.tooltipText = \"[bold]{name}[/]\\n[font-size:14px]{categoryX}: {valueY}\";\r\n\t\tseries.columns.template.fillOpacity = 0.9;\r\n\t}\r\n\t\r\n\tcreateLineSeries(chart, field, name, i) {\r\n\t\tlet this_ = this;\r\n\t\tvar series = chart.series.push(new am4charts.LineSeries());\r\n\t\tseries.propertyFields.fill = \"color\" + i;\r\n\t\tseries.propertyFields.stroke = \"color\" + i;\r\n\t\tseries.dataFields.dateX = this.nameX;\r\n\t\tseries.dataFields.valueY = field;\r\n\t\tseries.name = name;\r\n\t\tseries.tooltipText = \"{valueY}\";\r\n\t\tseries.tooltip.pointerOrientation = \"vertical\";\r\n\t\tseries.tooltip.background.fillOpacity = 0.5;\r\n\t\tseries.strokeWidth = 3;\r\n\t\r\n\t\tvar segment = series.segments.template;\r\n\t\tsegment.interactionsEnabled = true;\r\n\t\r\n\t\tvar hoverState = segment.states.create(\"hover\");\r\n\t\thoverState.properties.strokeWidth = 3;\r\n\t\r\n\t\tvar dimmed = segment.states.create(\"dimmed\");\r\n\t\tdimmed.properties.stroke = am4core.color(\"#dadada\");\r\n\t\r\n\t\tsegment.events.on(\"over\", function (event) {\r\n\t\t\tthis_.processOver(event.target.parent.parent.parent, chart);\r\n\t\t});\r\n\t\r\n\t\tsegment.events.on(\"out\", function (event) {\r\n\t\t\tthis_.processOut(event.target.parent.parent.parent, chart);\r\n\t\t});\r\n\t}\r\n\t\r\n\tcreateDonutSeries(chart, field, name) {\r\n\t\t// Add and configure Series\r\n\t\tvar pieSeries = chart.series.push(new am4charts.PieSeries());\r\n\t\tpieSeries.slices.template.propertyFields.fill = \"color\";\r\n\t\tpieSeries.slices.template.propertyFields.stroke = \"color\";\r\n\t\tpieSeries.name = name;\r\n\t\tpieSeries.dataFields.value = field;\r\n\t\tpieSeries.dataFields.category = this.nameX;\r\n\t\tpieSeries.slices.template.stroke = am4core.color(\"#fff\");\r\n\t\tpieSeries.slices.template.tooltipText = \"[bold]{name}[/]\\n[font-size:14px]{category}: {value}\";\r\n\t\r\n\t\t// Disabling labels and ticks on inner circle\r\n\t\tpieSeries.labels.template.disabled = true;\r\n\t\tpieSeries.ticks.template.disabled = true;\r\n\t\r\n\t\t// Disable sliding out of slices\r\n\t\tpieSeries.slices.template.states.getKey(\"hover\").properties.shiftRadius = 0;\r\n\t\tpieSeries.slices.template.states.getKey(\"hover\").properties.scale = 1.0;\r\n\t}\r\n\t\r\n\tcreatePieSeries(chart, field, name) {\r\n\t\t// Add and configure Series\r\n\t\tvar pieSeries = chart.series.push(new am4charts.PieSeries());\r\n\t\tpieSeries.slices.template.propertyFields.fill = \"color\";\r\n\t\tpieSeries.slices.template.propertyFields.stroke = \"color\";\r\n\t\tpieSeries.name = name;\r\n\t\tpieSeries.dataFields.value = field;\r\n\t\tpieSeries.dataFields.category = this.nameX;\r\n\t\tpieSeries.slices.template.stroke = am4core.color(\"#fff\");\r\n\t\tpieSeries.slices.template.strokeWidth = 2;\r\n\t\tpieSeries.slices.template.strokeOpacity = 1;\r\n\t\tpieSeries.ticks.template.disabled = true;\r\n\t\tpieSeries.labels.template.disabled = true;\r\n\t\tpieSeries.slices.template.tooltipText = \"[bold]{name}[/]\\n[font-size:14px]{category}: {value}\";\r\n\t\r\n\t\t// This creates initial animation\r\n\t\tpieSeries.hiddenState.properties.opacity = 1;\r\n\t\tpieSeries.hiddenState.properties.endAngle = -90;\r\n\t\tpieSeries.hiddenState.properties.startAngle = -90;\r\n\t}\r\n\t\r\n\tcreateLineLegend(chartContainer) {\r\n\t\tlet this_ = this;\r\n\t\tchartContainer.chart.legend = new am4charts.Legend();\r\n\t\tchartContainer.chart.legend.position = \"bottom\";\r\n\t\tchartContainer.chart.legend.scrollable = true;\r\n\t\tchartContainer.chart.legend.itemContainers.template.events.on(\"over\", function (event) {\r\n\t\t\tthis_.processOver(event.target.dataItem.dataContext, chartContainer.chart);\r\n\t\t})\r\n\t\r\n\t\tchartContainer.chart.legend.itemContainers.template.events.on(\"out\", function (event) {\r\n\t\t\tthis_.processOut(event.target.dataItem.dataContext, chartContainer.chart);\r\n\t\t})\r\n\t}\r\n\t\r\n\tcreateLegend(chartContainer, nodesNamesY) {\r\n\t\tif (chartContainer.type === \"LINE\") {\r\n\t\t\tthis.createLineLegend(chartContainer);\r\n\t\t} else {\r\n\t\t\tchartContainer.chart.legend = new am4charts.Legend();\r\n\t\t\tchartContainer.chart.legend.maxHeight = 150;\r\n\t\t\tchartContainer.chart.legend.scrollable = true;\r\n\t\t}\r\n\t\t\r\n\t\tlet legenddata = chartContainer.chart.legend.data;\r\n\t\tif (legenddata.length) {\r\n\t\t\tlet i;\r\n\t\t\tfor (i in legenddata) {\r\n\t\t\t\tlet nodeY = nodesNamesY.find(e => e.id === legenddata[i].dataFields.valueY);\r\n\t\t\t\tif (nodeY && nodeY.color)\r\n\t\t\t\t\tlegenddata[i].fill = nodeY.color;\r\n\t\t\t}\r\n\t\t} else {\r\n\t        chartContainer.chart.events.on(\"ready\", function (event) {\r\n\t        \tlet chart = event.target; \r\n\t            let series = chart.series.values;\r\n\t            chart.legend.data = series[series.length - 1].dataItems.values;\r\n\t        });\r\n\t    }\r\n\t}\r\n\t\r\n\tfillinNodes(e) {\r\n\t\tif (!e.children) {\r\n\t\t\treturn { id: e.id, text: e.text, state: e.state, checked: e._checked, color: e.color };\r\n\t\t}\r\n\t\tvar childNodes = [];\r\n\t\tfor (var i in e.children) {\r\n\t\t\tchildNodes.push(this.fillinNodes(e.children[i]));\r\n\t\t}\r\n\t\treturn { id: e.id, text: e.text, state: e.state, children: childNodes, checked: e._checked, color: e.color };\r\n\t}\r\n\t\r\n\taddNode(tree, node, data) {\r\n\t\tfor (var i in tree) {\r\n\t\t\tif (tree[i].children) this.addNode(tree[i].children, node, data);\r\n\t\t\tif (tree[i].id != node.id) continue;\r\n\t\t\tvar childNodes = [];\r\n\t\t\tfor (var j in data) {\r\n\t\t\t\tvar child = {};\r\n\t\t\t\tchild.id = data[j].id;\r\n\t\t\t\tchild.text = data[j].name;\r\n\t\t\t\tchild.state = data[j].isLeaf ? 'open' : 'closed';\r\n\t\t\t\tchild.color = data[j].color;\r\n\t\t\t\tchildNodes.push(child);\r\n\t\t\t}\r\n\t\t\ttree[i].children = childNodes;\r\n\t\t\ttree[i].state = 'open';\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\tloadNode(node, id, dimId, loading, fact, isCombo) {\r\n\t\tlet this_ = this;\r\n\t\tloading = true;\r\n\t\tlet folder = $(node.target).find('span.tree-folder');\r\n\t\tfolder.addClass('tree-loading');\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: this_.OLAP_URL + \"dim/dimension/\" + node.id + \"?fact=\" + fact,\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tvar oldNodes;\r\n\t\t\t\tif (isCombo) {\r\n\t\t\t\t\tlet tree = $(id + \"_\" + dimId).combotree('tree');\r\n\t\t\t\t\toldNodes = tree.tree('getRoots');\r\n\t\t\t\t} else {\r\n\t\t\t\t\toldNodes = $(id).tree('getRoots');\r\n\t\t\t\t}\r\n\t\t\t\tvar newNodes = oldNodes.map(this_.fillinNodes.bind(this_));\r\n\t\t\t\tthis_.addNode(newNodes, node, data)\r\n\t\t\t\tif (isCombo) {\r\n\t\t\t\t\t$(id + \"_\" + dimId).combotree('loadData', newNodes);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(id).tree('loadData', newNodes);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\tloading = false;\r\n\t\tfolder.removeClass('tree-loading');\r\n\t}\r\n\t\r\n\tonNodeClick(node) {\r\n\t\t$(this).tree('toggle', node.target);\r\n\t}\r\n\t\r\n\tinitTree(id, dimId, data, fact) {\r\n\t\tlet this_ = this;\r\n\t\tvar loading = false;\r\n\t\tvar beforeExpand = function (node) {\r\n\t\t\tif (!loading && !node.children) {\r\n\t\t\t\tthis_.loadNode(node, id, dimId, loading, fact);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t$(id).tree({ cascadeCheck: false, checkbox: true, onBeforeExpand: beforeExpand, onClick: this_.onNodeClick });\r\n\t\t$(id).tree('loadData', data);\r\n\t}\r\n\t\r\n\tinitComboTree(id, prefix, dimId, dimName, data, fact) {\r\n\t\tlet this_ = this;\r\n\t\tvar loading = false;\r\n\t\tvar beforeExpand = function (node) {\r\n\t\t\tif (!loading && !node.children) {\r\n\t\t\t\tthis_.loadNode(node, '#' + prefix + '_' + id, dimId, loading, fact, true);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tlet ul = document.createElement('ul');\r\n\t\tul.setAttribute('id', prefix + '_' + id + \"_\" + dimId);\r\n\t\tul.setAttribute('style', 'width: 100%; height: 35px');\r\n\t\t\r\n\t\tlet applyBtn = $('#btn_' + id);\r\n\t\t\r\n\t\tlet dimDiv = $('<div class=\"dimension\"></div>');\r\n\t\tlet dimText = $('<p class=\"dimension-text\">' + dimName + '</p>');\r\n\t\tlet dimBtns = $('<div></div>');\r\n\t\tlet clearBtn = $('<button title=\"Снять все\" id=\"clear_dim_filter_'+id+'_'+dimId + '\"><div class=\"icon-clearAll\"></div><span>Снять все</span></button>');\r\n\t\tlet selectBtn = $('<button title=\"Выбрать корневые\" id=\"select_dim_filter_'+id+'_'+dimId + '\"><div class=\"icon-selectAll\"></div><span>Выделить все</span></button>');\r\n\t\tdimBtns.append(clearBtn);\r\n\t\tdimBtns.append(selectBtn);\r\n\t\tdimDiv.append(dimText);\r\n\t\tdimDiv.append(dimBtns);\r\n\t\t\r\n\t\tapplyBtn.before(dimDiv);\r\n\t\tapplyBtn.before(ul);\r\n\t\t$(ul).combotree({ cascadeCheck: false, multiple: true, checkbox: true, onBeforeExpand: beforeExpand, onClick: this_.onNodeClick });\r\n\t\t$(ul).combotree('loadData', data);\r\n\t\t\r\n\t\tthis_.initFilterBtns(id, dimId);\r\n\t}\r\n\t\r\n\tloadNodes(id, fact, nodesNames, treeId, treeName, prefix, isCombo) {\r\n\t\tlet this_ = this;\r\n\t\tvar nodes = [];\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: this_.OLAP_URL + \"dim/dimension/\" + treeId + \"?fact=\" + fact,\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tnodesNames = data;\r\n\t\t\t\tfor (var i in data) {\r\n\t\t\t\t\tvar node = {};\r\n\t\t\t\t\tnode['id'] = data[i].id;\r\n\t\t\t\t\tnode['text'] = data[i].name;\r\n\t\t\t\t\tnode['value'] = data[i].name;\r\n\t\t\t\t\tnode['state'] = data[i].isLeaf ? 'open' : 'closed';\r\n\t\t\t\t\tif (!isCombo)\r\n\t\t\t\t\t\tnode['checked'] = true;\r\n\t\t\t\t\tnode['color'] = data[i].color;\r\n\t\t\t\t\tnodes.push(node);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\tif (isCombo) {\r\n\t\t\tthis_.initComboTree(id, prefix, treeId, treeName, nodes, fact);\r\n\t\t} else {\r\n\t\t\tthis_.initTree(\"#\" + prefix + \"_\" + id, treeId, nodes, fact);\r\n\t\t}\r\n\t}\r\n\t\r\n\tinitCombobox(id, data, fact, nodesNames, prefix, parentNodeId) {\r\n\t\tlet this_ = this;\r\n\t\tvar comb = $(\"#\" + prefix + \"axes_\" + id);\r\n\t\tcomb.combobox({\r\n\t\t\tonSelect: function (item) {\r\n\t\t\t\tparentNodeId.id = item.id;\r\n\t\t\t\tparentNodeId.name = item.value;\r\n\t\t\t\tthis_.loadNodes(id, fact, nodesNames, item.id, '', prefix);\r\n\t\t\t},\r\n\t\t\tformatter: function (value) {\r\n\t\t\t\tvar width = $(this).width();\r\n\t\t\t\treturn $('<div/>').append($('<div style=\"width:' + width + 'px;cursor:pointer;\">' + value.text[0] + '</>')).html();\r\n\t\t\t},\r\n\t\t\tdata: data\r\n\t\t});\r\n\t\tthis_.loadNodes(id, fact, nodesNames, parentNodeId.id, '', prefix);\r\n\t}\r\n\t\r\n\tinitDiagramType(id, chartContainer, chartData, nodesNamesX, nodesNamesY, nameX) {\r\n\t\tvar comb = $(\"#type_\" + id);\r\n\t\tvar data = [{ id: 'BAR', text: ['Столбчатая'], value: 'BAR' },\r\n\t\t{ id: 'PIE', text: ['Круговая'], value: 'PIE' },\r\n\t\t{ id: 'LINE', text: ['Линейная'], value: 'LINE' },\r\n\t\t{ id: 'DONUT', text: ['Кольцевая'], value: 'DONUT' },\r\n\t\t{ id: '3DBAR', text: ['Столбчатая 3D'], value: '3DBAR' }];\r\n\t\tfor (let i in data) {\r\n\t\t\tif (data[i].id === chartContainer.type)\r\n\t\t\t\tdata[i].selected = true;\r\n\t\t}\r\n\t\r\n\t\tlet _this = this;\r\n\t\tcomb.combobox({\r\n\t\t\tonSelect: function (item) {\r\n\t\t\t\tchartContainer.chart.dispose();\r\n\t\t\t\tchartContainer.type = item.id\r\n\t\t\t\t_this.drawChart(id, chartContainer, chartData, nodesNamesX, nodesNamesY, nameX);\r\n\t\t\t},\r\n\t\t\tformatter: function (value) {\r\n\t\t\t\tvar width = $(this).width();\r\n\t\t\t\treturn $('<div/>').append($('<div style=\"width:' + width + 'px;cursor:pointer;\">' + value.text[0] + '</>')).html();\r\n\t\t\t},\r\n\t\t\tdata: data\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitAxesTitle(id, parentXId, parentYId) {\r\n\t\t$('#axes_title_' + id).html(parentXId.name + ' / ' + parentYId.name);\r\n\t}\r\n\t\r\n\tsetShowLegend(chartContainer, showLegend) {\r\n\t\tchartContainer.chart.legend.disabled = !showLegend;\r\n\t}\r\n\t\r\n\tdrawChart(id, chartContainer, chartData, nodesNamesX, nodesNamesY, nameX) {\r\n\t\tfor (var i in chartData) {\r\n\t\t\tvar node = nodesNamesX[i]\r\n\t\t\tif (chartContainer.type === \"LINE\") {\r\n\t\t\t\tif (node.id[0] === 'y') {\r\n\t\t\t\t\tchartData[i][nameX] = new Date(node.name);\r\n\t\t\t\t} else if (node.id[0] === 'q') {\r\n\t\t\t\t\tchartData[i][nameX] = new Date(node.id.substring(1, 5), node.id.substring(5) - 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#' + id).html('<p style=\"font-size:24;font-weight:bold;text-align:center;padding:20% 0\">В ЛИНЕЙНОЙ ДИАГРАММЕ ИЗМЕРИТЕЛЬ X ДОЛЖЕН БЫТЬ ПЕРИОДОМ</p>');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tchartData[i][nameX] = node.name;\r\n\t\t\t}\r\n\t\t\tif (chartContainer.type === \"PIE\" || chartContainer.type === \"DONUT\") {\r\n\t\t\t\tchartData[i]['color'] = node.color;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (var j in nodesNamesY) {\r\n\t\t\t\t\tchartData[i]['color' + j] = nodesNamesY[j].color;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tam4core.useTheme(am4themes_animated);\r\n\t\tlet this_ = this;\r\n\t\tif (chartContainer.type === \"BAR\") {\r\n\t\t\t// Create chart instance\r\n\t\t\tchartContainer.chart = am4core.create(id, am4charts.XYChart);\r\n\t\r\n\t\t\t// Create axes\r\n\t\t\tvar categoryAxis = chartContainer.chart.xAxes.push(new am4charts.CategoryAxis());\r\n\t\t\tcategoryAxis.dataFields.category = this.nameX;\r\n\t\t\tcategoryAxis.renderer.grid.template.location = 0;\r\n\t\r\n\t\t\tcategoryAxis.renderer.minGridDistance = 30;\r\n\t\r\n\t\t\t// Configure axis label\r\n\t\t\tvar label = categoryAxis.renderer.labels.template;\r\n\t\t\tlabel.wrap = true;\r\n\t\r\n\t\t\tcategoryAxis.events.on(\"sizechanged\", function (ev) {\r\n\t\t\t\tvar axis = ev.target;\r\n\t\t\t\tvar cellWidth = axis.pixelWidth / (axis.endIndex - axis.startIndex);\r\n\t\t\t\taxis.renderer.labels.template.maxWidth = cellWidth;\r\n\t\t\t});\r\n\t\r\n\t\t\tvar valueAxis = chartContainer.chart.yAxes.push(new am4charts.ValueAxis());\r\n\t\t\tvalueAxis.renderer.inside = true;\r\n\t\t\tvalueAxis.renderer.labels.template.disabled = true;\r\n\t\t\tvalueAxis.min = 0;\r\n\t\r\n\t\t\tfor (i in nodesNamesY) {\r\n\t\t\t\tthis_.createBarSeries(chartContainer.chart, nodesNamesY[i], i);\r\n\t\t\t}\r\n\t\t} else if (chartContainer.type === \"PIE\") {\r\n\t\t\tchartContainer.chart = am4core.create(id, am4charts.PieChart);\r\n\t\r\n\t\t\tfor (i in nodesNamesY) {\r\n\t\t\t\tthis_.createPieSeries(chartContainer.chart, nodesNamesY[i].id, nodesNamesY[i].name);\r\n\t\t\t}\r\n\t\t} else if (chartContainer.type === \"LINE\") {\r\n\t\t\tchartContainer.chart = am4core.create(id, am4charts.XYChart);\r\n\t\t\tchartContainer.chart.paddingRight = 20;\r\n\t\r\n\t\t\tvar xAxis = chartContainer.chart.xAxes.push(new am4charts.DateAxis());\r\n\t\t\txAxis.renderer.grid.template.location = 0;\r\n\t\t\txAxis.minZoomCount = 5;\r\n\t\r\n\t\t\t// this makes the data to be grouped\r\n\t\t\txAxis.groupData = true;\r\n\t\t\txAxis.groupCount = 500;\r\n\t\r\n\t\t\tvar yAxis = chartContainer.chart.yAxes.push(new am4charts.ValueAxis());\r\n\t\r\n\t\t\tfor (i in nodesNamesY) {\r\n\t\t\t\tthis_.createLineSeries(chartContainer.chart, nodesNamesY[i].id, nodesNamesY[i].name, i);\r\n\t\t\t}\r\n\t\r\n\t\t\tchartContainer.chart.cursor = new am4charts.XYCursor();\r\n\t\t\tchartContainer.chart.cursor.xAxis = xAxis;\r\n\t\r\n\t\t\tvar scrollbarX = new am4core.Scrollbar();\r\n\t\t\tscrollbarX.marginBottom = 20;\r\n\t\t\tchartContainer.chart.scrollbarX = scrollbarX;\r\n\t\t} else if (chartContainer.type === \"3DBAR\") {\r\n\t\t\tchartContainer.chart = am4core.create(id, am4charts.XYChart3D);\r\n\t\r\n\t\t\tvar categoryAxis = chartContainer.chart.xAxes.push(new am4charts.CategoryAxis());\r\n\t\t\tcategoryAxis.dataFields.category = this.nameX;\r\n\t\t\tcategoryAxis.renderer.grid.template.location = 0;\r\n\t\t\tcategoryAxis.renderer.minGridDistance = 30;\r\n\t\r\n\t\t\tlet label = categoryAxis.renderer.labels.template;\r\n\t\t\tlabel.wrap = true;\r\n\t\t\tcategoryAxis.events.on(\"sizechanged\", function (ev) {\r\n\t\t\t\tvar axis = ev.target;\r\n\t\t\t\tvar cellWidth = axis.pixelWidth / (axis.endIndex - axis.startIndex);\r\n\t\t\t\taxis.renderer.labels.template.maxWidth = cellWidth;\r\n\t\t\t});\r\n\t\r\n\t\t\tvar valueAxis = chartContainer.chart.yAxes.push(new am4charts.ValueAxis());\r\n\t\r\n\t\t\tfor (i in nodesNamesY) {\r\n\t\t\t\tthis_.create3DBarSeries(chartContainer.chart, nodesNamesY[i].id, nodesNamesY[i].name, i);\r\n\t\t\t}\r\n\t\t} else if (chartContainer.type === \"DONUT\") {\r\n\t\t\t// Create chart instance\r\n\t\t\tchartContainer.chart = am4core.create(id, am4charts.PieChart);\r\n\t\r\n\t\t\t// Let's cut a hole in our Pie chart the size of 40% the radius\r\n\t\t\tchartContainer.chart.innerRadius = am4core.percent(40);\r\n\t\r\n\t\t\tfor (i in nodesNamesY) {\r\n\t\t\t\tthis_.createDonutSeries(chartContainer.chart, nodesNamesY[i].id, nodesNamesY[i].name);\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tchartContainer.chart.data = chartData;\r\n\t\tchartContainer.chart.language.locale = am4lang_ru_RU;\r\n\t\tchartContainer.chart.exporting.menu = new am4core.ExportMenu();\r\n\t\tchartContainer.chart.exporting.filePrefix = 'Aналитика';\r\n\t\r\n\t\tlet datelabel = chartContainer.chart.createChild(am4core.Label);\r\n\t\tdatelabel.align = \"right\";\r\n\t\tdatelabel.scale = 2;\r\n\t\tdatelabel.disabled = true;\r\n\t\tchartContainer.chart.exporting.validateSprites.push(datelabel);\r\n\t\r\n\t\tlet titlelabel = chartContainer.chart.createChild(am4core.Label);\r\n\t\ttitlelabel.isMeasured = false;\r\n\t\ttitlelabel.align = \"center\";\r\n\t\ttitlelabel.verticalCenter = \"top\";\r\n\t\ttitlelabel.scale = 2;\r\n\t\ttitlelabel.disabled = true;\r\n\t\tchartContainer.chart.exporting.validateSprites.push(titlelabel);\r\n\t\r\n\t\tchartContainer.chart.exporting.events.on(\"exportstarted\", function (ev) {\r\n\t\t\tdatelabel.disabled = false;\r\n\t\t\ttitlelabel.disabled = false;\r\n\t\t\tconst d = new Date()\r\n\t\t\tconst date = d.toISOString().split('T')[0];\r\n\t\t\tconst time = d.toTimeString().split(' ')[0];\r\n\t\t\tdatelabel.text = `${date} ${time}`;\r\n\t\t\ttitlelabel.text = $('#axes_title_' + id).text();\r\n\t\t});\r\n\t\r\n\t\tchartContainer.chart.exporting.events.on(\"exportfinished\", function (ev) {\r\n\t\t\tdatelabel.disabled = true;\r\n\t\t\ttitlelabel.disabled = true;\r\n\t\t});\r\n\t\r\n\t\tchartContainer.chart.exporting.menu.items = [{\r\n\t\t\t\"label\": \"Экспортировать\",\r\n\t\t\t\"menu\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"label\": \"Изображение\",\r\n\t\t\t\t\t\"menu\": [\r\n\t\t\t\t\t\t{ \"type\": \"png\", \"label\": \"PNG\" },\r\n\t\t\t\t\t\t{ \"type\": \"jpg\", \"label\": \"JPG\" },\r\n\t\t\t\t\t\t{ \"type\": \"svg\", \"label\": \"SVG\" },\r\n\t\t\t\t\t\t{ \"type\": \"pdf\", \"label\": \"PDF\" }\r\n\t\t\t\t\t]\r\n\t\t\t\t}, {\r\n\t\t\t\t\t\"label\": \"Данные\",\r\n\t\t\t\t\t\"menu\": [\r\n\t\t\t\t\t\t{ \"type\": \"json\", \"label\": \"JSON\" },\r\n\t\t\t\t\t\t{ \"type\": \"csv\", \"label\": \"CSV\" },\r\n\t\t\t\t\t\t{ \"type\": \"xlsx\", \"label\": \"XLSX\" },\r\n\t\t\t\t\t\t{ \"type\": \"html\", \"label\": \"HTML\" }\r\n\t\t\t\t\t]\r\n\t\t\t\t}, {\r\n\t\t\t\t\t\"label\": \"Печатать\", \"type\": \"print\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}];\r\n\t\r\n\t\tchartContainer.chart.exporting.adapter.add(\"pdfmakeDocument\", function (pdf, target) {\r\n\t\t\tpdf.doc.pageOrientation = \"landscape\";\r\n\t\t\treturn pdf;\r\n\t\t});\r\n\t\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"pdf\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"png\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"jpg\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"svg\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"json\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"csv\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"xlsx\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"html\").addURL = false;\r\n\t\tchartContainer.chart.exporting.formatOptions.getKey(\"print\").addURL = false;\r\n\t\r\n\t\tthis_.createLegend(chartContainer, nodesNamesY);\r\n\t\tthis_.setShowLegend(chartContainer, chartContainer.showLegend);\r\n\t}\r\n\t\r\n\tloadAnalytic(id, chartContainer, idX, idY, zAxis, nodesNamesX, nodesNamesY, selectedZIds, fact, aggType, aggField) {\r\n\t\tUtil.blockPage(\"Подождите...\");\r\n\t\tvar q = { \"dim1\": { \"id\": idX.id, \"value\": [] }, \"dim2\": { \"id\": idY.id, \"value\": [] }, \"fact\": fact, \"agg\": aggType, \"value\": aggField };\r\n\t\tfor (var i in nodesNamesX) {\r\n\t\t\tq[\"dim1\"].value.push(nodesNamesX[i].id);\r\n\t\t}\r\n\t\tfor (i in nodesNamesY) {\r\n\t\t\tq[\"dim2\"].value.push(nodesNamesY[i].id);\r\n\t\t}\r\n\t\t\r\n\t\tzAxis.forEach(filter => {\r\n\t\t\tlet ids = selectedZIds[filter.id];\r\n\t\t\tif (ids.length) {\r\n\t\t\t\tlet dim = { id: filter.id, value: [] };\r\n\t\t\t\tfor (i in ids) {\r\n\t\t\t\t\tdim.value.push(ids[i].id);\r\n\t\t\t\t}\r\n\t\t\t\tif (q[\"dim3\"] == undefined || q[\"dim3\"] == null)\r\n\t\t\t\t\tq[\"dim3\"] = [];\r\n\t\t\t\t\r\n\t\t\t\tq[\"dim3\"].push(dim);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tvar chartData;\r\n\t\tlet this_ = this;\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: this_.OLAP_URL + \"ds/data\",\r\n\t\t\tdata: JSON.stringify(q),\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tchartData = data;\r\n\t\t\t},\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false\r\n\t\t});\r\n\t\r\n\t\tvar empty = true;\r\n\t\tfor (i in chartData) {\r\n\t\t\tfor (var j in chartData[i])\r\n\t\t\t\tif (chartData[i][j]) {\r\n\t\t\t\t\tempty = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t}\r\n\t\tif (empty) {\r\n\t\t\t$('#' + id).find('div').remove();\r\n\t\t\t$('#' + id).html('<p style=\"font-size:24;font-weight:bold;text-align:center;padding:20% 0\">НЕТ ДАННЫХ ДЛЯ ОТОБРАЖЕНИЯ</p>');\r\n\t\t\t$('body').unblock();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tif (chartContainer.chart)\r\n\t\t\tchartContainer.chart.dispose();\r\n\t\tthis_.drawChart(id, chartContainer, chartData, nodesNamesX, nodesNamesY, this.nameX);\r\n\t\tthis_.initDiagramType(id, chartContainer, chartData, nodesNamesX, nodesNamesY, this.nameX);\r\n\t\r\n\t\t$('body').unblock();\r\n\t}\r\n\t\r\n\tinitBtn(id) {\r\n\t\t$(id).linkbutton({\r\n\t\t\ttext: '<span style=\"font-size:15px;color:#fff;text-weight:normal;\">Применить</span>'\r\n\t\t})\r\n\t}\r\n\t\r\n\tinitTglLegBtn(id, chartContainer) {\r\n\t\t$(id).linkbutton({\r\n\t\t\ttext: '<span style=\"font-size:15px;color:#fff;text-weight:normal;\">' + (chartContainer.showLegend ? \"Скрыть\" : \"Показать\") + ' легенду</span>'\r\n\t\t})\r\n\t}\r\n\t\r\n\thideBtn(id) {\r\n\t\tvar content = $('#cnt0acc_' + id);\r\n\t\t$(content).removeClass('expanded-v');\r\n\t\t$('#t0acc_' + id).css('display', 'block');\r\n\t\t$('#t0acc_' + id).parent().parent().css('cursor', 'pointer');\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tclearNodes(e) {\r\n\t\tif (e.children) {\r\n\t\t\te.children.map(this.clearNodes.bind(this));\r\n\t\t}\r\n\t\te.checked = false;\r\n\t\te._checked = false;\r\n\t\te.checkState = 'unchecked';\r\n\t\treturn e;\r\n\t}\r\n\t\r\n\tselectNodes(e) {\r\n\t\te.checked = true;\r\n\t\te._checked = true;\r\n\t\te.checkState = 'checked';\r\n\t\treturn e;\r\n\t}\r\n\t\r\n\tclearDim(id) {\r\n\t\tvar oldNodes = $(id).tree('getRoots');\r\n\t\tvar newNodes = oldNodes.map(this.clearNodes.bind(this));\r\n\t\t$(id).tree('loadData', newNodes);\r\n\t}\r\n\t\r\n\tselectDim(id) {\r\n\t\tthis.clearDim(id);\r\n\t\tvar oldNodes = $(id).tree('getRoots');\r\n\t\tvar newNodes = oldNodes.map(this.selectNodes);\r\n\t\t$(id).tree('loadData', newNodes);\r\n\t}\r\n\t\r\n\tclearComboDim(id) {\r\n\t\tvar oldNodes = $(id).combotree('tree').tree('getRoots');\r\n\t\tvar newNodes = oldNodes.map(this.clearNodes.bind(this));\r\n\t\t$(id).combotree('clear');\r\n\t\t$(id).combotree('loadData', newNodes);\r\n\t}\r\n\t\r\n\tselectComboDim(id) {\r\n\t\tthis.clearComboDim(id);\r\n\t\tvar oldNodes = $(id).combotree('tree').tree('getRoots');\r\n\t\tvar newNodes = oldNodes.map(this.selectNodes);\r\n\t\t$(id).combotree('clear');\r\n\t\t$(id).combotree('loadData', newNodes);\r\n\t}\r\n\r\n\tinitSelectBtns(id) {\r\n\t\tlet this_ = this;\r\n\t\t$('#clear_dim_x_' + id).click(() => this_.clearDim('#x_' + id));\r\n\t\t$('#select_dim_x_' + id).click(() => this_.selectDim('#x_' + id));\r\n\t\t$('#clear_dim_y_' + id).click(() => this_.clearDim('#y_' + id));\r\n\t\t$('#select_dim_y_' + id).click(() => this_.selectDim('#y_' + id));\r\n\t}\r\n\t\r\n\tinitFilterBtns(id, dimId) {\r\n\t\tlet this_ = this;\r\n\t\t$('#clear_dim_filter_' + id + '_' + dimId).click(() => this_.clearComboDim('#filter_' + id + '_' + dimId));\r\n\t\t$('#select_dim_filter_' + id + '_' + dimId).click(() => this_.selectComboDim('#filter_' + id + '_' + dimId));\r\n\t}\r\n\t\t\r\n}","import {DataChecker} from './util.js';\r\n\r\nexport class Archives {\r\n\r\n\timgExt = \".png\";\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet this_ = this;\r\n\t\t$('#archiveList_Layout').layout();\r\n\t\t$('#archiveTree').tree({\r\n\t\t\tonClick: function(node){\r\n\t\t\t\tthis_.selectArchive(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '#archiveList_body .archive', function() {\r\n\t\t\tvar procId = $(this).attr(\"procId\");\r\n\t\t\tthis_.app.nav.openArchive(procId);\r\n\t\t});\r\n\t\t\r\n\t\t$('#dictsList_Layout').layout();\r\n\t\t$('#dictsTree').tree({\r\n\t\t\tonClick: function(node){\r\n\t\t\t\tthis_.selectDict(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '#dictsList_body .dict', function() {\r\n\t\t\tvar procId = $(this).attr(\"procId\");\r\n\t\t\tthis_.app.nav.openDict(procId);\r\n\t\t});\r\n\t\t\r\n\t}\r\n\t\r\n\tselectArchive(node) {\r\n\t\tlet this_ = this;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet par = {\"cmd\": \"getArchiveData\", \"leaf\": 1, \"id\": node.id};\r\n\t\t\t\r\n\t\t\tthis.app.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\t$('#archiveList_body').html(\"\");\r\n\t\t\t\t\t\t$.each(data, function(e, proc) {\r\n\t\t\t\t\t\t\tvar u = proc.id.indexOf(\".\");\r\n\t\t\t\t\t\t\tvar key = proc.id.substring(u+1);\r\n\t\t\t\t\t\t\tvar fontWeight = proc.fontWeight ? \"\" : \"font-weight:bold;\";\r\n\t\t\t\t\t\t\t$('#archiveList_body').append(\"<div time = '\" + proc.time + \"' desc = '\" + proc.procDesc + \"'id='processess\" + key \r\n\t\t\t\t\t\t\t\t+ \"' class='archive' procId='\" + proc.id\r\n\t\t\t\t\t\t\t\t+ \"'><span class='ico_proc ico_\" + proc.id.replace('.', '_') + \"'></span>\" \r\n\t\t\t\t\t\t\t\t+ \"<a style='\"+fontWeight+\"'>\" + proc.title + \"</a></div> \");\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.addProcIcon('#archiveList_body .proc.ico_' + proc.id.replace('.', '_'), this_.app.restUrl + '/jsp/media/css/or3/'+proc.id.replace('.', '_')+this_.imgExt);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.attachProcessTooltips('processess'+key);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tselectDict(node) {\r\n\t\tlet this_ = this;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet par = {\"cmd\": \"getDictData\", \"leaf\": 1, \"id\": node.id};\r\n\t\t\t\r\n\t\t\tthis.app.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\t$('#dictsList_body').html(\"\");\r\n\t\t\t\t\t\t$.each(data, function(e, proc) {\r\n\t\t\t\t\t\t\tvar u = proc.id.indexOf(\".\");\r\n\t\t\t\t\t\t\tvar key = proc.id.substring(u+1);\r\n\t\t\t\t\t\t\tvar fontWeight = proc.fontWeight ? \"\" : \"font-weight:bold;\";\r\n\t\t\t\t\t\t\t$('#dictsList_body').append(\"<div time = '\" + proc.time + \"' desc = '\" + proc.procDesc + \"'id='dict\" + key \r\n\t\t\t\t\t\t\t\t+ \"' class='dict' procId='\" + proc.id\r\n\t\t\t\t\t\t\t\t+ \"'><span class='ico_proc ico_\" + proc.id.replace('.', '_') + \"'></span>\" \r\n\t\t\t\t\t\t\t\t+ \"<a style='\"+fontWeight+\"'>\" + proc.title + \"</a></div> \");\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.addProcIcon('#dictsList_body .proc.ico_' + proc.id.replace('.', '_'), this_.app.restUrl + '/jsp/media/css/or3/'+proc.id.replace('.', '_')+this_.imgExt);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.attachProcessTooltips('dict'+key);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\taddProcIcon(className, src) {\r\n\t\tlet this_ = this;\r\n\t\tvar img = new Image();\r\n\t\timg.onload = function() {\r\n\t\t\tthis_.addStyle(className+' {background-image: url('+src+') !important}');\r\n\t\t};\r\n\t\timg.src = src;\r\n\t}\r\n\t\r\n\taddStyle(st) {\r\n\t    var style = document.createElement('style');\r\n\t\tstyle.type = 'text/css';\r\n\t\tstyle.innerHTML = st;\r\n\t\tdocument.getElementsByTagName('head')[0].appendChild(style);\r\n\t}\r\n\t\r\n\tattachProcessTooltips(proc_id) {\r\n\t\t\r\n\t}\r\n}","import {DataChecker, Util} from './util.js';\r\n\r\nexport class Autocomplete {\r\n\t\r\n\tstatic autocomplete(inp) {\r\n\t\tif(!inp) return false;\r\n\t\r\n\t\tnew AutoInput(inp);\r\n\t}\r\n\t\r\n}\r\n\r\nclass AutoInput {\r\n\tstatic heightRange = 40;\r\n\r\n\tconstructor(input) {\r\n\t\tthis.inp = input;\r\n\t\tthis.currentFocus = 0;\r\n\t\tthis.init();\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet _this = this;\r\n\t\r\n\t\tthis.inp.addEventListener(\"input\", function(e){\r\n\t\t\t/*\r\n\t\t\t\tне показывать поиск по одной букве\r\n\t\t\t\tif(val.length < 2){\r\n\t\t\t\t\t_this.closeAllLists();\r\n\t\t\t\t\treturn false;\r\n\t\t\t} */\r\n\t\t\t_this.getUserDeals(this.value);\r\n\t\t});\r\n\t\t\r\n\t\tthis.inp.addEventListener(\"keydown\", function(e){ \r\n\t\t\tvar x = document.getElementById(this.id + \"autocomplete-list\");\r\n\t\t\tif(x) x = x.getElementsByTagName(\"div\");\r\n\t\t\tif(e.keyCode === 40){\r\n\t\t\t\t_this.currentFocus++;\r\n\t\t\t\t_this.addActive(x);\r\n\t\t\t} else if(e.keyCode === 38){\r\n\t\t\t\t_this.currentFocus--;\r\n\t\t\t\t_this.addActive(x);\r\n\t\t\t} else if(e.keyCode === 13){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tif(_this.currentFocus > -1) {\r\n\t\t\t\t\tif(x) x[_this.currentFocus].click();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tdocument.addEventListener(\"keydown\", function(e){\r\n\t\t\tif(e.keyCode === 27){\r\n\t\t\t\t_this.closeAllLists();\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tdocument.addEventListener(\"click\", function(e) {\r\n\t\t\t_this.closeAllLists(e.target);\r\n\t\t});\r\n\t\r\n\t}\r\n\r\n\tgetUserDeals(val) {\r\n\t\tlet _this = this;\r\n\t\r\n\t\tvar par = {\"cmd\":\"getUserPrivateDeal\", \"text\": val};\r\n\t\t\r\n\t\tUtil.post2(par).then(function(json){\r\n\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\r\n\t\t\t\tvar nameArr = (data.iinNames) ? data.iinNames.substr(1).split(\";\") : null;\r\n\t\t\t\tvar uidArr = (data.iinNames) ? data.uids.substr(1).split(\";\") : null;\r\n\t\t\t\t\r\n\t\t\t\t_this.closeAllLists();\r\n\t\t\t\t\r\n\t\t\t\tif (!val) {return false;}\r\n\t\t\t\t_this.currentFocus = 0;\r\n\t\t\t\t\r\n\t\t\t\tlet a = document.createElement(\"div\");\r\n\t\t\t\ta.setAttribute(\"id\", _this.inp.id + \"autocomplete-list\");\r\n\t\t\t\ta.setAttribute(\"class\", \"autocomplete-items\");\r\n\t\t\t\t\r\n\t\t\t\ta.style.top = $(_this.inp).offset().top + $(_this.inp).height() + 4;\r\n\t\t\t\ta.style.left = $(_this.inp).offset().left;\r\n\t\t\t\ta.style.right = $( window ).width() - $(_this.inp).offset().left - $(_this.inp).width() - 44;\r\n\t\t\t\t\r\n\t\t\t\tdocument.body.appendChild(a);\r\n\t\t\t\t\r\n\t\t\t\tif(!nameArr || nameArr.lengh == 0) {\r\n\t\t\t\t\t_this.closeAllLists();\r\n\t\t\t\t\treturn false;}\r\n\t\t\t\tfor(var i = 0; i<nameArr.length; i++){\r\n\t\t\t\t\tlet k = nameArr[i].toUpperCase().indexOf(val.toUpperCase());\r\n\t\t\t\t\tif(k !== -1){\r\n\t\t\t\t\t\tlet b = document.createElement(\"div\");\r\n\t\t\t\t\t\tb.setAttribute(\"id\", _this.inp.id + \"autocomplete-list\" + i);\r\n\t\t\t\t\t\tb.innerHTML = nameArr[i].substr(0, k);\r\n\t\t\t\t\t\tb.innerHTML += \"<strong>\" + nameArr[i].substr(k, val.length) + \"</strong>\";\r\n\t\t\t\t\t\tb.innerHTML += nameArr[i].substr(k + val.length);\r\n\t\t\t\t\t\tb.innerHTML += \"<input type='hidden' value='\" + nameArr[i] + \"'>\";\r\n\t\t\t\t\t\tb.innerHTML += \"<input type='hidden' value='\" + i + \"'>\";\r\n\t\t\t\t\t\tb.addEventListener(\"click\", function(e){\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar index = this.getElementsByTagName(\"input\")[1].value;\r\n\t\t\t\t\t\t\tvar uid = uidArr[index];\r\n\t\t\t\t\t\t\t_this.closeAllLists();\r\n\t\t\t\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\t\t\tdocument.location.hash = \"cmd=openLDIfc&uid=\" + uid;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\ta.appendChild(b);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar x = document.getElementById(_this.inp.id + \"autocomplete-list\");\r\n\t\t\t\tif(x) x = x.getElementsByTagName(\"div\");\r\n\t\t\t\t_this.addActive(x);\t\t\t\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}\r\n\r\n\taddActive(x){\r\n\t\tif(!x) return false;\r\n\t\tthis.removeActive(x);\r\n\t\tlet currentFocus = this.currentFocus;\r\n\t\t\r\n\t\tif(currentFocus >= x.length) currentFocus = 0;\r\n\t\tif(currentFocus < 0) currentFocus = x.length - 1;\r\n\t\t\r\n\t\tx[currentFocus].classList.add(\"autocomplete-active\");\r\n\t\t\r\n\t\tvar divTop = $(\"#\" + x[currentFocus].id).offset().top;\r\n\t\tvar parBottom = $(\".autocomplete-items\").height() + $(\".autocomplete-items\").offset().top - this.heightRange;\r\n\t\tif(divTop > parBottom){\r\n\t\t\t$(\".autocomplete-items\").scrollTop(x[currentFocus].offsetTop - $(\".autocomplete-items\").height() + x[currentFocus].offsetHeight);\r\n\t\t}\r\n\t\telse if(divTop < $(\".autocomplete-items\").offset().top){\r\n\t\t\t$(\".autocomplete-items\").scrollTop(x[currentFocus].offsetTop);\r\n\t\t}\r\n\t}\r\n\t\r\n\tremoveActive(x){\r\n\t\tif(!x) return false;\r\n\t\tfor(var i = 0; i<x.length; i++){\r\n\t\t\tx[i].classList.remove(\"autocomplete-active\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tcloseAllLists(elmnt){\r\n\t\tvar x = document.getElementsByClassName(\"autocomplete-items\");\r\n\t\tfor(var i =0; i<x.length; i++){\r\n\t\t\tif(elmnt != x[i] && elmnt != this.inp){\r\n\t\t\t\tx[i].parentNode.removeChild(x[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","export class ErrorOps {\r\n\t\r\n\thiglightErrors(ers) {\r\n\t\tlet _this = this;\r\n\t\tvar list = [\"<ul class='error-red'>\",\"<ul class='error-blue'>\",\"<ul class='error-gray'>\"];\r\n\t\t$.each(ers, function(i,er) {\r\n\t\t\tvar rownum = -1;\r\n\t\t\tif ($(\"td[field=\"+ er.uuid +\"]\").length > 1) {\r\n\t\t\t\trownum = er.msg.substring(er.msg.lastIndexOf('(')+1, er.msg.lastIndexOf(')')) - 1;\r\n\t\t\t}\r\n\t\t\tlist[er.type] += \"<li uuid='\" + er.uuid + \"'\";\r\n\t\t\tif (rownum > -1) {\r\n\t\t\t\tlist[er.type] += \" row='\" + rownum + \"'\";\r\n\t\t\t}\r\n\t\t\tlist[er.type] += \">\" + er.msg.replace(/\\n/g, '<br/>') + \"</li>\";\r\n\t\t\t_this.higlightErrorComp(er, rownum);\r\n\t\t});\r\n\t\tlist[0]+=\"</ul>\";\r\n\t\tlist[1]+=\"</ul>\";\r\n\t\tlist[2]+=\"</ul>\";\r\n\t\t\r\n\t\treturn list[0]+list[1]+list[2];\r\n\t}\r\n\t\r\n\thiglightErrorComp(error, rownum) {\r\n\t\tvar e = $('#'+error.uuid);\r\n\t\r\n\t\t// подсветка ячейки в таблице\r\n\t\tif (rownum > -1) {\r\n\t\t\tvar td_field = $(\"td[field=\"+ error.uuid +\"]\");\r\n\t\t\tif (td_field.length >= rownum) {\r\n\t\t\t\t$(td_field).parent().parent().find(\"[datagrid-row-index=\"+ rownum +\"] > td[field=\"+ error.uuid +\"]\")\r\n\t\t\t\t\t.toggleClass(\"error-type-\"+error.type, true);\r\n\t\t\t}\r\n\t\t// подсветка поля\r\n\t\t} else {\r\n\t\t\tthis.setErrorType(e, error.type);\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetErrorType(e, errID) {\r\n\t\tlet this_ = this;\r\n\t\tif ($(e).hasClass('easyui-datebox')) {\r\n\t\t\tif (!$(e).hasClass('datebox-f')) comp.datebox();\r\n\t\t\te = $(e).datebox(\"textbox\").parent();\r\n\t\t\t$(e).toggleClass(\"error-type-\"+errID, true);\r\n\t\t\treturn ;\r\n\t\t} else if ($(e).hasClass('easyui-datetimebox')) {\r\n\t\t\tif (!$(e).hasClass('datetimebox-f')) comp.datetimebox();\r\n\t\t\te = $(e).datetimebox(\"textbox\").parent();\r\n\t\t\t$(e).toggleClass(\"error-type-\"+errID, true);\r\n\t\t\treturn ;\r\n\t\t} else if ($(e).hasClass('easyui-combobox')) {\r\n\t\t\tif (!$(e).hasClass('combobox-f')) $(e).combobox();\r\n\t\t\te = $(e).combobox(\"textbox\").parent();\r\n\t\t\t$(e).toggleClass(\"error-type-\"+errID, true);\r\n\t\t\treturn;\r\n\t\t} else if ($(e).hasClass('easyui-numberbox')) {\r\n\t\t\tif (!$(e).hasClass('numberbox-f')) $(e).numberbox();\r\n\t\t\te = $(e).numberbox(\"textbox\").parent();\r\n\t\t\t$(e).toggleClass(\"error-type-\"+errID, true);\r\n\t\t\treturn;\r\n\t\t} else if ($(e).is(\"input\") \r\n\t\t\t\t|| $(e).is(\"select\")\r\n\t\t\t\t|| $(e).is(\"textarea\")\r\n\t\t\t\t|| $(e).hasClass(\"textbox-text\") \r\n\t\t\t\t|| $(e).hasClass(\"datebox\")\r\n\t\t\t\t|| $(e).hasClass(\"datetimebox\")){\r\n\t\t\t$(e).one(\"change\", function () {\r\n\t\t\t\tthis_.delErrorType($(this));\r\n\t\t    });\r\n\t\t\t$(e).toggleClass(\"error-type-\"+errID, true);\r\n\t\t\treturn ;\r\n\t\t}\r\n\t}\r\n\r\n\tdelErrorType(e) {\r\n\t\tif ($(e).hasClass('easyui-datebox')) {\r\n\t\t\tif (!$(e).hasClass('datebox-f')) $(e).datebox();\r\n\t\t\te = $(e).datebox(\"textbox\").parent();\r\n\t\t}\r\n\t\telse if ($(e).hasClass('easyui-datetimebox')) {\r\n\t\t\tif (!$(e).hasClass('datetimebox-f')) $(e).datetimebox();\r\n\t\t\te = $(e).datetimebox(\"textbox\").parent();\r\n\t\t}\r\n\t\telse if ($(e).hasClass('easyui-combobox')) {\r\n\t\t\tif (!$(e).hasClass('combobox-f')) $(e).combobox();\r\n\t\t\te = $(e).combobox(\"textbox\").parent();\r\n\t\t\t\r\n\t\t}\r\n\t\telse if ($(e).hasClass('easyui-numberbox')) {\r\n\t\t\tif (!$(e).hasClass('numberbox-f')) $(e).numberbox();\r\n\t\t\te = $(e).numberbox(\"textbox\").parent();\r\n\t\t}\r\n\t\tvar cl = $(e).attr('class');\r\n\t\tif (cl !== undefined){\r\n\t\t\tvar classList = cl.split(/\\s+/);\r\n\t\t\t$.each( classList, function(index, item){\r\n\t\t\t\tif (item.indexOf('error-type-') >= 0) {\r\n\t\t\t\t\t$(e).toggleClass(item, false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tclearAllErrorType() {\r\n\t\tlet this_ = this;\r\n\t\t$.each($(\"[class*=error-type-]\"), function(i, em){\r\n\t\t\tthis_.delErrorType(em);\r\n\t\t});\r\n\t}\r\n}","export class EventOps {\r\n\r\n\tstatic ctrlPressed = false;\r\n\tstatic shiftPressed = false;\r\n\t\r\n\tstatic init(app) {\r\n\t\tlet _this = this;\r\n\t\t$(window).keydown(function(e) {\r\n\t\t\tif (e.which == 16) {\r\n\t\t\t\t_this.shiftPressed = true;\r\n\t\t\t} else if (e.which == 17) {\r\n\t\t\t\t_this.ctrlPressed = true;\r\n\t\t\t}\r\n\t\t\tif (e.ctrlKey) {          \r\n\t\t\t\tif (e.keyCode == 65) {                         \r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}            \r\n\t\t\t}\r\n\t\t}).keyup(function(e) {\r\n\t\t\tif (e.which == 16) {\r\n\t\t\t\t_this.shiftPressed = false;\r\n\t\t\t} else if (e.which == 17) {\r\n\t\t\t\t_this.ctrlPressed = false;\r\n\t\t\t} else if (e.which == 114) {\r\n\t\t\t\tif (searchTreeId != null && searchTreeVal != null) {\r\n\t\t\t\t\tif ($('#_' + searchTreeId).hasClass('treetable-search'))\r\n\t\t\t\t\t\tapp.ifcController.findTreeTableNode(searchTreeId, searchTreeVal);\r\n\t\t\t\t\telse if ($('#_' + searchTreeId).hasClass('table-search'))\r\n\t\t\t\t\t\tapp.ifcController.findTableNode(searchTreeId, searchTreeVal);\r\n\t\t//\t\t\telse if ($('#_' + searchTreeId).hasClass('treefield-search'))\r\n\t\t//\t\t\t\tfindNode(searchTreeId, searchTreeVal, true);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tapp.ifcController.findNode(searchTreeId, searchTreeVal, false);\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(window).mousedown(function(e){\r\n\t\t\tif(e.shiftKey){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\t$(\"#ui-body\").on(\"click\", function() {\r\n\t\t\t$(\"input\").off(\"keyup\");\r\n\t\t\t$(\"input\").keyup(function (e) {\r\n\t\t\t\tif (e.keyCode == 13) {\r\n\t\t\t\t\tconsole.log(\"input keyup events js\")\r\n\t\t\t\t\t$(this).trigger('blur');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t})\r\n\r\n\t\t\r\n\t\t\r\n\t}\r\n}","import {Util} from './util.js';\r\n\r\nexport class Help {\r\n\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\t//$('#help-panel .portlet').css('height', ($(window).height()-160)+\"px\");\r\n\t\t//$('.easyui-panel:not(.tamur-tabs)').panel();\r\n\t\t\t\r\n\t\tthis.loadHelp();\r\n\t}\r\n\t\r\n\tloadHelp() {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"sfunc\":1, \"cls\":\"XmlUtil\", \"name\":\"getHelpTabs\"};\r\n\t\tthis.app.post(par).then(data => {\r\n\t\t\t_this.parseHelpTabs(data)\r\n\t\t});\r\n\t}\r\n\t\r\n\tparseHelpTabs(res) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tif (res.tabs) {\r\n\t\t\t$.each(res.tabs, function(i, tab) {\r\n\t\t\t\tvar html = '<div class=\"Ek-help\" title=\"' + tab.title + '\"';\r\n\r\n\t\t\t\tif (tab.pic && tab.pic.length > 10) {\r\n\t\t\t\t\thtml += 'data-options=\"iconCls:\\'icon-' + tab.id + '\\'\"';\r\n\r\n\t\t\t\t\tvar css = '.icon-' + tab.id +' {background: url(\"' + tab.pic + '\") no-repeat scroll center center}';\r\n\t\t\t\t\t$('style').first().append('\\n' + css);\r\n\t\t\t\t}\r\n\r\n\t\t\t\thtml += ' style=\"padding:20px;\">';\r\n\t\t\t\t\r\n\t\t\t\tvar par = {\"sfunc\":1,\"cls\":\"XmlUtil\", \"name\":\"getHelpContent\", \"arg0\":tab.id};\r\n\t\t\t\t_this.saveAjaxRequest('POST', window.mainUrl, par, function(content) {\r\n\t\t\t\t\tif (content)\r\n\t\t\t\t\t\tcontent = content.replace('name=getHelpFile&', 'guid=' + guid + '&name=getHelpFile&');\r\n\t\t\t\t\t\r\n\t\t\t\t\thtml += content;\r\n\t\t\t\t}, 'html', false);\r\n\t\t\t\thtml += '</div>';\r\n\r\n\t\t\t\t$('#help-tab-panel').append($(html));\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$('#help-tab-panel').tabs({\r\n\t\t\t    border:false\t\t\t    \r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$( \".aboutSys\" ).click(function() {\r\n\t\t\t\t$(this).next().toggle();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tsaveAjaxRequest(type, url, params, success, dataType, async) {\r\n\t\tparams[\"rnd\"] = Util.rnd();\r\n\t\tparams[\"guid\"] = guid;\r\n\t\r\n\t\t$.ajax({\r\n\t\t\ttype : type,\r\n\t\t\turl : url,\r\n\t\t\tdata : params,\r\n\t\t\tsuccess : success,\r\n\t\t\tdataType : dataType,\r\n\t\t\tasync : async\r\n\t\t});\r\n\t}\r\n\t\t\r\n}","import {Util, DataChecker} from './util.js';\r\nimport {TableOps} from './tables.js';\r\nimport {ErrorOps} from './errors.js';\r\nimport {TooltipOps} from './tooltip.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class InterfaceController extends TableOps {\r\n\t\r\n\tdialogZindex = 345000;\r\n\tmessagerZindex = 350000;\r\n\r\n\tlastShowDate = null;\r\n\tlastShowComboValue = null;\r\n\tfocusedTable = undefined;\r\n\t\r\n\tpopupcount = 0;\r\n\tdialogResult = [];\r\n\t\r\n\tmultiSelection = {};\r\n\tdialogOpened = null;\r\n\t\r\n\tfatal = false;\r\n\tisDataIntegrityControl = false;\r\n\topts = 0;\r\n\r\n\t// whats this\r\n\tdata = 0;\r\n\tDLG_CHANGE_PD = 5; // создал Жаркын. Правильно ли сделал?\r\n\r\n\tlastDownloadTime = 0;\r\n\twaitTime = 1500;\r\n\t\r\n\tsearchCount = 0;\r\n\r\n\tstatic popDlg = [];\r\n\tstatic popDlgType = [];\r\n\tstatic styles = {};\r\n\tstatic cssStyles = {};\r\n\tstatic openedDialogs = [];\r\n\tstatic attentionMap = {};\r\n\thiddenPanels = {}\r\n\t\r\n\tconstructor(app) {\r\n\t\tsuper(app);\r\n\t\tthis.app = app;\r\n\t\tthis.errorUtil = new ErrorOps();\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tsuper.initDefaults(this);\r\n\t\t\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\t_this.setFocus();\r\n\r\n\t\t$(\"body\").append($(\"<div></div>\").attr(\"id\", \"trash\").css(\"display\", \"none\"));\r\n\t\t$(\"#trash\").append($(\"<iframe></iframe>\").attr(\"id\", \"report_frame\").css(\"display\", \"none\"));\r\n\r\n\t\t$('#ui-body').panel({\r\n\t\t\tonLoad: function() {\r\n\t\t\t\tif (typeof $(\"#ui-body .mainPanel\").attr(\"data-uiTitle\") !== \"undefined\") {\r\n\t\t\t\t\t$('.ui-title').text($(\"#ui-body .mainPanel\").attr(\"data-uiTitle\"));\t\r\n\t\t\t\t}\r\n\t\t\t\t_this.preparefileUpload();\r\n\t\t\t\t\r\n\t\t\t\t_this.clickPopUpContent('ui-body');\r\n\t\t\t\t_this.showPopUpContent();\r\n\t\t\t\t_this.movePopUpContent();\r\n\t\t\t\t\r\n\t\t\t\t// удалить все предыдущие элементы\r\n\t\t\t\t$(\".ui-toolbar\").find(\"[onTop]\").remove();\r\n\t\t\t\t\r\n\t\t\t\t_this.loadData({}, true).then(() => {\r\n\t\t\t\t\t$('#ui-header').show();\r\n\t\t\t\t\t_this.setElemForTopPane();\r\n\t\t\t\t\t_this.app.resizeHeight();\r\n\t\t\t\t\t$('#ui-body').panel('resize');\r\n\t\t\t\t\t_this.app.resize('#ui-body');\r\n\t\t\t\t});\r\n\t\t\t\t_this.loadReports();\r\n\t\t\t\t_this.app.analytic.init();\r\n\t\t\t\t\r\n\t\t\t\t$('.easyui-datebox').parent().find('.textbox-text').inputmask(\"d.m.y\", {\r\n\t\t\t\t\t\"placeholder\": \"дд.мм.гггг\",\r\n\t\t\t\t\t\"insertMode\" : false,\r\n\t\t\t\t});\r\n\t\t\t\t$('.easyui-datetimebox.minutes').parent().find('.textbox-text').inputmask(\"d.m.y h:s\", {\r\n\t\t\t\t\t\"placeholder\": \"дд.мм.гггг чч:ММ\",\r\n\t\t\t\t\t\"insertMode\" : false,\r\n\t\t\t\t});\r\n\t\t\t\t$('.easyui-datetimebox.seconds').parent().find('.textbox-text').inputmask(\"d.m.y h:s:s\", {\r\n\t\t\t\t\t\"placeholder\": \"дд.мм.гггг чч:ММ:сс\",\r\n\t\t\t\t\t\"insertMode\" : false,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(window).bind('resizeEnd', function() {\r\n\t\t\t$('#ui-body').find('.panel, .panel-body, .easyui-fluid, .easyui-panel, .easyui-tabs, .datagrid-view, .datagrid-view2, .datagrid-header, .datagrid-body, .datagrid-footer').width(0);\r\n\t\t\t$('#ui-body').width(0);\r\n\t\t\t$('#ui-body').panel('resize');\r\n\t\t\t_this.app.resize('#ui-body');\r\n\t\t});\r\n\t\t\r\n\t\t_this.initDefaults();\r\n\t\t\r\n\t\t// при изменении значения любого отправляем на сервер\r\n\t\t$(\"body\").on('change', 'input, select, textarea, iframe', function() {\r\n\t\t\tvar id = $(this).attr('id') || $(this).parent().prev().attr('id');\r\n\t\t\tvar comboSearch = $(this).parent().prev().hasClass('easyui-combobox');\r\n\t\t\tif (id == 'cellDatabox') {\r\n\t\t\t\t_this.endEditing();\r\n\t\t\t} else if (id) {\r\n\t\t\t\tvar val = \"\";\r\n\t\t\t\tif ($(this).attr('type') == 'checkbox') {\r\n\t\t\t\t\tval = $(this).prop('checked');\r\n\t\t\t\t} else \r\n\t\t\t\t\tval = $(this).val();\r\n\t\t\t\tif (!comboSearch) {\r\n\t\t\t\t\t_this.setValue(id, val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', 'button.popup', function() {\r\n\t\t\tif (!$(this).hasClass('btn-disabled')) {\r\n\t\t\t\tlet uid = $(this).attr(\"id\");\r\n\t\t\t\t$('.menu-content,.menu-shadow').hide();\r\n\t\t\t\t_this.openPopup(uid);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', 'a.popup', function() {\r\n\t\t\tif (!$(this).hasClass('btn-disabled')) {\r\n\t\t\t\tlet uid = $(this).attr(\"id\");\r\n\t\t\t\t$('.menu-content,.menu-shadow').hide();\r\n\t\t\t\t_this.openPopup(uid);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', 'a.hyper', function() {\r\n\t\t\tif (!$(this).hasClass('btn-disabled')) {\r\n\t\t\t\tlet uid = $(this).attr(\"id\");\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\tdocument.location.hash = \"cmd=openIfc&uid=\" + uid + \"&rnd=\" + Util.rnd();\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', 'a.treeField', function() {\r\n\t\t\tif (!$(this).hasClass('btn-disabled')) {\r\n\t\t\t\tlet uid = $(this).attr(\"id\");\r\n\t\t\t\t_this.openTree(uid, $(this).attr(\"title\"));\r\n\t\t\t}\t\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '.clean-btn', function(e) {\r\n\t\t\tvar par = {cmd: \"clr\", uid: $(this).attr('id').substring(3)}; // первые три символа это префикс \"clr\"\r\n\t\t\t_this.postAndParseData(par);\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', 'a[reportid]', function() {\r\n\t\t\t_this.reportClick($(this));\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '#langKz, #topLangKz', function(e) {\r\n\t\t\t_this.changeInterfaceLang('KZ', e);\r\n\t\t\tlocalStorage.setItem(\"EkyzmetLanguage\", \"KZ\");\r\n\t\t});\r\n\t\t$(\"body\").on('click', '#langRu, #topLangRu', function(e) {\r\n\t\t\t_this.changeInterfaceLang('RU', e);\r\n\t\t\tlocalStorage.setItem(\"EkyzmetLanguage\", \"RU\");\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('keypress', 'span.numberbox input.textbox-text', function(e) {\r\n\t\t\tvar maxlength = $(this).parent().prev().attr('maxlength');\r\n\t\t\tif (maxlength) {\r\n\t\t\t\tif (isCharacterKeyPress(e)) {\r\n\t\t\t\t\tvar length = $(this).val().split(',')[0].length;\r\n\t\t\t\t\tif (length >= parseInt(maxlength)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.coll-pan .ttl-coll-pan', function() {\r\n\t\t\t// первый символ это префикс \"t\", cnt - префикс контента\r\n\t\t\tvar content = $('#cnt'+ $(this).attr('id').substring(1));\r\n\t\t    if( $(content).hasClass('expanded') ){\r\n\t\t        $(content).removeClass('expanded');\r\n\t\t    } else {\r\n\t\t    \t$(content).addClass(\"expanded\");\r\n\t\t    }\r\n\t\t    return false;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.coll-pan-v .ttl-coll-pan-v', function() {\r\n\t\t\t// первый символ это префикс \"t\", cnt - префикс контента\r\n\t\t\tvar content = $('#cnt'+ $(this).attr('id').substring(1));\r\n\t\t    if( $(content).hasClass('expanded-v') ){\r\n\t\t        $(content).removeClass('expanded-v');\r\n\t\t    } else {\r\n\t\t    \t$(content).addClass(\"expanded-v\");\r\n\t\t    }\r\n\t\t    return false;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.arr-parent', function() {\r\n\t\t\tvar content = $('#cnt'+ $(this).attr('id').substring(1));\r\n\t\t    $(content).addClass(\"expanded-v\");\r\n\t\t    if ($(this).css('display') == 'block')\r\n\t\t\t\t$(this).css('display', 'none');\r\n\t\t    return false;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.accordion .ttl-coll-pan', function() {\r\n\t\t\tvar parent = $(this).parent();\r\n\t\t\t// первый символ это префикс \"t\", cnt - префикс контента\r\n\t\t\tvar content = $('#cnt'+ $(this).attr('id').substring(1));\r\n\t\t\tif ($(content).hasClass('accord')) {\t\t\r\n\t\t\t\tvar panID = $(content).attr('id');\r\n\t\t\t\tif($(parent).attr('multi') == '0'){\r\n\t\t\t\t\tvar panels = $(parent).find('.cnt-coll-pan');\r\n\t\t\t\t\tfor (var j = 0; j < panels.length; j++) {\r\n\t\t\t\t\t\tif($(panels[j]).attr('id') != panID && $(panels[j]).hasClass('expanded')){\r\n\t\t\t\t\t\t\t$(panels[j]).removeClass('expanded');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t    if($(content).hasClass('expanded') ){\r\n\t\t\t        $(content).removeClass('expanded');\r\n\t\t\t    } else {\r\n\t\t\t    \t$(content).addClass(\"expanded\");\r\n\t\t\t    }\r\n\t\t    }\r\n\t\t    return false;\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.accordion-v .ttl-coll-pan-v', function() {\r\n\t\t\tvar parent = $(this).parents('.accordion-v');\r\n\t\t\t// первый символ это префикс \"t\", cnt - префикс контента\r\n\t\t\tvar content = $('#cnt'+ $(this).attr('id').substring(1));\r\n\t\t\tif($(content).hasClass('accord')) {\r\n\t\t\t\tvar panID = $(content).attr('id');\r\n\t\t\t\tif($(parent).attr('multi') == '0'){\r\n\t\t\t\t\tvar panels = $(parent).find('.cnt-coll-pan-v');\r\n\t\t\t\t\tfor (var j = 0; j < panels.length; j++) {\r\n\t\t\t\t\t\tif($(panels[j]).attr('id') != panID && $(panels[j]).hasClass('expanded-v')){\r\n\t\t\t\t\t\t\t$(panels[j]).removeClass('expanded-v');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t    if($(content).hasClass('expanded-v')){\r\n\t\t\t        $(content).removeClass('expanded-v');\r\n\t\t\t    } else {\r\n\t\t\t    \t$(content).addClass(\"expanded-v\");\r\n\t\t\t    }\r\n\t\t    }\r\n\t\t    return false;\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitDefaults() {\r\n\t\tlet _this = this;\r\n\t\t$.blockUI.defaults.baseZ = 300000;\r\n\r\n\t\t$.extend($.fn.window.defaults, {zIndex: 110000, shadow: false});\r\n\r\n\t\t$.extend($.messager.defaults, {zIndex: this.messagerZindex, width: 450, minHeight: 100});\r\n\t\t\r\n\t\t$.fn.tabs.defaults.onSelect = function(title,index) {\r\n\t\t\tvar tp = $(this);\r\n\t\t\tvar par = {\"cmd\":\"selTab\",\"uid\":tp.attr('id'),\"indx\":index};\r\n\t\t\t\r\n\t\t\t_this.displayEmptyParentPanels(tp.tabs('getSelected'));\r\n\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t$.each(_this.tablesToReloadMap, function(key, value) {\r\n\t\t\t\t\t$.each($('#' + key).parents('.easyui-tabs'), function (i, tb) { \r\n\t\t\t\t\t\tif ($(tb).attr('id') == tp.attr('id')) {\r\n\t\t\t\t\t\t\t$('#' + key).datagrid('load');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\ttp.find('.easyui-tabs').tabs('resize');\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\t$.extend($.fn.combo.defaults, {zIndex: 150000});\r\n\t\t\r\n\t\t$.extend($.fn.combobox.defaults, {panelHeight: 'auto', panelMaxHeight: 400});\r\n\r\n\t\t// поиск в комбобоксе с учетом регистра или без по флагу options.toUpperCase\r\n\t\t$.extend($.fn.combobox.defaults.filter = function(q,row){\r\n\t\t\tvar opts = $(this).combobox('options');\r\n\t\t\tvar toUpperCase = opts.toUpperCase;\r\n\t\t\tvar s = row[opts.textField];\r\n\t\t\tif (toUpperCase) {\r\n\t\t\t\tfor (var si in s) {\r\n\t\t\t\t\tif ((typeof s[si] == \"string\" && s[si].toUpperCase().indexOf(q.toUpperCase()) >= 0)\r\n\t\t\t\t\t \t|| (s[si].title && s[si].title.toUpperCase().indexOf(q.toUpperCase()) >= 0)) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tfor (var si in s) {\r\n\t\t\t\t\tif ((typeof s[si] == \"string\" && s[si].indexOf(q) >= 0)\r\n\t\t\t\t\t \t|| (s[si].title && s[si].title.indexOf(q) >= 0)) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$.extend($.fn.menu.defaults, {\r\n\t\t\tzIndex: 120000,\r\n\t\t\tonHide: function() {\r\n\t\t\t\tif($('.calendar:visible').length > 0)\r\n\t\t\t\t\t$(this).menu('show');\r\n\t\t\t},\r\n\t\t\tonShow: function() {\r\n\t\t\t\tif ($(this).attr('id') != null && $(this).attr('id').indexOf('pop') === 0)\r\n\t\t\t\t\t$(this).unbind('mouseleave.menu').unbind('mousedown.menu');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t$.fn.datebox.defaults.onShowPanel = function() {\r\n\t\t\t_this.lastShowDate = $(this).datebox(\"getText\");\r\n\t\t};\r\n\t\t$.fn.datebox.defaults.onHidePanel = function() {\r\n\t\t\tvar id = $(this).attr('id');\r\n\t\t\tvar date = $(this).datebox(\"getText\");\r\n\t\t\tif (id == 'cellDatabox') {\r\n\t\t\t\t_this.endEditing();\r\n\t\t\t} else if (id && (date != _this.lastShowDate || date == \"\")) {\r\n\t\t\t\t_this.setValue(id, date);\r\n\t\t\t\t_this.focusNext($(this).datebox(\"textbox\"));\r\n\t\t\t}\r\n\t\t};\r\n\t\t$.fn.datetimebox.defaults.onShowPanel = function() {\r\n\t\t\t_this.lastShowDate = $(this).datetimebox(\"getText\");\r\n\t\t};\r\n\t\t$.fn.datetimebox.defaults.onHidePanel = function() {\r\n\t\t\tvar id = $(this).attr('id');\r\n\t\t\tvar date = $(this).datetimebox(\"getText\");\r\n\t\t\tif (id == 'cellDatabox') {\r\n\t\t\t\t_this.endEditing();\r\n\t\t\t} else if (id && (date != lastShowDate || date == \"\")) {\r\n\t\t\t\t_this.setValue(id, date);\r\n\t\t\t\t_this.focusNext($(this).datetimebox(\"textbox\"));\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.combobox.defaults.onShowPanel = function() {\r\n\t\t\t_this.lastShowComboValue = $(this).combobox(\"getValue\");\r\n\t\t\t//var textboxCombo = $(this).combo(\"textbox\");\r\n\t\t\t//var panelCombo = $(this).combo(\"panel\");\r\n\t\t\t//panelCombo.children(\".combobox-item\").css({\"font-size\":textboxCombo.css(\"font-size\"),\"font-family\":textboxCombo.css(\"font-family\"),\"font-style\":textboxCombo.css(\"font-style\"),\"font-weight\":textboxCombo.css(\"font-weight\")});\r\n\t\t\t//panelCombo.css(\"background-color\", \"rgb(255, 222, 173)\");\r\n\t\t};\r\n\t\t$.fn.combobox.defaults.onHidePanel = function() {\r\n\t\t\tvar tableCombobox = $(this).hasClass(\"datagrid-editable-input\");\r\n\t\t\tif (tableCombobox)\r\n\t\t\t\t_this.endEditing();\r\n\t\t\telse {\r\n\t\t\t\tvar id = $(this).attr('id');\r\n\t\t\t\tvar opts = $(this).combobox(\"options\");\r\n\t\t\t\tvar val = $(this).combobox(\"getValue\");\r\n\t\t\t\tvar data = $(this).combobox(\"getData\");\r\n\t\t\t\tvar cleanCombo = true;\r\n\t\t\t\tfor(var i = 0; i<data.length; i++) {\r\n\t\t\t\t\tif(data[i][opts.valueField] === val && id && val != _this.lastShowComboValue && val != undefined) {\r\n\t\t\t\t\t\t_this.setValue(id,val);\r\n\t\t\t\t\t\tcleanCombo = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (cleanCombo && val != _this.lastShowComboValue && id)\r\n\t\t\t\t\t$(this).combobox('clear');\r\n\t\t\t}\r\n\t\t};\r\n\t\t$.fn.combobox.defaults.onChange = function(newValue, oldValue) {\r\n\t\t\tif (newValue != oldValue)\r\n\t\t\t\t_this.errorUtil.delErrorType($(this));\r\n\t\t}\r\n\t\t$.fn.datebox.defaults.onChange = function(newValue, oldValue) {\r\n\t\t\tif (newValue != oldValue)\r\n\t\t\t\t_this.errorUtil.delErrorType($(this));\r\n\t\t}\r\n\t\t$.fn.datetimebox.defaults.onChange = function(newValue, oldValue) {\r\n\t\t\tif (newValue != oldValue)\r\n\t\t\t\t_this.errorUtil.delErrorType($(this));\r\n\t\t}\r\n\t\t\r\n\t\t$.fn.numberbox.defaults.onChange = function(newValue, oldValue) {\r\n\t\t\tif (newValue != oldValue)\r\n\t\t\t\t_this.errorUtil.delErrorType($(this));\r\n\t\t}\r\n\t\t\r\n\t\t$(\"body\").on('keyup', \".datagrid-editable-input, .numberbox .textbox-text\", function(e) {\r\n\t\t\tif (e.which && e.which == 13)\r\n\t\t\t\t_this.endEditing();\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.ortable', function(e) {\r\n\t\t\t_this.endEditing();\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.or3-btn, .popup', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t_this.endEditing();\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('keyup', \".datagrid-editable .datebox .textbox-text\", function(event) {\r\n\t\t\tif (event.which && event.which == 13) {\r\n\t\t\t\t$(this).parent().prev().combo('hidePanel');\r\n\t\t\t\t$(this).blur();\r\n\t\t\t\t_this.endEditing();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.or3-btn:not(.view-file)', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif ($(this).attr('id') && !$(this).hasClass('btn-disabled')) {\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\t_this.setValue($(this).attr('id'), 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.view-file', function(e) {\r\n\t\t\tif (!$(this).hasClass('btn-disabled')&& $(this).attr('id')) {\r\n\t\t\t\t_this.downloadFile(e, $(this).attr('id'));\r\n\t\t\t} else if ($(this).parent().attr('id')) {\r\n\t\t\t\t_this.downloadFile(e, $(this).parent().attr('id'),$(this).parent().attr('index'));\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.open-file', function(e) {\r\n\t\t\tif ($(this).attr('uid')) {\r\n\t\t\t\tvar cls = $(this).attr('cls');\r\n\t\t\t\tvar method = $(this).attr('method');\r\n\t\t\t\tvar uid = $(this).attr('uid');\r\n\t\t\t\tvar path = $(this).attr('path');\r\n\t\t\t\tvar fn = $(this).attr('fn');\r\n\t\t\t\tvar ext = $(this).attr('ext');\r\n\t\t\t\tvar index = $(this).attr('index');\r\n\t\t\r\n\t\t\t\tvar url = _this.app.restUrl + \"&sfunc&cls=\" + cls + \"&name=\" + method + \"&ext=\" + ext + \"&fn=\" + encodeURIComponent(fn) + \"&arg0=\" + uid + \"&arg1=\" + encodeURIComponent(path);\r\n\t\t\t\tif (index)\r\n\t\t\t\t\turl += \"&arg2=\" + index;\r\n\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.delete-file', function(e) {\r\n\t\t\tif ($(this).parent().attr('id')) {\r\n\t\t\t    var par = {};\r\n\t\t\t\tpar[\"uid\"] = $(this).parent().attr('id');\r\n\t\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\t\tpar[\"com\"] = \"del\";\r\n\t\t\t\tpar[\"ind\"] = $(this).parent().attr('index');\r\n\t\t\r\n\t\t\t\t_this.loadData(par);\r\n\t\t\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tsetValue(id, val) {\r\n\t\tthis.showChangeMsg();\r\n\t\tvar par = {\"uid\":id,\"val\":(val != null ? val : \"\"),\"cmd\":\"set\"};\r\n\t\tthis.loadData(par);\r\n\t}\r\n\r\n\tshowChangeMsg() {\r\n\t\t$('#saveBtn').linkbutton('enable');\r\n\t\t$('#cancelBtn').linkbutton('enable');\r\n\t}\r\n\thideAllChangeMsg() {\r\n\t\t$('#saveBtn').linkbutton('disable');\r\n\t\t$('#cancelBtn').linkbutton('disable');\r\n\t}\r\n\thideChangeMsg() {\r\n\t\t$('#saveBtn').linkbutton('disable');\r\n\t\t$('#cancelBtn').linkbutton('disable');\r\n\t}\r\n\r\n\tloadData(par) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tpar['getChange'] = '1';\r\n\t\t\t_this.app.query(par).then(response => {\r\n\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\tif (data.changes && data.changes.length > 0)\r\n\t\t\t\t\t\t\t_this.parseData(data);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tpostAndParseData(par) {\r\n\t\tlet _this = this;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t_this.app.query(par).then(response => {\r\n\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\tif (data.changes && data.changes.length > 0)\r\n\t\t\t\t\t\t\t_this.parseData(data);\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tparseData(data) {\r\n\t\tlet _this = this; \r\n\t\tif (data.changes) {\r\n\t\t\t// Пробегаем массив изменений\r\n\t\t\t$.each(data.changes, function(i, change) {\r\n\t\t\t\t// Каждое изменение - это отношенией id компонента - набор измененных свойств\r\n\t\t\t\t$.each(change, function(id, props) {\r\n\t\t\t\t\tvar comp = null;\r\n\t\t\t\t\t// Пробегаемся по открытым диалогом в обратном порядке и ищем компонент\r\n\t\t\t\t\tfor (var di = InterfaceController.openedDialogs.length - 1; di >= 0; di--) {\r\n\t\t\t\t\t\tvar dialog = $('#' + InterfaceController.openedDialogs[di]);\r\n\t\t\t\t\t\tcomp = dialog.find('#' + id);\r\n\t\t\t\t\t\t// Если компонент найден - выходим из цикла\r\n\t\t\t\t\t\tif (comp.length > 0) break; \r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Если компонент не найден в диалогах - ищем по всему окну\r\n\t\t\t\t\tif (comp == null || comp.length == 0) comp = $('#' + id);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Пробегаемся по всем измененным свойствам\r\n\t\t\t\t\t$.each(props, function(key, value) {\r\n\t\t\t\t\t\t_this.updateComponent(id, comp, key, value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t_this.app.resize('#ui-body');\r\n\t}\r\n\t\r\n\tupdateComponentStyle(comp, key, value, e_tagName, e_type) {\r\n\t\tdelete value['min-width']; // for future may be fixed\r\n\t\tdelete value['height'];\r\n\t\tdelete value['min-height'];\r\n\t\tdelete value['margin'];\r\n\t\tif (e_tagName=='TABLE') {\r\n\t\t\tdelete value['margin-right'];\r\n\t\t\tdelete value['margin-left'];\r\n\t\t\tdelete value['margin-bottom'];\r\n\t\t\tdelete value['margin-top'];\r\n\t\t\tdelete value['width'];\r\n\t\t}\r\n\t\tif (value['background-color'] != null && value['background-color'].indexOf(\"background-color\")>-1) {\r\n\t\t\tvalue['background-color'] = value['background-color'].replace(\"background-color\",\"\");\r\n\t\t}\r\n\t\tif (e_tagName == 'BUTTON' || e_tagName == 'A' || e_tagName==\"TEXTAREA\") {\r\n\t\t\t// do nothing\r\n\t\t} else if(e_tagName == 'INPUT' && e_type == \"file\") {\r\n\t\t\tcomp.parent().css(value);\r\n\t\t} else if(e_tagName == 'INPUT') {\r\n\t\t\tif (comp.hasClass('easyui-combobox')) {\r\n\t\t\t\tif (!comp.hasClass('combobox-f')) comp.combobox();\r\n\t\t\t\t$.each(value, function (akey, aval){\r\n\t\t\t\t\tif (akey == \"margin-top\" || akey == \"margin-bottom\" || akey == \"margin-left\" || akey == \"margin-right\"){\r\n\t\t\t\t\t\tcomp.next().css(akey, aval);\r\n\t\t\t\t\t} else if (akey == \"font-family\" || (akey == \"font-size\" && aval > 0)) {\r\n\t\t\t\t\t\tcomp.combobox(\"textbox\").css(akey, aval);\r\n\t\t\t\t\t} else if (akey == \"font-style\") {\r\n\t\t\t\t\t\tif (aval == 1) comp.combobox(\"textbox\").css(\"font-weight\",\"bold\");\r\n\t\t\t\t\t\tif (aval == 2) comp.combobox(\"textbox\").css(\"font-style\",\"italic\");\r\n\t\t\t\t\t\tif (aval == 3) comp.combobox(\"textbox\").css(\"font-style\",\"italic\").css(\"font-weight\",\"bold\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcomp.css(value);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateComponent(i, comp, key, value) {\r\n\t\tlet _this = this; \r\n\r\n\t\tlet e_tagName = comp.prop(\"tagName\");\r\n\t\tlet e_type = comp.attr(\"type\");\r\n\t\tlet e_class = comp.attr(\"class\");\r\n\t\tlet e_id = comp.attr(\"id\");\r\n\t\t\r\n\t\tif (key == 'st') {\r\n\t\t\t_this.updateComponentStyle(comp, key, value, e_tagName, e_type);\r\n\t\t} else if (key == 'pr') {\r\n\t\t\tvar reloadRows = undefined;\r\n\t\t\tvar comboValue = undefined;\r\n\t\t\t$.each(value, function(akey, aval) {\r\n\t\t\t\tif (akey == \"heads\") return;\r\n\t\t\t\tif (e_tagName == \"SELECT\" && akey == \"size\") return;\r\n\t\t\t\tif (e_tagName == \"TEXTAREA\" && akey == \"size\") return;\r\n\t\t\t\tif (e_tagName == \"TABLE\" && (akey == \"height\" || akey == \"width\") ) return;\r\n\t\t\t\tif (e_tagName == 'INPUT' && e_type==\"file\" && akey != \"e\" && akey != \"v\" && akey != \"text\" && akey != 'OrWebDocFieldProps' && akey != \"reloadUpload\") return;\r\n\t\t\t\tif (akey == 'text') {\r\n\t\t\t\t\tif (aval != null && $.trim(aval).length > 0) {\r\n\t\t\t\t\t\t_this.errorUtil.delErrorType(comp);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (e_type == 'radio') {\r\n\t\t\t\t\t\tcomp.find('input[type=radio][value=\"' + aval + '\"]').prop('checked', true);\r\n\t\t\t\t\t} else if (e_tagName == 'INPUT' && e_type==\"checkbox\") {\r\n\t\t\t\t\t\t// Следующий элемент\r\n\t\t\t\t\t\tvar ne = comp[0].nextSibling;\r\n\t\t\t\t\t\tif (ne == null || ne.nodeType != 3) {\r\n\t\t\t\t\t\t\tcomp.after(document.createTextNode('-'));\r\n\t\t\t\t\t\t\tne = comp[0].nextSibling;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tne.nodeValue = aval;\r\n\t\t\t\t\t} else if (e_tagName == 'INPUT' && e_type==\"file\") {\r\n\t\t\t\t\t\tcomp.parent().find('span.btn-label').html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t} else if (e_tagName == 'BUTTON') {\r\n\t\t\t\t\t\t$('#' + i+' span').html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t} else if (e_tagName == 'INPUT') {\r\n\t\t\t\t\t\tcomp.val(aval);\r\n\t\t\t\t\t\tif (comp.hasClass('easyui-datebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datebox-f')) comp.datebox();\r\n\t\t\t\t\t\t\tcomp.datebox('setValue', aval); \r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\telse if (comp.hasClass('easyui-datetimebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datetimebox-f')) comp.datetimebox();\r\n\t\t\t\t\t\t\tcomp.datetimebox('setValue', aval); \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (comp.hasClass('easyui-numberbox')) {\r\n\t\t\t\t\t\t\tcomp.numberbox('setValue', aval);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (e_tagName == 'TEXTAREA' && e_class == 'tinyMCE') {\r\n\t\t\t\t\t\ttinyMCE.get(e_id).setContent(aval);\r\n\t\t\t\t\t} else if (e_tagName == 'TEXTAREA' && e_class != 'tinyMCE') {\r\n\t\t\t\t\t\tcomp.val(aval);\r\n\t\t\t\t\t} else if (comp.hasClass('easyui-linkbutton')) {\r\n\t\t\t\t\t\tcomp.linkbutton({text:aval});\r\n\t\t\t\t\t} else if (e_tagName == 'A') {\r\n\t\t\t\t\t\tif (aval != null && aval.replace) {\r\n\t\t\t\t\t\t\tif (comp.hasClass(\"hyper\")) {\r\n\t\t\t\t\t\t\t\tcomp.html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t\t\t} else if (comp.hasClass(\"treeField\")) {\r\n\t\t\t\t\t\t\t\twhile (comp.contents().filter(function() {return this.nodeType == 3;}).length > 0) {\r\n\t\t\t\t\t\t\t\t\tcomp.contents().filter(function() {return this.nodeType == 3;}).eq(0).replaceWith('');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcomp.find('br').remove();\r\n\t\t\t\t\t\t\t\tcomp.append(document.createTextNode('-'));\r\n\t\t\t\t\t\t\t\tcomp.contents().filter(function() {return this.nodeType == 3;}).eq(0).replaceWith(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tcomp.find('span.btn-label').html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (aval != null && aval.replace) {\r\n\t\t\t\t\t\t\tcomp.html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t\t\tif (comp.hasClass('nicEdit-main')) {\r\n\t\t\t\t\t\t\t\tvar parent = comp.parents().eq(2).find('textarea#' + comp.attr('id')).html(aval.replace(/@/g,'<br/>'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'OrWebDocFieldProps') {\r\n\t\t\t\t\tcomp.parent().find('span.btn-label').html(aval.text.replace(/@/g,'<br/>'));\r\n\t\t\t\t\tvar spanElement = document.getElementById(aval.id).parentNode;\r\n\t\t\t\t\tif (aval.mode == 0) {\r\n\t\t\t\t\t\tspanElement.children[1].removeAttribute(\"id\");\r\n\t\t\t\t\t\tspanElement.children[1].removeAttribute(\"action\");\r\n\t\t\t\t\t\tspanElement.children[1].className = \"docField\";\r\n\t\t\t\t\t\tdocument.getElementById(aval.id).style.display  = \"block\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdocument.getElementById(aval.id).style.display  = \"none\";\r\n\t\t\t\t\t\tspanElement.children[1].setAttribute(\"id\", aval.id);\r\n\t\t\t\t\t\tspanElement.children[1].setAttribute(\"action\", \"0\");\r\n\t\t\t\t\t\tspanElement.children[1].className = \"or3-btn view-file trBtn\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (aval.iconBytes.length > 0) {\r\n\t\t\t\t\t\tspanElement.children[0].style.display  = \"inline\";\r\n\t\t\t\t\t\tspanElement.children[0].src = \"data:image/png;base64,\" + aval.iconBytes; \r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tspanElement.children[0].style.display  = \"none\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'rootPanelTitle') {\r\n\t\t\t\t\t$(\"#uiTitle\").text(aval);\r\n\t\t\t\t\t$(\".fullPath-l\").text(aval);\r\n\t\t\t\t} else if (akey == \"hyperPopupAttention\") {\r\n\t\t\t\t\tif (aval == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tif ($('#' + i).length > 0) {\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (document.getElementById(i).style.backgroundColor == \"palegreen\") {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"palegreen\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"buttonAttention\") {\r\n\t\t\t\t\tif (aval == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tif ($('#' + i).length > 0) {\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (document.getElementById(i).style.backgroundColor == \"rgb(79, 209, 197)\") {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"#4fd1c5\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"dateFieldAttention\") {\r\n\t\t\t\t\tvar tb = $('#' + i).datebox('textbox');\r\n\t\t\t\t\tif (aval == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tvar color = tb.add(tb.parent()).css(\"background-color\");\r\n\t\t\t\t\t\t\tif (color == \"rgb(152, 251, 152)\") {\r\n\t\t\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"white\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"palegreen\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"white\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"textFieldAttention\") {\r\n\t\t\t\t\tif (aval == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tif (document.getElementById(i).style.backgroundColor == \"palegreen\") {\r\n\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"palegreen\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\tdocument.getElementById(i).style.background  = \"initial\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"comboBoxAttention\") {\r\n\t\t\t\t\tvar tb = $('#' + i).combobox('textbox');\r\n\t\t\t\t\tif (aval == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tvar color = tb.add(tb.parent()).css(\"background-color\");\r\n\t\t\t\t\t\t\tif (color == \"rgb(152, 251, 152)\") {\r\n\t\t\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"white\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"palegreen\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\ttb.add(tb.parent()).css(\"background-color\",\"white\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"docFieldColumnAttention\") {\r\n\t\t\t\t\tvar dg = $('#' + aval.parent);\r\n\t\t\t\t\tvar td = dg.datagrid('getPanel').find('div.datagrid-header td[field=\"' + i + '\"]');\r\n\t\t\t\t\tif (aval.value == 1) {\r\n\t\t\t\t\t\tInterfaceController.attentionMap[i] = setInterval(function() {\r\n\t\t\t\t\t\t\tvar color = td.css('background-color');\r\n\t\t\t\t\t\t\tif (color == \"rgb(152, 251, 152)\") {\r\n\t\t\t\t\t\t\t\ttd.css('background-color','initial');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttd.css('background-color','palegreen');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclearInterval(InterfaceController.attentionMap[i]);\r\n\t\t\t\t\t\tdelete InterfaceController.attentionMap[i];\r\n\t\t\t\t\t\ttd.css('background-color','initial');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"columnTitle\") {\r\n\t\t\t\t\tvar dg = $('#' + aval.parent);\r\n\t\t\t\t\tvar span = dg.datagrid('getPanel').find('div.datagrid-header td[field=\"' + i + '\"] div.datagrid-cell span:not(.datagrid-sort-icon)');\r\n\t\t\t\t\tspan.html(aval.value);\r\n\t\t\t\t} else if (akey == \"accordionPanelsVisible\") {\r\n\t\t\t\t\t$.each(aval, function(i, c1) {\r\n\t\t\t\t\t\t$.each(c1, function(j, c2) {\r\n\t\t\t\t\t\t\tvar visible = c2.visible;\r\n\t\t\t\t\t\t\tvar spanElementId = c2.spanElementId;\r\n\t\t\t\t\t\t\tvar divElementId = c2.divElementId;\r\n\t\t\t\t\t\t\tvar spanElement = document.getElementById(spanElementId);\r\n\t\t\t\t\t\t\tvar divElement = document.getElementById(divElementId);\r\n\t\t\t\t\t\t\tif (visible == 0) {\r\n\t\t\t\t\t\t\t    if ($('#' + divElementId).hasClass('expanded')) {\r\n\t\t\t\t\t\t\t    \t$('#' + divElementId).removeClass('expanded');\r\n\t\t\t\t\t\t\t    }\r\n\t\t\t\t\t\t\t\tspanElement.style.visibility = \"hidden\";\r\n\t\t\t\t\t\t\t\tspanElement.style.height = \"0px\";\r\n\t\t\t\t\t\t\t\tdivElement.style.visibility = \"hidden\";\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tspanElement.style.visibility = \"visible\";\r\n\t\t\t\t\t\t\t\tspanElement.style.height = \"14px\"\r\n\t\t\t\t\t\t\t\tdivElement.style.visibility = \"visible\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == \"accordionPanelDynTitle\") {\r\n\t\t\t\t\tvar elementId = \"t\" + aval.index + i;\r\n\t\t\t\t\tvar element = document.getElementById(elementId);\r\n\t\t\t\t\telement.textContent = aval.title;\r\n\t\t\t\t} else if (akey == \"limitExceededMessage\") {\t\r\n\t\t\t\t\tvar toolbarElement = document.getElementById(\"emt\" + i);\r\n\t\t\t\t\tif (toolbarElement) {\r\n\t\t\t\t\t\tvar html = toolbarElement.innerHTML;\r\n\t\t\t\t\t\tvar i1 = html.indexOf('<td width=\"100%\">');\r\n\t\t\t\t\t\tvar i2 = html.indexOf('</td>', i1);\r\n\t\t\t\t\t\tvar res = html.substring(i1, i2 + 5);\r\n\t\t\t\t\t\tif (aval.length > 0) {\r\n\t\t\t\t\t\t\thtml = html.replace(res, '<td width=\"100%\" style=\"color:red;padding-left:10;padding-right:10;\">' + aval + '</td>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(res, '<td width=\"100%\"></td>');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoolbarElement.innerHTML = html;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'checked') {\r\n\t\t\t\t\tif (e_tagName == 'INPUT' && e_type == 'checkbox') {\r\n\t\t\t\t\t\tif(aval){\r\n\t\t\t\t\t\t\tcomp.prop('checked', true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcomp.prop('checked', false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'value') {\r\n\t\t\t\t\tif (aval != null && $.trim(aval).length > 0) {\r\n\t\t\t\t\t\t_this.errorUtil.delErrorType(comp);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (e_tagName == 'INPUT' ) {\r\n\t\t\t\t\t\tcomp.val(aval);\r\n\t\t\t\t\t\tif (comp.hasClass('easyui-datebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datebox-f')) comp.datebox();\r\n\t\t\t\t\t\t\tcomp.datebox('setValue', aval); \r\n\t\t\t\t\t\t} else if (comp.hasClass('easyui-datetimebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datetimebox-f')) comp.datetimebox();\r\n\t\t\t\t\t\t\tcomp.datetimebox('setValue', aval); \r\n\t\t\t\t\t\t} else if (comp.hasClass('easyui-combobox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('combobox-f')) comp.combobox();\r\n\t\t\t\t\t\t\tcomp.combobox('setValue', aval);\r\n\t\t\t\t\t\t} else if (comp.hasClass('easyui-numberbox')) {\r\n\t\t\t\t\t\t\tcomp.numberbox('setValue', aval);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'content') {\r\n\t\t\t\t\tif (comp.hasClass('easyui-combobox')) {\r\n\t\t\t\t\t\tif (!comp.hasClass('combobox-f')) comp.combobox();\r\n\t\t\t\t\t\tvar options = [];\r\n\t\t\t\t\t\tvar j = 0;\r\n\t\t\t\t\t\t$.each(aval, function(ok, ov) { // select\r\n\t\t\t\t\t\t\t// options\r\n\t\t\t\t\t\t\tvar ti = i + '-title';\r\n\t\t\t\t\t\t\toptions[j] = {};\r\n\t\t\t\t\t\t\toptions[j][ti] = ov.o;\r\n\t\t\t\t\t\t\toptions[j++][i] = ov.u;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar selectedValue = comp.combobox('getValue');\r\n\t\t\t\t\t\tcomp.combobox('loadData', options);\r\n\t\t\t\t\t\tcomp.combobox({\r\n\t\t\t\t\t\t\tformatter: comboTableFormat\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tcomp.combobox('setValue', selectedValue);\r\n\t\t\t\t\t} else if(e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\tvar options = '';\r\n\t\t\t\t\t\t$.each(aval, function(ok, ov) { // select\r\n\t\t\t\t\t\t\t// options\r\n\t\t\t\t\t\t\toptions += '<option value=\"' + ok + '\">' + ov.o + '</option>';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tcomp.html(options);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'fFam'){\r\n\t\t\t\t\tif (e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\tcomp.children('option').css(\"font-family\",aval);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'fSize'){\r\n\t\t\t\t\tif (e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\tcomp.children('option').css(\"font-size\",aval);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'fStyle'){\r\n\t\t\t\t\tif (e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\tif (aval == 1) comp.children('option').css(\"font-weight\",\"bold\");\r\n\t\t\t\t\t\tif (aval == 2) comp.children('option').css(\"font-style\",\"italic\");\r\n\t\t\t\t\t\tif (aval == 3) comp.children('option').css(\"font-style\",\"italic\").css(\"font-weight\",\"bold\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if(akey == 'nocopy'){\r\n\t\t\t\t\tvar showComp = comp;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar Table = showComp.hasClass(\"easyui-datagrid\");\r\n\t\t\t\t\tif(aval == 0) {\r\n\t\t\t\t\t\tif(Table){comp.prev().children(\".datagrid-body\").attr(\"oncopy\",\"return false\").attr(\"ondragstart\",\"return false\");}\r\n\t\t\t\t\t} else if(aval == 1){\r\n\t\t\t\t\t\tif(Table){comp.prev().children(\".datagrid-body\").removeAttr(\"oncopy\").removeAttr(\"ondragstart\");}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey=='change') {\r\n\t\t\t    \t_this.errorUtil.delErrorType(comp);\r\n\t\t\t    \tcomboValue = aval;\r\n\t\t\t\t} else if (akey == \"img\" && !comp.hasClass('staticImg')) {\r\n\t\t\t\t\tif (aval.src)\r\n\t\t\t\t\t\tcomp.attr(\"src\", window.contextName + \"/images/foto/\" + aval.src);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tcomp.attr(\"src\", window.contextName + \"/jsp/media/img/nofoto.png\");\r\n\t\t\t\t} else if (akey == \"e\") {\r\n\t\t\t\t\tif (aval == 0) {\r\n\t\t\t\t\t\tif (comp.hasClass('treeField')||comp.hasClass('popup')){\r\n\t\t\t\t\t\t\tif($('#clr' + i)){\r\n\t\t\t\t\t\t\t\t$('#clr' + i).hide();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (e_tagName == 'INPUT' && comp.hasClass('easyui-datebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datebox-f')) comp.datebox();\r\n\t\t\t\t\t\t\tcomp.datebox('disable');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar fld = comp.parent().find('.textbox-text');\r\n\t\t\t\t\t\t\tvar cal = comp.parent().find('.textbox-addon');\r\n\t\t\t\t\t\t\tfld.removeAttr(\"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar hidePanel = comp.attr('hidePanel') == 'true';\r\n\t\t\t\t\t\t\tif (!hidePanel && cal.css('display') != \"none\") {\r\n\t\t\t\t\t\t\t\tcal.hide();\r\n\t\t\t\t\t\t\t\tfld.width(fld.width() + 18);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (e_tagName == 'INPUT' && comp.hasClass('easyui-datetimebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datetimebox-f')) comp.datetimebox();\r\n\t\t\t\t\t\t\tcomp.datetimebox('disable');\r\n\r\n\t\t\t\t\t\t\tvar fld = comp.parent().find('.textbox-text');\r\n\t\t\t\t\t\t\tvar cal = comp.parent().find('.textbox-addon');\r\n\t\t\t\t\t\t\tfld.removeAttr(\"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar hidePanel = comp.attr('hidePanel') == 'true';\r\n\t\t\t\t\t\t\tif (!hidePanel && cal.css('display') != \"none\") {\r\n\t\t\t\t\t\t\t\tcal.hide();\r\n\t\t\t\t\t\t\t\tfld.width(fld.width() + 18);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if(e_tagName == 'INPUT' && comp.hasClass('easyui-combobox')){\r\n\t\t\t\t\t\t\tif(!comp.hasClass('combobox-f')) comp.combobox();\r\n\t\t\t\t\t\t\tcomp.combobox('disable');\r\n\t\t\t\t\t\t\tcomp.parent().find('.textbox-text').attr(\"disabled\",\"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == 'INPUT' && e_type == 'file') {\r\n\t\t\t\t\t\t\tcomp.attr(\"disabled\", \"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t\tcomp.parent().addClass('btn-disabled');\r\n\t\t\t\t\t\t} else if (comp.hasClass('easyui-numberbox')) {\r\n\t\t\t\t\t\t\tcomp.numberbox(\"readonly\", true);\r\n\t\t\t\t\t\t} else if ((e_tagName == \"INPUT\" && e_type == 'text') || e_tagName == \"TEXTAREA\") {\r\n\t\t\t\t\t\t\tcomp.attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t} else if (comp.attr('wysiwyg') == '1' || comp.attr('wysiwyg') == 'true' || comp.attr('contentEditable') == 'true') {\r\n\t\t\t\t\t\t\tvar tarea = $('textarea[id=' + i + ']');\r\n\t\t\t\t\t\t\tif (tarea.length > 0) {\r\n\t\t\t\t\t\t\t\tnicEditors.findEditor(tarea.get(0)).disable();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (e_type == 'radio') {\r\n\t\t\t\t\t\t\tcomp.find('input[type=radio]').attr(\"disabled\", \"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == \"INPUT\" || e_tagName == \"BUTTON\" || e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\t\tcomp.attr(\"disabled\", \"disabled\").attr(\"readonly\", \"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == \"A\") {\r\n\t\t\t\t\t\t\tcomp.addClass('btn-disabled');\r\n\t\t\t\t\t\t} else if (e_tagName == \"IMG\") {\r\n\t\t\t\t\t\t\tcomp.unbind('contextmenu');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (aval == 1) {\r\n\t\t\t\t\t\tif (comp.hasClass('treeField')||comp.hasClass('popup')){\r\n\t\t\t\t\t\t\tif($('#clr' + i)){\r\n\t\t\t\t\t\t\t\t$('#clr' + i).show();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (e_tagName == 'INPUT' && comp.hasClass('easyui-datebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datebox-f')) comp.datebox();\r\n\t\t\t\t\t\t\tcomp.datebox('enable');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar fld = comp.parent().find('.textbox-text');\r\n\t\t\t\t\t\t\tvar cal = comp.parent().find('.textbox-addon');\r\n\t\t\t\t\t\t\tfld.removeAttr(\"readonly\");\r\n\r\n\t\t\t\t\t\t\tvar hidePanel = comp.attr('hidePanel') == 'true';\r\n\t\t\t\t\t\t\tif (!hidePanel && cal.css('display') == \"none\") {\r\n\t\t\t\t\t\t\t\tcal.show();\r\n\t\t\t\t\t\t\t\tfld.width(fld.width() - 18);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (e_tagName == 'INPUT' && comp.hasClass('easyui-datetimebox')) {\r\n\t\t\t\t\t\t\tif (!comp.hasClass('datetimebox-f')) comp.datetimebox();\r\n\t\t\t\t\t\t\tcomp.datetimebox('enable');\r\n\r\n\t\t\t\t\t\t\tvar fld = comp.parent().find('.textbox-text');\r\n\t\t\t\t\t\t\tvar cal = comp.parent().find('.textbox-addon');\r\n\t\t\t\t\t\t\tfld.removeAttr(\"readonly\");\r\n\r\n\t\t\t\t\t\t\tvar hidePanel = comp.attr('hidePanel') == 'true';\r\n\t\t\t\t\t\t\tif (!hidePanel && cal.css('display') == \"none\") {\r\n\t\t\t\t\t\t\t\tcal.show();\r\n\t\t\t\t\t\t\t\tfld.width(fld.width() - 18);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if(e_tagName == 'INPUT' && comp.hasClass('easyui-combobox')){\r\n\t\t\t\t\t\t\tif(!comp.hasClass('combobox-f')) comp.combobox();\r\n\t\t\t\t\t\t\tcomp.combobox('enable');\r\n\t\t\t\t\t\t\tcomp.parent().find('.textbox-text').removeAttr(\"disabled\").removeAttr(\"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == 'INPUT' && e_type == 'file') {\r\n\t\t\t\t\t\t\tcomp.removeAttr(\"disabled\").removeAttr(\"readonly\");\r\n\t\t\t\t\t\t\tcomp.parent().removeClass('btn-disabled');\r\n\t\t\t\t\t\t} else if (comp.hasClass('easyui-numberbox')) {\r\n\t\t\t\t\t\t\tcomp.numberbox(\"readonly\", false);\r\n\t\t\t\t\t\t} else if ((e_tagName == \"INPUT\" && e_type == 'text') || e_tagName == \"TEXTAREA\") {\r\n\t\t\t\t\t\t\tcomp.removeAttr(\"readonly\");\r\n\t\t\t\t\t\t} else if (comp.attr('wysiwyg') == '1' || comp.attr('wysiwyg') == 'true' || comp.attr('contentEditable') == 'false') {\r\n\t\t\t\t\t\t\tvar tarea = $('textarea[id=' + i + ']');\r\n\t\t\t\t\t\t\tif (tarea.length > 0) {\r\n\t\t\t\t\t\t\t\tnicEditors.findEditor(tarea.get(0)).elm.setAttribute('contentEditable', 'true');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (e_type == 'radio') {\r\n\t\t\t\t\t\t\tcomp.find('input[type=radio]').removeAttr(\"disabled\").removeAttr(\"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == \"INPUT\" || e_tagName == \"BUTTON\" || e_tagName == \"SELECT\") {\r\n\t\t\t\t\t\t\tcomp.removeAttr(\"disabled\").removeAttr(\"readonly\");\r\n\t\t\t\t\t\t} else if (e_tagName == \"A\") {\r\n\t\t\t\t\t\t\tcomp.removeClass('btn-disabled');\r\n\t\t\t\t\t\t} else if (e_tagName == \"IMG\") {\r\n\t\t\t\t\t\t\tcomp.bind('contextmenu', function(e) {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t$('#mm' + i).menu('show', {\r\n\t\t\t\t\t\t\t\t\tleft: e.pageX,\r\n\t\t\t\t\t\t\t\t\ttop: e.pageY\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"ne\") {\r\n\t\t\t\t\t// button enable for navi\r\n\t\t\t\t\tif (aval.length) {\r\n\t\t\t\t\t\t$.each(aval, function(nbi, nb) {\r\n\t\t\t\t\t\t\tvar actionId = nb.actionId;\r\n\t\t\t\t\t\t\tvar compb = $('#' + actionId);\r\n\t\t\t\t\t\t\tif (nb.e == 1)\r\n\t\t\t\t\t\t\t\t_this.enableNaviBtn(compb, true);\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t_this.enableNaviBtn(compb, false);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar actionId = aval.actionId;\r\n\t\t\t\t\t\tvar compb = $('#' + actionId);\r\n\t\t\t\t\t\tif (aval.e == 1)\r\n\t\t\t\t\t\t\t_this.enableNaviBtn(compb, true);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t_this.enableNaviBtn(compb, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"navi\") { // toolbar for datagrid\r\n\t\t\t\t\tvar toolbar = [];\r\n\t\t\t\t\tvar btns='';\r\n\t\t\t\t\t$.each(aval.pr.toolBar.buttons, function(bi, btn) {\r\n\t\t\t\t\t\tif (btn.button && btn.menu){\r\n\t\t\t\t\t\t      toolbar.push({\r\n\t\t\t\t\t\t        iconCls:'icon-'+  btn.button.pr.actionId// ,\r\n\t\t\t\t\t\t\t });\r\n                           addStyle('.icon-'+  btn.button.pr.actionId+' {background: url(\"'+btn.button.pr.img.src+'\")  no-repeat scroll center center / cover  transparent; height:26px;}');\r\n\t\t\t\t\t\t}else if (btn.pr && btn.pr.img && btn.pr.img.src != \"separator.png\") {\r\n\t\t\t\t\t\t  if (btn.pr.img.src.indexOf('addNavi')>0) {\r\n\t\t\t\t\t\t   toolbar.push({\r\n\t\t\t\t\t\t\t    text: btn.pr.textInfo,\r\n\t\t\t\t\t\t\t\ticonCls: btn.pr.img.bytes ? 'icon-'+btn.pr.actionId : 'icon-add',\r\n                                id:btn.pr.actionId,\r\n                                disabled:btn.pr.e==0,\r\n                                handler:function(){\r\n                                    dgBtnAction('add',i);\r\n                                }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t    if (btn.pr.img.bytes) {\r\n\t\t\t\t\t\t\t\taddStyle('.icon-' + btn.pr.actionId + ' {background: url(\"data:image/png;base64,' + btn.pr.img.bytes + '\")}');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbtns += '<td><a href=\"javascript:void(0)\" class=\"l-btn l-btn-small l-btn-plain';\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (btn.pr.e==0)\r\n\t\t\t\t\t\t\t\tbtns += ' l-btn-disabled l-btn-plain-disabled';\r\n\r\n\t\t\t\t\t\t\tbtns += '\" group=\"\" id='+btn.pr.actionId+' onclick=\"dgBtnAction2(\\'add\\',\\''+i+'\\', $(this))\">'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-left l-btn-icon-left\">'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-text l-btn-empty\">&nbsp;</span>'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-icon icon-add\">&nbsp;</span></span>'\r\n\t\t\t\t\t\t\t\t+'</a></td>';\r\n\t\t\t\t\t\t  } else if (btn.pr.img.src.indexOf('delNavi')>0) {\r\n\t\t\t\t\t\t      toolbar.push({\r\n\t\t\t\t\t\t\t    text: btn.pr.textInfo,\r\n\t\t\t\t\t\t        iconCls: btn.pr.img.bytes ? 'icon-'+btn.pr.actionId : 'icon-remove',\r\n                                id:btn.pr.actionId,\r\n                                disabled:btn.pr.e==0,\r\n                                handler:function(){\r\n                                    dgBtnAction('del',i);\r\n                                }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t    if (btn.pr.img.bytes) {\r\n\t\t\t\t\t\t\t\taddStyle('.icon-' + btn.pr.actionId + ' {background: url(\"data:image/png;base64,' + btn.pr.img.bytes + '\")}');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbtns += '<td><a href=\"javascript:void(0)\" class=\"l-btn l-btn-small l-btn-plain';\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (btn.pr.e==0)\r\n\t\t\t\t\t\t\t\tbtns += ' l-btn-disabled l-btn-plain-disabled';\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbtns += '\" group=\"\" id='+btn.pr.actionId+' onclick=\"dgBtnAction2(\\'del\\',\\''+i+'\\', $(this))\">'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-left l-btn-icon-left\">'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-text l-btn-empty\">&nbsp;</span>'\r\n\t\t\t\t\t\t\t\t+'<span class=\"l-btn-icon icon-remove\">&nbsp;</span></span>'\r\n\t\t\t\t\t\t\t\t+'</a></td>';\r\n\t\t\t\t\t\t  } else if (btn.pr.img.src.indexOf('showDel')>-1) {\r\n\t\t\t\t\t\t\t  var un = btn.pr.img.src.indexOf('showDelUn')>-1;\r\n\t\t\t\t\t\t      toolbar.push({\r\n\t\t\t\t\t\t    \ttext: btn.pr.tt,\r\n\t\t\t\t\t\t\t\ticonCls: un ? 'icon-showDelUn' : 'icon-showDel',\r\n                                uid:i,\r\n                                handler:function(){\r\n                                    dgBtnAction('showDel', i, $(this));\r\n                                }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t  }else{\r\n\t\t\t\t\t\t      toolbar.push({\r\n\t\t\t\t\t\t\t    text: btn.pr.textInfo,\r\n\t\t\t\t\t\t        iconCls:'icon-'+ btn.pr.actionId,\r\n\t\t\t\t\t\t        uid:i,\r\n                                handler:function(){\r\n                                    dgBtnAction(btn.pr.img.src,i);\r\n                                }\r\n\t\t\t\t\t\t\t });\r\n\t\t\t\t\t\t\t if (btn.pr.img.bytes) {\r\n\t\t\t\t\t\t\t\taddStyle('.icon-' + btn.pr.actionId + ' {background: url(\"data:image/png;base64,' + btn.pr.img.bytes + '\")}');\r\n\t\t\t\t\t\t     } else {\r\n\t\t\t\t\t\t    \taddStyle('.icon-'+  btn.pr.actionId+' {background: url(\"'+btn.pr.img.src+'\")  no-repeat scroll center center / cover  transparent;}');\r\n\t\t\t\t\t\t     }\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar toolbar_t = $(\"#emt\" + i);\r\n\t\t\t\t\tvar p_info=false;\r\n\t\t\t\t\tif(toolbar_t !=null && typeof toolbar_t.html() != 'undefined'){\r\n\t\t\t\t\t\ttoolbar = $(\"#emt\" + i);\r\n\t\t\t\t\t\tp_info=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (comp.hasClass('or3-icon-table')) {\r\n\t\t\t\t\t\tcomp.panel({\r\n\t\t\t\t\t\t\ttools: toolbar,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcomp.datagrid({\r\n\t\t\t\t\t\t\ttoolbar: toolbar,\r\n\t\t\t\t\t\t\tloadFilter: function(data){\r\n\t\t\t\t\t\t\t\tvar toolbar_rows = $(this).parents(\".datagrid\").find(\".datagrid-toolbar:first .datagrid-count\");\r\n\t\t\t\t\t\t\t\t$(toolbar_rows).text(data.total);\r\n\t\t\t\t\t\t\t\treturn data;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(p_info){\r\n\t\t\t\t\t\t\tvar dg_toolbar = comp.parents(\".datagrid\").find(\".datagrid-toolbar:first\");\r\n\t\t\t\t\t\t\tif (dg_toolbar.find(\".datagrid-count\").is(\"div\") == false){\r\n\t\t\t\t\t\t\t\tif(btns!='')\r\n\t\t\t\t\t\t\t\t\t$(btns).insertBefore(dg_toolbar.find(\"table tr td\"));\r\n\t\t\t\t\t\t\t\t$('<td style=\"width: 100%; display: flex;\"><div class=\"datagrid-sel pagination-info\" style=\"display: inline-block;\"></div><div class=\"datagrid-count pagination-info\" style=\"display: inline-block;\"></div></td>').appendTo(dg_toolbar.find(\"table tr\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"tabs\") { // tabs\r\n\t\t\t\t\tvar firstShownIndex = -1;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t$.each(aval, function(ti, tab) {\r\n\t\t\t\t\t\t\tvar tabIndex = tab.index;\r\n\t\t\t\t\t\t\tvar tabVisible = tab.v;\r\n\t\t\t\t\t\t\tvar tabSelect = tab.selected;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (tabVisible == 1) {\r\n\t\t\t\t\t\t\t\tif (firstShownIndex == -1)\r\n\t\t\t\t\t\t\t\t\tfirstShownIndex = tabIndex;\r\n\t\t\t\t\t\t\t\t$(\"#\" + i + \" ul.tabs > li\").eq(tabIndex).show();\r\n\t\t\t\t\t\t\t\tif (tabSelect) {\r\n\t\t\t\t\t\t\t\t\tcomp.tabs('select', tabIndex);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\t\t$(\"#\" + i + \" ul.tabs > li\").eq(tabIndex).hide();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar tab = comp.tabs('getSelected');\r\n\t\t\t\t\t\tvar index = comp.tabs('getTabIndex',tab);\r\n\t\t\t\t\t\tif (firstShownIndex > -1 && !$(\"#\" + i + \" ul.tabs > li\").eq(index).is(\":visible\"))\r\n\t\t\t\t\t\t\tcomp.tabs('select', firstShownIndex);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar totalWidth = 0;\r\n\t\t\t\t\t\t$.each($('#' + i + ' ul.tabs:first > li'), function(ind, li) {\r\n\t\t\t\t\t\t\tif ($(li).is(\":visible\")) {\r\n\t\t\t\t\t\t\t\ttotalWidth += $(li).width();\r\n\t\t\t\t\t\t\t\tconsole.log(ind + ' = ' + $(li).width());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log('total = ' + totalWidth);\r\n\t\t\t\t\t\tconsole.log('wrap = ' + $('#' + i + ' .tabs-header:first').width());\r\n\t\t\t\t\t\tif (totalWidth >= $('#' + i + ' .tabs-header:first').width()) {\r\n\t\t\t\t\t\t\t$('#' + i + ' .tabs-scroller-left:first').removeClass('or3-hide');\r\n\t\t\t\t\t\t\t$('#' + i + ' .tabs-scroller-right:first').removeClass('or3-hide');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$('#' + i + ' .tabs-scroller-left:first').addClass('or3-hide');\r\n\t\t\t\t\t\t\t$('#' + i + ' .tabs-scroller-right:first').addClass('or3-hide');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\tUtil.logErrorInfo(\"Error parsing 'tabs' property\", err);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"v\") {\r\n\t\t\t\t\tvar showComp = comp;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (showComp.length > 0) {\r\n\t\t\t\t\t\tif (e_tagName == 'INPUT' && (e_type == 'checkbox' || e_type == 'file'))\r\n\t\t\t\t\t\t\tshowComp = comp.parent();\r\n\t\t\t\t\t\telse if (comp.parent().get(0) && comp.parent().get(0).tagName == 'FIELDSET' && e_type == 'radio')\r\n\t\t\t\t\t\t\tshowComp = comp.parent();\r\n\t\t\t\t\t\telse if (comp.parent().parent().parent().get(0) && comp.parent().parent().parent().get(0).tagName == 'FIELDSET')\r\n\t\t\t\t\t\t\tshowComp = comp.parent().parent().parent();\r\n\r\n\t\t\t\t\t\t// спрятать всю ячейку TD вместе с компонентом\r\n\t\t\t\t\t\tvar hideTd = (\r\n\t\t\t\t\t\t\t\t\t\t(showComp.hasClass('treeField')\r\n\t\t\t\t\t\t\t\t\t\t|| showComp.hasClass('popup')\r\n\t\t\t\t\t\t\t\t\t\t|| showComp.hasClass('or3-btn')\r\n\t\t\t\t\t\t\t\t\t\t|| e_tagName == 'TEXTAREA'\r\n\t\t\t\t\t\t\t\t\t\t|| e_type == 'radio'\r\n\t\t\t\t\t\t\t\t\t\t|| showComp.hasClass('orpanel')\r\n\t\t\t\t\t\t\t\t\t\t|| showComp.hasClass('ordatatable')\r\n\t\t\t\t\t\t\t\t\t\t|| (showComp.get(0) && showComp.get(0).tagName == 'FIELDSET')\r\n\t\t\t\t\t\t\t\t\t\t) \r\n\t\t\t\t\t\t\t\t\t&& (\r\n\t\t\t\t\t\t\t\t\t\t(showComp.parent().get(0) && showComp.parent().get(0).tagName == 'TD')\r\n\t\t\t\t\t\t\t\t\t\t|| (showComp.parent().parent().get(0) && showComp.parent().parent().get(0).tagName == 'TD')\r\n\t\t\t\t\t\t\t\t\t\t|| (showComp.hasClass('ordatatable') && showComp.parent().parent().parent().parent().get(0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& showComp.parent().parent().parent().parent().get(0).tagName == 'TD')\r\n\t\t\t\t\t\t\t\t\t\t|| (showComp.hasClass('ordatatable') && showComp.parent().parent().parent().parent().parent().get(0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& showComp.parent().parent().parent().parent().parent().get(0).tagName == 'TD')\t\r\n\t\t\t\t\t\t\t\t\t   )\r\n\t\t\t\t\t\t\t\t\t) \r\n\t\t\t\t\t\t\t\t|| (showComp.parent().hasClass('orpanel') && !showComp.parent().parent().hasClass('or3-popup-panel')) \r\n\t\t\t\t\t\t\t\t|| (showComp.parent().hasClass('tabs-panels') && !showComp.parent().parent().hasClass('or3-popup-panel'));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar hideDate = showComp.hasClass('easyui-datebox') || showComp.hasClass('easyui-datetimebox') || showComp.hasClass('easyui-combobox');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aval == '1' || aval == 1) {\r\n\t\t\t\t\t\t\tif (hideDate) {showComp.next().show();}\r\n\t\t\t\t\t\t\telse {showComp.show();}\r\n\t\t\t\t\t\t\tif (hideTd) showComp.parents('td:first').show();\r\n\t\t\t\t\t\t\tif (hideDate) showComp.parents('td:first').show();\r\n\t\t\t\t\t\t\t_this.displayEmptyParentPanels(showComp);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcomp.find('.easyui-datagrid').datagrid('resize');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (comp.hasClass('easyui-tabs'))\r\n\t\t\t\t\t\t\t\tcomp.tabs('resize');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (comp.hasClass('orpanel'))\r\n\t\t\t\t\t\t\t\tdelete _this.hiddenPanels[i];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tshowComp.hide();\r\n\t\t\t\t\t\t\tif (showComp[0]) showComp[0].style.setProperty('display', 'none', 'important');\r\n\t\t\t\t\t\t\tif (hideTd) showComp.parents('td:first').hide();\r\n\t\t\t\t\t\t\tif (hideDate) showComp.parents('td:first').hide();\r\n\t\t\t\t\t\t\t_this.hideEmptyParentPanels(showComp);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (comp.hasClass('orpanel'))\r\n\t\t\t\t\t\t\t\t_this.hiddenPanels[i] = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == \"rv\") {\r\n\t\t\t\t\t// видимость отчетов\r\n\t\t\t\t\t$.each(aval, function(rid, rv) {\r\n\t\t\t\t\t\tvar rep = $(\"[reportid='\" + rid + \"']\");\r\n\t\t\t\t\t\tconsole.log(\"Report visibility: \" + rid + \", \" + rv);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (rep.length > 0) {\r\n\t\t\t\t\t\t\tif (rep.attr('id')) {\r\n\t\t\t\t\t\t\t\tif (rv === 1)\r\n\t\t\t\t\t\t\t\t\trep.show();\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\trep.hide();\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (rv === 1)\r\n\t\t\t\t\t\t\t\t\trep.parent().parent().show();\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\trep.parent().parent().hide();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == \"border\") { // border temp fix\r\n\t\t\t\t\t\r\n\t\t\t\t} else if (akey == 'updateRow') {\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\t_this.updateTreeTableRow(i, row.index, row.row);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'updateTblRow') {\r\n\t\t\t\t\tvar t = comp;\r\n\t\t\t    \tvar edPars = _this.getEditing();\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tvar count = t.datagrid('getRows').length;    // row count\r\n\t\t\t\t\t\t    var selected = t.datagrid('getSelected');\r\n\t\t\t\t\t\t    var selRow = 0;\r\n\t\t\t\t\t\t    if (selected) {\r\n\t\t\t\t\t\t    \tselRow = t.datagrid('getRowIndex', selected);\r\n\t\t\t\t\t\t    }\r\n\t\t\t\t\t\t    \r\n\t\t\t\t\t\t\tvar index = _this.pageIndex(t, row.index);\r\n\t\t\t\t\t\t    if (0 <= index && index < count) {\r\n\t\t\t\t\t\t\t\tt.datagrid('updateRow',{\r\n\t\t\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\t\t\trow: row.row\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tvar tr = t.datagrid('getRow', index); \r\n\t\t\t\t\t\t\t\tif (tr.hasClass(\"datagrid-row-editing\"))\r\n\t\t\t\t\t\t\t\t\ttr.removeClass(\"datagrid-row-editing\");\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t    if (selRow >= 0 && selRow < count) {\r\n\t\t\t\t\t\t        t.datagrid('selectRow', selRow);\r\n\t\t\t\t\t\t    }\r\n\t\t\t\t\t\t    if (_this.focusedTable != undefined) {\r\n\t\t\t\t\t\t    \tvar fTbl = $(\"#\" + _this.focusedTable);\r\n\t\t\t\t\t\t    \tif (fTbl != null && fTbl.length > 0) {\r\n\t\t\t\t\t\t    \t\tvar panel = fTbl.datagrid('getPanel').panel('panel');\r\n\t\t\t\t\t\t    \t\tpanel.attr('tabindex', 0);\r\n\t\t\t\t\t\t    \t\tpanel.focus();\r\n\t\t\t\t\t\t    \t}\r\n\t\t\t\t\t\t    }\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\tUtil.logErrorInfo(\"Error parsing 'updateTblRow' property\", err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar selRows = t.attr('selRows');\r\n\t\t\t\t\tvar selCol = t.attr('selectedCol');\r\n\t\t\t\t\tif (selRows && selCol) {\r\n\t\t\t\t\t\tvar rows = selRows.split(',');\r\n\t\t\t\t\t\tfor (var ind=0; ind<rows.length; ind++) {\r\n\t\t\t\t\t\t\trows[ind] = _this.pageIndex(t, rows[ind]);\r\n\t\t\t\t\t\t\tt.datagrid('selectCell', {index:rows[ind],field:selCol});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (edPars != null) {\r\n\t\t\t\t\t\t_this.restoreEditing(edPars);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tTooltipOps.addDatagridTooltip(t);\r\n\t\t\t\t} else if (akey == 'reloadRow') {\r\n\t\t\t\t\treloadRows = aval;\r\n\t\t\t\t} else if (akey == 'setNodeTitle') {\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\tif (comp.hasClass('easyui-tree')) {\r\n\t\t\t\t\t\t\tvar node = comp.tree('find', row.index);\r\n\t\t\t\t\t\t\tif (node != null) {\r\n\t\t\t\t\t\t\t\tcomp.tree('update', {\r\n\t\t\t\t\t\t\t\t\ttarget: node.target,\r\n\t\t\t\t\t\t\t\t\ttext: row.title\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'reloadNode') {\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\tif (comp.hasClass('easyui-tree')) {\r\n\t\t\t\t\t\t\tvar node = comp.tree('find', row.index);\r\n\t\t\t\t\t\t\tif (node != null) {\r\n\t\t\t\t\t\t\t\tif (comp.tree('isLeaf', node.target)) {\r\n\t\t\t\t\t\t\t\t\tvar parent = comp.tree('getParent', node.target);\r\n\t\t\t\t\t\t\t\t\tcomp.tree('reload', parent.target);\r\n\t\t\t\t\t\t\t\t} else \r\n\t\t\t\t\t\t\t\t\tcomp.tree('reload', node.target);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'selectNode') {\r\n\t\t\t\t\tif (aval != 0) {\r\n\t\t\t\t\t\t_this.nodeParent = false;\r\n\t\t\t\t\t\t_this.treeCallLater('select', comp, aval, 20);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t    var nodes = comp.tree('getChecked');\r\n\t\t\t\t\t    _this.isOnCheck = false;\r\n\t\t\t\t\t    for (var k = 0; k<nodes.length; k++) {\r\n\t\t\t\t\t    \t$(this).tree('uncheck', nodes[k].target);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t    _this.isOnCheck = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'checkboxTree') {\r\n\t\t\t\t\tif (comp.hasClass('easyui-tree')) {\r\n\t\t\t\t\t\tif (aval == 0) {\r\n\t\t\t\t\t\t\tcomp.tree({\r\n\t\t\t\t\t\t\t\tcheckbox: function(node){\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcomp.tree({\r\n\t\t\t\t\t\t\t\tcheckbox: function(node){\r\n\t\t\t\t\t\t\t\t\tif (node.id == aval) {\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'deleteRow') {\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\tcomp.treegrid('remove', row.index);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'cv') {\r\n\t\t\t\t\t$.each(aval, function(ri, row) {\r\n\t\t\t\t\t\tif (row.v == 1 || row.v == '1')\r\n\t\t\t\t\t\t\tcomp.treegrid('showColumn', row.uuid);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tcomp.treegrid('hideColumn', row.uuid);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'reload') {\r\n\t\t\t\t\tcomp.attr('reload', '1');\r\n\t\t\t\t\tif (comp.hasClass('or3-icon-table')) {\r\n\t\t\t\t\t\tcomp.panel('refresh');\r\n\t\t\t\t\t} else if (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\tcreateImagePanel(comp);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcomp.datagrid('reload');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'imageAdded') {\r\n\t\t\t\t\tif (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\timageAdded(comp, aval);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'imageDeleted') {\r\n\t\t\t\t\tif (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\timageDeleted(comp, aval);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'reloadUpload') {\r\n\t\t\t\t\tvar pan = $('#uploaded' + i);\r\n\t\t\t\t\tif (pan.length > 0)\r\n\t\t\t\t\t\tpan.panel('refresh');\r\n\t\t\t\t} else if (akey == 'selectedRows') {\r\n\t\t\t\t\tif (comp.hasClass('easyui-datagrid')) {\r\n\t\t\t\t\t\t_this.selectTableRows(comp, aval);\r\n\t\t\t\t\t} else if (comp.hasClass('easyui-treegrid')){\r\n\t\t\t\t\t\tcomp.attr('selRows', aval);\r\n\t\t\t\t\t\t_this.treeTableSetSelected(comp);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'selectedImg') {\r\n\t\t\t\t\tif (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\tselectImagePanel(comp, aval);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'imgTitleChanged') {\r\n\t\t\t\t\tif (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\tchangeImageTitle(comp, aval.index, aval.title);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'imgFileChanged') {\r\n\t\t\t\t\tif (comp.hasClass('or3-img-panel') || comp.hasClass('or3-img-panel-vertical')) {\r\n\t\t\t\t\t\tchangeImageFile(comp, aval.index, aval.file);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'reloadTreeTable') {\r\n\t\t\t\t\tcomp.treegrid('reload');\r\n\t\t\t\t}  else if (akey == 'bg') {\r\n\t\t\t\t\t//comp.css({backgroundColor: aval});\r\n\t\t\t\t} else if (akey == 'fg') {\r\n\t\t\t\t\tcomp.css({color: aval});\r\n\t\t\t\t} else if (akey == 'dialogs') {\r\n\t\t\t\t\tif (comp.hasClass('easyui-datagrid')) {\r\n\t\t\t\t\t\t$.each(aval, function(ok, ov) {\r\n\t\t\t\t\t\t\tif (ov.header){\r\n\t\t\t\t\t\t\t\tvar td = comp.datagrid('getPanel').find('div.datagrid-header td[field=\"'+ov.header.uid+'\"]');\r\n\t\t\t\t\t\t\t\tvar hTitle = ov.header.title;\r\n\t\t\t\t\t\t\t\tif (hTitle)\r\n\t\t\t\t\t\t\t\t\thTitle = hTitle.replace(/@/g,'<br/>');\r\n\t\t\t\t\t\t\t\ttd.children().first().children().first().html(hTitle);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'zebra') {\r\n\t\t\t\t\tif (comp.hasClass('easyui-datagrid')) {\r\n\t\t\t\t\t\t$.each(aval, function(ok, ov){\r\n\t\t\t\t\t\t\tcomp.datagrid({\r\n\t\t\t\t\t\t\t\trowStyler: function(index,row) {\r\n\t\t\t\t\t\t\t\t\tif (index % 2 == 0){\r\n\t\t\t\t\t\t\t\t\t\treturn 'background-color:'+ov.zebra1+';';\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\treturn 'background-color:'+ov.zebra2+';';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (akey == 'bitSeparation') {\r\n\t\t\t\t\t$('#' + i).numberbox({\r\n\t\t\t\t\t    formatter:function(value) {\r\n\t\t\t\t\t    \tif (value != null && value.length > 0) {\r\n\t\t\t\t\t\t    \tvar index = value.indexOf('.');\r\n\t\t\t\t\t\t    \tvar c = 0;\r\n\t\t\t\t\t\t    \tif (index != -1) {\r\n\t\t\t\t\t\t    \t\tvar sub = value.substring(index + 1);\r\n\t\t\t\t\t\t    \t\tvar c = sub.length;\r\n\t\t\t\t\t\t    \t} \r\n\t\t\t\t\t\t    \tvar n = parseFloat(value);\r\n\t\t\t\t\t\t    \t\r\n\t\t\t\t\t\t    \tif (!isNaN(n))\r\n\t\t\t\t\t\t    \t\treturn n.toLocaleString('ru', { minimumFractionDigits: c });\r\n\t\t\t\t\t    \t}\r\n\t\t\t\t\t    \treturn \"\";\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (akey == 'expanded') {\r\n\t\t\t\t\t$('#cnt' + i).addClass('expanded');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcomp.attr(akey, aval);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (reloadRows != undefined) {\r\n\t\t\t\t$.each(reloadRows, function(ri, row) {\r\n\t\t\t\t\tvar node = comp.treegrid('find', row.index);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (node != null) {\r\n\t\t\t\t\t\tif (node.children != null && node.children.length > 0) {\r\n\t\t\t\t\t\t\tcomp.treegrid('reload', row.index);\r\n\t\t\t\t\t\t} else if (node.parent > 0) {\r\n\t\t\t\t\t\t\tcomp.treegrid('update',{\r\n\t\t\t\t\t\t\t\tid: row.index,\r\n\t\t\t\t\t\t\t\trow: {\r\n\t\t\t\t\t\t\t\t\tchildren: [{\r\n\t\t\t\t\t\t\t\t\t\tparent: row.index,\r\n\t\t\t\t\t\t\t\t\t    id: -1000,\r\n\t\t\t\t\t\t                name: \"untitled\",\r\n\t\t\t\t\t\t            }]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tcomp.treegrid('reload', row.index);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcomp.treegrid('reload');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (comboValue != undefined) {\r\n\t\t\t\tif (comboValue > -1 ) {\r\n                    $('#' + i + ' option:eq(' + comboValue + ')').prop('selected', true);\r\n\t\t\t    } else {\r\n                    $('#' + i + ' option:eq(0)').prop('selected', true);\r\n\t\t\t    }\r\n\t\t\t}\r\n\t\t} else if (key == 'alert') {\r\n\t\t\talert(value);\r\n\t\t} else if (key == 'autoRefresh') {\r\n\t\t\tif (comp.hasClass('easyui-datagrid')) {\r\n\t\t\t\tifcRefreshers[ifcRefreshers.length] = setInterval(function() {\r\n\t\t\t\t\tcomp.datagrid('reload');\r\n\t\t\t\t}, value);\r\n\t\t\t} else {\r\n\t\t\t\tifcRefreshers[ifcRefreshers.length] = setInterval(function() {\r\n\t\t\t\t\t_this.setValue(i, 1);\r\n\t\t\t\t}, value);\r\n\t\t\t}\r\n\t\t} else if (key == 'styleRow') {\r\n\t\t\tvar styleByRow = InterfaceController.styles[i];\r\n\t\t\tif (styleByRow == null) {\r\n\t\t\t\tstyleByRow = {};\r\n\t\t\t\tInterfaceController.styles[i] = styleByRow;\r\n\t\t\t}\r\n\t\t\tvar view = $('[field=' + i + ']').first().parents('.datagrid-view');\r\n\t\t\tvar table = view.find('.easyui-datagrid');\r\n\t\t\tif (table.length == 0)\r\n\t\t\t\ttable = view.find('.easyui-treegrid');\r\n\t\t\t\r\n\t\t\tif (table.length > 0) {\r\n\t\t\t\tvar delta = _this.pageIndex(table, 0);\r\n\t\t\t\tvar tds = view.find('[datagrid-row-index] [field=' + i + ']');\r\n\r\n\t\t\t\t$.each(value, function(k, row) {\r\n\t\t\t\t\tvar pIndex = row.index + delta;\r\n\t\t\t\t\tvar styleName = \"st\" + row.hsh;\r\n\t\t\t\t\tstyleByRow[pIndex] = {'class': styleName};\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar style = InterfaceController.cssStyles[styleName];\r\n\t\t\t\t\tif (style == null) {\r\n\t\t\t\t\t\tstyle = '';\r\n\t\t\t\t\t\tvar divStyle = '';\r\n\t\t\t\t\t\tif(row.ff){\r\n\t\t\t\t\t\t\tdivStyle += \"font-family:\" + row.ff + \";\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(row.fs){\r\n\t\t\t\t\t\t\tdivStyle += \"font-size:\" + row.fs + \"px;\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(row.fw){\r\n\t\t\t\t\t\t\tdivStyle += \"font-weight:\" + row.fw + \";\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(row.fst){\r\n\t\t\t\t\t\t\tdivStyle += \"font-style:\" + row.fst + \";\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(row.frg){\r\n\t\t\t\t\t\t\tdivStyle += \"color:\" + row.frg + \";\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(row.bcg){\r\n\t\t\t\t\t\t\tstyle += \"background-color:\" + row.bcg + \";\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tInterfaceController.cssStyles[styleName] = style;\r\n\t\t\t\t\t\tif (style.length > 0)\r\n\t\t\t\t\t\t\t$('style').first().append('\\n.' + styleName +' {' + style + '}');\r\n\t\t\t\t\t\tif (divStyle.length > 0)\r\n\t\t\t\t\t\t\t$('style').first().append('\\n.' + styleName +' div {' + divStyle + '}');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tvar td = $(tds.get(pIndex));\r\n\t\t\t\t\t\ttd.removeClass();\r\n\t\t\t\t\t\ttd.addClass(styleName);\r\n\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else if (key == 'options') {\r\n\t\t\tif ( comp.attr('type')=='radio' && value.length!=0){\r\n\t\t\t\t// очистить таблицу\r\n\t\t\t\tcomp.empty();\r\n\t\t\t\tvar colCount = comp.attr(\"count\");\r\n\t\t\t\tif (colCount > 0) {\r\n\t\t\t\t\tvar rowCount = Math.ceil(value.length/colCount);\r\n\t\t\t\t\t// создать необходимое количество ячеек\r\n\t\t\t\t\tvar items = {};\r\n\t\t\t\t\tvar ij=0;\r\n\t\t\t\t\t// value массив кнопок\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar d,checked,color,font,fontSize,fontStyle;\r\n\t\t\t\t\t$.each(value, function(akey, aval) {\r\n\t\t\t\t\t\td = aval.pr.v == '1' ? \"display:inline;\" : \"display:none;\";\r\n\t\t\t\t\t\tchecked = aval.pr.checked == true ? \"checked='checked'\" : \"\";\r\n\t\t\t\t\t\tcolor = aval.st.color == null ? \"\" : \"color:\"+aval.st.color+\";\";\r\n\t\t\t\t\t\tfont = aval.st.font == \"Dialog\" ? \"font-family:Arial;\" : \"font-family:\"+aval.st.font+\";\";\r\n\t\t\t\t\t\tfontSize = aval.st.fontSize > 0 ? \"font-size:\"+aval.st.fontSize+\"px;\" : \"\";\r\n\t\t\t\t\t\tif (aval.st.fontStyle == 1)\r\n\t\t\t\t\t\t\tfontStyle = \"font-weight:bold;\";\r\n\t\t\t\t\t\telse if (aval.st.fontStyle == 2)\r\n\t\t\t\t\t\t\tfontStyle = \"font-style:italic;\";\r\n\t\t\t\t\t\telse if (aval.st.fontStyle == 3)\r\n\t\t\t\t\t\t\tfontStyle = \"font-style:italic; font-weight:bold;\";\r\n\t\t\t\t\t\telse fontStyle = \"\";\r\n\t\t\t\t\t\titems[ij] = \"<label><input type='radio' value='\" + aval.pr.value + \"' name='\"+aval.pr.name+\"' id='\"+i+\"' \"+checked+\" style='\"+d+\"'/> \"\r\n\t\t\t\t\t\t+\"<span style='\"+d+color+font+fontSize+fontStyle+\"'>\"+aval.pr.text+\"</span></label>\";\r\n\t\t\t\t\t\tij++;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar j=0;\r\n\t\t\t\t\tvar str= '';\r\n\t\t\t\t\tfor (var r = 0; r < rowCount; r++) {\r\n\t\t\t\t\t\tstr+=\"<tr>\";\r\n\t\t\t\t\t\tfor (var c = 0; c < colCount; c++) {\r\n\t\t\t\t\t\t\tif(j<ij){\r\n\t\t\t\t\t\t\t\tstr+=\"<td>\"+items[j]+\"</td>\";\r\n\t\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstr+=\"</tr>\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcomp.html(str);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tenableNaviBtn(btn, enable) {\r\n\t\tif (enable && btn.hasClass('l-btn-disabled')) {\r\n\t\t\tif (btn.attr('onclick') != null)\r\n\t\t\t\tbtn.removeClass('l-btn-disabled').removeClass('l-btn-plain-disabled');\r\n\t\t\telse\r\n\t\t\t\tbtn.linkbutton('enable');\r\n\t\t} else if (!enable && !btn.hasClass('l-btn-disabled')) {\r\n\t\t\tif (btn.attr('onclick') != null)\r\n\t\t\t\tbtn.addClass('l-btn-disabled').addClass('l-btn-plain-disabled');\r\n\t\t\telse\r\n\t\t\t\tbtn.linkbutton('disable');\r\n\t\t}\r\n\t}\r\n\r\n\tfocusNext(elem) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tvar curElem = elem;\r\n\t\tvar nextElem = elem.next('input:visible:enabled, select:visible:enabled, textarea:visible:enabled, button:visible:enabled, .easyui-datagrid');\r\n\t\twhile (nextElem.length < 1 && !curElem.is('body')) {\r\n\t\t\tnextElem = curElem.nextAll().find('input, select, textarea, button').filter(':visible:enabled:first');\r\n\t\t\tcurElem = curElem.parent();\r\n\t\t}\r\n\t\tif (nextElem.length < 1) {\r\n\t\t\tvar elems = $('body').find('input:visible:enabled, select:visible:enabled, textarea:visible:enabled, button:visible:enabled, .easyui-datagrid');\r\n\t\t\tif (elems.length > 0)\r\n\t\t\t\tnextElem = $(elems[0]);\r\n\t\t}\r\n\t\t_this.focusedTable = undefined;\r\n\t\tif (nextElem != elem) {\r\n\t\t\tif (nextElem.hasClass('easyui-datagrid')) {\r\n\t\t\t\tvar panel = nextElem.datagrid('getPanel').panel('panel');\r\n\t\t\t\tpanel.attr('tabindex', 0);\r\n\t\t\t\tpanel.focus();\r\n\t\r\n\t\t\t\t_this.focusedTable = nextElem.attr('id');\r\n\t\t\t\tpanel.unbind('keydown').bind('keydown',function(event) {\r\n\t\t\t\t\tif (event.which && event.which == 38) {\r\n\t\t\t\t        return selectRow(nextElem, true);\r\n\t\t\t\t\t} else if (event.which && event.which == 40) {\r\n\t\t\t\t        return selectRow(nextElem, false);\r\n\t\t\t\t\t} else if (event.which && event.which == 37) {\r\n\t\t\t\t        return selectColumn(nextElem, true);\r\n\t\t\t\t\t} else if (event.which && event.which == 39) {\r\n\t\t\t\t        return selectColumn(nextElem, false);\r\n\t\t\t\t\t} else if (event.which && event.which == 32) {\r\n\t\t\t\t        return beginEditCell(nextElem);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t\tnextElem.focus();\r\n\t\t} else\r\n\t\t\telem.blur();\r\n\t}\r\n\r\n\tsetElemForTopPane() {\r\n\t\tlet _this = this;\r\n\r\n\t\tlet elements = $(\"[onTop]\");\r\n\t\t// отсортировать новые данные\r\n\t\telements.sort(function (a, b){\r\n\t\t\tvar i = $(a).attr('onTop');\r\n\t\t\tvar j = $(b).attr('onTop'); \r\n\t\t\treturn i < j ? -1 : i > j ? 1 : 0;\r\n\t\t});\r\n\t\t\r\n\t\t$.each(elements, function(i, element) {\r\n\t\t\t_this.hideEmptyParentPanels($(element));\r\n\t\t});\r\n\t\t\r\n\t\t$(\".ui-toolbar\").append(elements);\r\n\t}\r\n\t\r\n\tmovePopUpContent(dialogId) {\r\n\t\tlet panel = dialogId !== undefined ? $('#' + dialogId) : $('#ui-body');\r\n\t\tlet elements = dialogId !== undefined ? $('#' + dialogId +' .popUpPanContent') : $('.popUpPanContent');\r\n\t\tpanel.append(elements);\r\n\t}\r\n\t\r\n\topenPopup(uid, row, colUid) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tUtil.blockPage();\r\n\t\tvar par = {\"uid\": uid, \"cmd\": \"openPopup\"};\r\n\t\tif (row != undefined) par[\"row\"] = row;\r\n\t\tif (colUid != undefined) par[\"cuid\"] = colUid;\r\n\t\t\r\n\t\t_this.app.query(par).then(response => {\r\n\t\t\tresponse.json().then(json => {\r\n\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t_this.data = data;\r\n\t\t\t\t\tif (data.result == 'nop') {\r\n\t\t\t\t\t\t// no operation\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else if (data.result == 'error') {\r\n\t\t\t\t\t\tUtil.alert(data.message, Util.ERROR);\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\t\t_this.selectedRow = [];\r\n\t\t\t\t\t\tvar did = _this.popupcount;\r\n\t\t\t\t\t\tvar dialogId = 'or3_popup' + did;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t$('#' + dialogId).on('click', function (e) {\r\n\t\t\t\t\t\t\t// источник события\r\n\t\t\t\t\t\t\tvar target = e && e.target || event.srcElement;\r\n\t\t\t\t\t\t\treturn _this.hidePopUp(target, '#' + dialogId);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar w = data.w > $(window).width() + 50 ? $(window).width() + 50 : data.w;\r\n\t\t\t\t\t\tvar h = data.h > ($(window).height() - 20) ? ($(window).height() - 20) : data.h;\r\n\t\t\t\r\n\t\t\t\t\t\tvar buttons = (data.tv==0) ? [{\r\n\t\t\t\t\t\t\tid: \"okPopupBtn\",\r\n\t\t\t\t\t\t\ttext: Translation.translation['ok'],\r\n\t\t\t\t\t\t\thandler: function() {\r\n\t\t\t\t\t\t\t\t_this.setDialogBtnsEnabled(dialogId, false);\r\n\t\t\t\t\t\t\t\t_this.sendUserDecision(\"0\").then(data => {\r\n\t\t\t\t\t\t\t\t\t_this.closePopup(dialogId);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: \"cancelPopupBtn\",\r\n\t\t\t\t\t\t\ttext: Translation.translation['cancel'],\r\n\t\t\t\t\t\t\thandler: function() {\r\n\t\t\t\t\t\t\t\t_this.setDialogBtnsEnabled(dialogId, false);\r\n\t\t\t\t\t\t\t\t_this.sendUserDecision(\"1\").then(data => {\r\n\t\t\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}] : [];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar toolbar = [{\r\n\t\t\t\t\t\t\tid: 'reportBtn' + did,\r\n\t\t\t\t\t\t\ttext: Translation.translation['print'],\r\n\t\t\t\t\t\t\ticonCls: 'icon-rept'\r\n\t\t\t\t\t\t}];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar dialogOptions = {\r\n\t\t\t\t\t\t\ttitle: data.t,\r\n\t\t\t\t\t\t\twidth: w,\r\n\t\t\t\t\t\t\theight: h,\r\n\t\t\t\t\t\t\tclosed: false,\r\n\t\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t\t\thref: _this.app.restUrl + '&cmd=loadPopup',\r\n\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\tuid: uid,\r\n\t\t\t\t\t\t\trow: row,\r\n\t\t\t\t\t\t\tcuid: colUid,\r\n\t\t\t\t\t\t\tonOpen: function() {\r\n\t\t\t\t\t\t\t\t$('#' + dialogId +' .panel').append($(\"<div class=\\\"glassDialog\\\"></div>\"));\r\n\t\t\t\t\t\t\t\t$('#' + dialogId + ' .glassDialog').height($('#' + dialogId +' .panel').height()).width($('#' + dialogId +' .panel').width());\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonLoad: function() {\r\n\t\t\t\t\t\t\t\t// Добавляем ID-окна в массив окон\r\n\t\t\t\t\t\t\t\tInterfaceController.openedDialogs.push(dialogId);\r\n\t\t\t\t\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\t\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_POPUP_IFC);\r\n\t\t\t\t\t\t\t\t_this.loadWindowTitle($('#' + dialogId));\r\n\t\t\t\t\t\t\t\t_this.loadDialogReports(did);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('.easyui-datebox, .easyui-datetimebox').each(function(i) {\r\n\t\t\t\t\t\t\t\t\tvar db = $(this);\r\n\t\t\t\t\t\t\t\t\tvar hidePanel = db.attr('hidePanel') == 'true';\r\n\t\t\t\t\t\t\t\t\tif (hidePanel) {\r\n\t\t\t\t\t\t\t\t\t\tlet opts = $(this).datebox(\"panel\").panel(\"options\");\r\n\t\t\t\t\t\t\t\t\t\topts.nopanel = true;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar fld = $(this).parent().find('.textbox-text');\r\n\t\t\t\t\t\t\t\t\t\tvar cal = $(this).parent().find('.textbox-addon');\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (cal.css('display') != \"none\") {\r\n\t\t\t\t\t\t\t\t\t\t\tcal.hide();\r\n\t\t\t\t\t\t\t\t\t\t\tfld.width(fld.width() + 18);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('.easyui-treegrid.datagrid-f').each(function(i) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('workworkwork2');\r\n\t\t\t\t\t\t\t\t\tlet treegridComp = $(this);\r\n\t\t\t\t\t\t\t\t\tlet id = treegridComp.attr('id');\r\n\t\t\t\t\t\t\t\t\tlet multi = _this.multiSelection[id];\r\n\t\t\t\t\t\t\t\t\tif (_this.multiSelection[id] !== undefined) {\r\n\t\t\t\t\t\t\t\t\t\ttreegridComp.treegrid({\r\n\t\t\t\t\t\t\t\t\t\t\tcheckbox: multi,\r\n\t\t\t\t\t\t\t\t\t\t\tonlyLeafCheck: true,\r\n\t\t\t\t\t\t\t\t\t\t\tsingleSelect: !multi\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t_this.multiSelection[id] = undefined;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\r\n\t\t\t\t\t\t\t\t_this.loadData({}, true);\r\n\t\t\t\t\t\t\t\t_this.loadData({}, true).then(() => {\r\n\t\t\t\t\t\t\t\t\t$('#' + dialogId).panel('resize');\r\n\t\t\t\t\t\t\t\t\t_this.app.resize('#' + dialogId);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t_this.preparefileUpload();\r\n\t\t\t\t\t\t\t\t_this.clickPopUpContent(dialogId);\r\n\t\t\t\t\t\t\t\t_this.showPopUpContent();\r\n\t\t\t\t\t\t\t\t_this.movePopUpContent(dialogId);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonClose: function() {\r\n\t\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\t\t\t\t\t// Удаляем ID-окна из массива окон\r\n\t\t\t\t\t\t\t\tInterfaceController.openedDialogs.pop();\r\n\t\t\t\t\t\t\t\tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t\t\t\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t\t\t\t\t        \tInterfaceController.popDlgType.pop();\r\n\t\t\t\t\t        \t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (_this.dialogResult[dialogId] == '1') {\r\n\t\t\t\t\t\t\t\t\tlet opts = $('#' + dialogId).dialog('options');\r\n\t\t\t\t\t\t\t\t\tlet par = {\"cmd\":\"closePopup\", \"uid\":opts.uid, \"val\":'1'};\r\n\t\t\t\t\t\t        \tif (opts.row != undefined) par[\"row\"] = opts.row;\r\n\t\t\t\t\t\t        \tif (opts.cuid != undefined) par[\"cuid\"] = opts.cuid;\r\n\t\t\t    \t\t        \t_this.loadData(par, true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tbuttons: buttons,\r\n\t\t\t\t\t\t\tresizable: true\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tdialogOptions.toolbar = toolbar;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('#' + dialogId).dialog(dialogOptions);\r\n\t\t\t\r\n\t\t\t\t\t\t_this.popupcount++;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\thidePopUp(target, panelId) {\r\n\t\tlet _this = this;\r\n\t\t// источник события\r\n\t\ttarget = $(target).closest('[id]');\r\n\t\t\r\n\t\tvar isPopupOrButton = target != null && (target.hasClass('popup') || target.hasClass('trBtn'));\r\n\t\tvar isOnPopupPanel = $(target).closest('.popUpPanContent').length > 0;\r\n\t\t\r\n\t\tif (!isOnPopupPanel || isPopupOrButton) {\r\n\t\t\tvar panID = target != null ? (\"pop\" + $(target).attr('id')) : \"\";\r\n\t\t\tvar panels = $(panelId).find(\".popUpPanContent\");\r\n\t\t\tfor (var j = 0; j < panels.length; j++) {\r\n\t\t\t\tif($(panels[j]).attr('id') != panID && $(panels[j]).is(\":visible\")){\r\n\t\t\t\t\t// отправить на сервер событие закрытия панели Before\r\n\t\t\t\t\tvar par = {};\r\n\t\t\t\t\tpar[\"uid\"] = $(panels[j]).attr('id').substring(3); // первые три символа это префикс \"pop\"\r\n\t\t\t\t\tpar[\"cmd\"] = \"hidePopUp\";\r\n\t\t\t\t\tpar[\"t\"] = \"b\";\r\n\t\t\t\t\t\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(panels[j]).fadeOut();\r\n\t\t\t\t\t// отправить на сервер событие закрытия панели After\r\n\t\t\t\t\tpar[\"t\"] = \"a\";\r\n\t\t\t\t\t\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t    return true;\r\n\t}\r\n\t\r\n\tsetDialogBtnsEnabled(did, enable) {\r\n\t\tif (enable)\r\n\t\t\t$(\"#\" + did).parent().find(\".dialog-button .l-btn\").linkbutton('enable');\r\n\t\telse\r\n\t\t\t$(\"#\" + did).parent().find(\".dialog-button .l-btn\").linkbutton('disable');\r\n\t}\r\n\t\r\n\tsendUserDecision(decision) {\r\n\t\tvar par = {\"cmd\":'userDecision', \"value\":decision, \"json\":1};\r\n\t\treturn this.postAndParseData(par);\r\n\t}\r\n\t\r\n\tdestroyPopup(count) {\r\n\t\tlet _this = this;\r\n\t\tvar popups = $(\"div[id^='or3_popup']\");\r\n\t\tfor (var i=1; i<=count; i++) {\r\n\t\t\tvar popup = $(popups.get(popups.size() - i));\r\n\t\t\t_this.dialogResult[popup.attr('id')] = '-1';\r\n\t\t\tpopup.dialog('destroy');\r\n\t\t}\r\n\t}\r\n\t\r\n\tclosePopup(did) {\r\n\t\tlet _this = this;\r\n\t    _this.showChangeMsg();\r\n\t\r\n\t\t_this.dialogResult[did] = '0';\r\n\t\tvar opts = $('#' + did).dialog('options');\r\n\t    \r\n\t    var par = {};\r\n\t\tpar[\"uid\"] = opts.uid ;\r\n\t\tpar[\"val\"] = 'CHECK';\r\n\t\tif (opts.row != undefined) par[\"row\"] = opts.row;\r\n\t\tif (opts.cuid != undefined) par[\"cuid\"] = opts.cuid;\r\n\t\tpar[\"cmd\"] = \"closePopup\";\r\n\t\r\n\t\t_this.loadData(par, true).then(data => {\r\n\t\t\tif (!data.result || data.result == 'success') {\r\n\t\t\t\t$(\"#\" + did).dialog('destroy');\r\n\t\t\t} else {\r\n\t\t\t\t_this.showPopupErrors(data.errors, data.path, data.name, opts, $('#' + did), data.fatal, data.isDataIntegrityControl);\r\n\t\t\t\t_this.setDialogBtnsEnabled(did, true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tloadReports() {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"getReports\":\"1\"};\r\n\t\t\r\n\t\t_this.app.post(par).then(data => {\r\n\t\t\tif (data.children && data.children.length > 0) {\r\n\t\t\t\t$('#reports').remove();\r\n\t\t\t\t$('#reportBtn').removeAttr(\"reportid\").unbind('click');\r\n\t\t\t\t$('#reportBtn').removeClass(\"m-btn\").removeClass(\"m-btn-small\").removeClass(\"l-btn\").removeClass(\"l-btn-small\");\r\n\t\t\t\tvar text = $('#reportBtn').find('.l-btn-text').text();\r\n\t\t\t\tif (text != null && text.length > 0) {\r\n\t\t\t\t\t$('#reportBtn').empty();\r\n\t\t\t\t\t$('#reportBtn').text(text);\r\n\t\t\t\t}\r\n\t\t\t\tif (data.children.length > 1 || data.children[0].children != null) {\r\n\t\t\t\t\tvar html = \"<div id='reports' class='subReports'>\";\r\n\t\t\t\t\t$.each(data.children, function(i, c) {\r\n\t\t\t\t\t\tvar cStyle = (c.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\r\n\t\t\t\t\t\tif (c.children && c.children.length > 0) {\r\n\t\t\t\t\t\t\thtml += \"<div\" + cStyle + \"><span reportid='\"+c.id+\"'>\" + c.name + \"</span><div>\";\r\n\t\t\t\t\t\t\t$.each(c.children, function(i1, c1) {\r\n\t\t\t\t\t\t\t\tvar c1Style = (c1.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\t\t\t\t\t\t\tif (c1.children && c1.children.length > 0) {\r\n\t\t\t\t\t\t\t\t\thtml += \"<div\" + c1Style + \"><span reportid='\"+c1.id+\"'>\" + c1.name + \"</span><div>\";\r\n\t\t\t\t\t\t\t\t\t$.each(c1.children, function(i2, c2) {\r\n\t\t\t\t\t\t\t\t\t\tvar c2Style = (c2.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\t\t\t\t\t\t\t\t\thtml += \"<div\" + c2Style + \"><a reportid='\"+c2.id+\"'>\"+c2.name+\"</a></div>\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\thtml += \"</div></div>\";\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\thtml += \"<div\" + c1Style + \"><a reportid='\"+c1.id+\"'>\"+c1.name+\"</a></div>\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\thtml += \"</div></div>\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml += \"<div\" + cStyle + \"><a reportid='\"+c.id+\"'>\"+c.name+\"</a></div>\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\thtml+=\"</div>\";\r\n\t\t\t\t\t$('#trash').append(html); \r\n\t\t\t\t\t$('#reportBtn').show();\r\n\t\t\t\t\t$('#reportBtn').menubutton({\r\n\t\t\t\t\t\t\tmenu: '#reports'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#reportBtn').attr(\"reportid\", data.children[0].id);\r\n\t\t\t\t\t$('#reportBtn').linkbutton();\r\n\t\t\t\t\t$('#reportBtn').bind('click', function() {});\r\n\t\t\t\t\tif (data.children[0].v == 0) {\r\n\t\t\t\t\t\t$('#reportBtn').hide();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#reportBtn').show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$('#reportBtn').hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tloadWindowTitle(dlg) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"getTitle\":\"1\"};\r\n\t\tthis.postAndParseData(par).then(data => {\r\n\t\t\tvar titlePan = dlg.parent().find('.window-header .panel-title');\r\n\t\t\t$(titlePan).text(data.title).css('font-size','14px');\r\n\t\t\t_this.loadStack(titlePan);\r\n\t\t});\r\n\t}\r\n\t\t\r\n\tloadDialogReports(did) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"getReports\":\"1\"};\r\n\t\tthis.postAndParseData(par).then(data => {\r\n\t\t\tif (data.children && data.children.length>0) {\r\n\t\t\t\t$('#reports' + did).remove();\r\n\t\r\n\t\t\t\tif (data.children.length > 1 || data.children[0].children != null) {\r\n\t\t\t\t\tvar html = \"<div id='reports\" + did + \"' class='subReports'>\";\r\n\t\t\t\t\t$.each(data.children, function(i, c) {\r\n\t\t\t\t\t\tvar cStyle = (c.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\r\n\t\t\t\t\t\tif (c.children && c.children.length > 0) {\r\n\t\t\t\t\t\t\thtml += \"<div\" + cStyle + \"><span reportid='\"+c.id+\"'>\" + c.name + \"</span><div>\";\r\n\t\t\t\t\t\t\t$.each(c.children, function(i1, c1) {\r\n\t\t\t\t\t\t\t\tvar c1Style = (c1.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\t\t\t\t\t\t\tif (c1.children && c1.children.length > 0) {\r\n\t\t\t\t\t\t\t\t\thtml += \"<div\" + c1Style + \"><span reportid='\"+c1.id+\"'>\" + c1.name + \"</span><div>\";\r\n\t\t\t\t\t\t\t\t\t$.each(c1.children, function(i2, c2) {\r\n\t\t\t\t\t\t\t\t\t\tvar c2Style = (c2.v == 0) ? \" style='display:none;'\" : \"\";\r\n\t\t\t\t\t\t\t\t\t\thtml += \"<div\" + c2Style + \"><a reportid='\"+c2.id+\"'>\"+c2.name+\"</a></div>\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\thtml += \"</div></div>\";\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\thtml += \"<div\" + c1Style + \"><a reportid='\"+c1.id+\"'>\"+c1.name+\"</a></div>\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\thtml += \"</div></div>\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml += \"<div\" + cStyle + \"><a reportid='\"+c.id+\"'>\"+c.name+\"</a></div>\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\thtml+=\"</div>\";\r\n\t\t\t\t\t$('#trash').append(html); \r\n\t\t\t\t\t$('#reportBtn' + did).menubutton({\r\n\t\t\t\t\t\t\tmenu: '#reports' + did\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar text = $('#reportBtn' + did).find('.l-btn-left').find('.l-btn-left');\r\n\t\t\t\t\tif (text != null && text.length > 0) {\r\n\t\t\t\t\t\t$('#reportBtn' + did).empty();\r\n\t\t\t\t\t\t$('#reportBtn' + did).append(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#reportBtn' + did).attr(\"reportid\", data.children[0].id);\r\n\t\t\t\t\t$('#reportBtn' + did).find('.l-btn-text').text(data.children[0].name);\r\n\t\t\t\t\tif (data.children[0].v == 0) {\r\n\t\t\t\t\t\t$('#reportBtn' + did).hide();\r\n\t\t\t\t\t\tvar shadow = $('#reportBtn' + did).parents('.panel').first().next();\r\n\t\t\t\t\t\tshadow.height(shadow.height() - 26);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$('#reportBtn' + did).hide();\r\n\t\t\t\tvar shadow = $('#reportBtn' + did).parents('.panel').first().next();\r\n\t\t\t\tshadow.height(shadow.height() - 26);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tloadStack(container) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"cmd\":\"getStack\"};\r\n\t\t\r\n\t\tthis.postAndParseData(par).then(data => {\r\n\t\t\t_this.showStack(data, container);\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowStack(stack, container) {\r\n\t\tif (container != null) {\r\n\t\t\tvar dBody = $(container).parent().parent().find('.window-body');\r\n\t\t\tdBody.height(dBody.height());\r\n\t\t}\r\n\t}\r\n\t\r\n\tpreparefileUpload(cont) {\r\n\t\tlet _this = this;\r\n\t\tif (cont == null) cont = $('body');\r\n\t\tvar uploads = cont.find('.or3-file-upload');\r\n\t\tfor (var i=0; i<uploads.length; i++) {\r\n\t\t\tvar upload = $(uploads.get(i));\r\n\t\t\tupload.fileupload({\r\n\t\t\t\tautoUpload: true,\r\n\t\t\t\tdropZone: upload.parent(),\r\n\t\t\t\tpasteZone: upload.parent(),\r\n\t\t\t\tsequentialUploads: true,\r\n\t\t\t    url: _this.app.restUrl + '&uid=' + upload.attr('id'),\r\n\t\t        dataType: 'json',\r\n\t\t        done: function (e, data) {\r\n\t\t        \tif (data.result.result == 'success') {\r\n\t\t\t        \t_this.endEditing();\r\n\t\t                _this.showChangeMsg();\r\n\t\t\t            _this.loadData({}, true);\r\n\t\t\t            \r\n\t\t        \t} else {\r\n\t\t        \t\tUtil.alert(data.result.message, Util.ERROR);\r\n\t\t        \t\t$('body').unblock();\r\n\t\t        \t}\t\r\n\t\t        },\r\n\t\t        add: function (e, data) {\r\n\t\t        \tUtil.blockPage();\r\n\t\t            data.submit();\r\n\t\t        },\r\n\t\t    });\r\n\t\t}\r\n\t}\r\n\t\r\n\tclickPopUpContent(parentId) {\r\n\t\tlet _this = this;\r\n\t\t$('.popUpPan:not(.asMenu)').click(function(e) {\r\n\t\t    var popID = $(this).attr('rel'); \r\n\t\t    var content = $(popID);\r\n\t\t\tvar ppopID = $(\"#\"+parentId).find(popID);\r\n\t\t    //Проверяем, пришло событие от компанента на котором оно вызвано или нет\r\n\t\t\tif(ppopID.length>0 || $(this).attr('sub')){\r\n\t\t\t\t//Если второй щелчек по кнопке, панель которой видима, то необходимо ее скрыть\r\n\t\t\t    if($(content).is(\":visible\")){\r\n\t\t\t\t\t// отправить на сервер событие закрытия панели Before\r\n\t\t\t\t\tvar par = {};\r\n\t\t\t\t\tpar[\"uid\"] = $(content).attr('id').substring(3); // первые три символа это префикс \"pop\"\r\n\t\t\t\t\tpar[\"cmd\"] = \"hidePopUp\";\r\n\t\t\t\t\tpar[\"t\"] = \"b\";\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(content).fadeOut();\r\n\t\t\t\t\t// отправить на сервер событие закрытия панели After\r\n\t\t\t\t\tpar[\"t\"] = \"a\";\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t    }else{\r\n\t\t\t\t    // отправить на сервер событие открытия панели Before\r\n\t\t\t\t\tvar par = {\"cmd\":\"showPopUp\",\"uid\":$(this).attr('id'),\"t\":\"b\"};\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\r\n\t\t\t\t\tvar left = $(this).attr('sub') ? $(this).offset().left + $(this).width() : $(this).offset().left;\r\n\t\t\t\t\tvar top = $(this).attr('sub') ? $(this).offset().top : $(this).offset().top + $(this).height() + 2;\r\n\r\n\t\t\t    \t//var left = $(this).attr('sub') ? $(this).width() : $(this).offset().left;\r\n\t\t\t    \t//var top = $(this).attr('sub') ? -$(this).height() : $(this).offset().top + $(this).height() + 2;\r\n\t\t\t    \t\r\n\t\t\t    \t$(content).css('left', left);\r\n\t\t\t    \t$(content).css('top', top);\r\n\t\t\t\t\t// скрыть предыдущие панели\r\n\t\t\t\t\tvar parent = $(this).parent();\r\n\t\t\t\t\twhile (!$(parent).hasClass('popUpPanContent') && $(parent).attr('id') != parentId && !$(parent).hasClass('ui-toolbar')) {\r\n\t\t\t\t\t\tparent = $(parent).parent();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar panels = $(parent).find(\".popUpPanContent\");\r\n\t\t\t\t\tfor (var j = 0; j < panels.length; j++) {\r\n\t\t\t\t\t\tif($(panels[j]).attr('id') != popID && $(panels[j]).is(\":visible\")){\r\n\t\t\t\t\t\t\t// отправить на сервер событие закрытия панели Before\r\n\t\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\t\tpar[\"uid\"] = $(panels[j]).attr('id').substring(3); // первые три символа это префикс \"pop\"\r\n\t\t\t\t\t\t\tpar[\"cmd\"] = \"hidePopUp\";\r\n\t\t\t\t\t\t\tpar[\"t\"] = \"b\";\r\n\t\t\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t$(panels[j]).fadeOut();\r\n\t\t\t\t\t\t\t// отправить на сервер событие закрытия панели After\r\n\t\t\t\t\t\t\tpar[\"t\"] = \"a\";\r\n\t\t\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} \r\n\t\t\t\t    // показать панель\r\n\t\t\t\t    $(content).fadeIn();\r\n\t\t\t\t    // отправить на сервер событие открытия панели After\r\n\t\t\t\t\tvar par = {\"cmd\":\"showPopUp\",\"uid\":$(this).attr('id'),\"t\":\"a\"};\r\n\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t    }\r\n\t\t\t}\r\n\t\t    // если панель является подпанелью, то запретить всплытие события\r\n\t    \treturn $(this).attr('sub') ? false : true;\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowPopUpContent(){\r\n\t\tlet _this = this;\r\n\t\t$('.popUpPan.asMenu:not(.hover)').hover(\r\n\t\t\tfunction(e) {\r\n\t\t\t\t_this.showPopupPanel($(this));\r\n\t\t\t},\r\n\t\t\tfunction(e) {\r\n\t\t\t\t_this.hidePopupPanel($(this));\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tshowPopupPanel(popup) {\r\n\t\tvar popID = popup.attr('rel'); \r\n\t\tvar content = $(popID);\r\n\t\tif(!popup.hasClass('hover')){\r\n\t\t\tpopup.addClass('hover');\r\n\t\t}\r\n\t\t//удалить класс если он есть(косяки при открытии)\r\n\t\tif(popup.hasClass('btn-disabled')){\r\n\t\t\tpopup.removeClass('btn-disabled');\r\n\t\t}\r\n\t\t//добавить панель к обработчику события\r\n\t\tpopup.append($(content));\r\n\t\t// отправить на сервер событие открытия панели Before\r\n\t\tvar par = {\"cmd\":\"showPopUp\",\"uid\":popup.attr('id'),\"t\":\"b\"};\r\n\t\tthis.postAndParseData(par);\r\n\t\r\n\t\tvar left = popup.attr('sub') ? popup.offset().left + popup.width() : popup.offset().left;\r\n\t\tvar top = popup.attr('sub') ? popup.offset().top : popup.offset().top + popup.height() + 2;\r\n\t\t\r\n\t\t$(content).css('left', left);\r\n\t\t$(content).css('top', top);\r\n\t\t// показать панель\r\n\t\t$(content).fadeIn(500);\r\n\t\t// отправить на сервер событие открытия панели After\r\n\t\tvar par = {\"cmd\":\"showPopUp\",\"uid\":popup.attr('id'),\"t\":\"a\"};\r\n\t\tthis.postAndParseData(par);\r\n\t}\r\n\t\r\n\thidePopupPanel(popup) {\r\n\t\tvar popID = popup.attr('rel'); \r\n\t\tvar content = $(popID);\r\n\t    // отправить на сервер событие скрыть панель Before\r\n\t\tvar par = {\"cmd\":\"hidePopUp\",\"uid\":popup.attr('id'),\"t\":\"b\"};\r\n\t\tthis.postAndParseData(par);\r\n\t    // отправить на сервер событие скрыть панель After\r\n\t\tvar par = {\"cmd\":\"hidePopUp\",\"uid\":popup.attr('id'),\"t\":\"a\"};\r\n\t\tthis.postAndParseData(par);\r\n\t    // скрыть панель\r\n\t\t$(content).fadeOut(100);\r\n\t}\r\n\r\n\tforseSaveChanges(initiator) {\r\n\t\tthis.endEditing();\r\n\t\tvar par = {\"cmd\":\"fcommit\"};\r\n\t\treturn this.postAndParseData(par);\r\n\t}\r\n\t\r\n\tshowErrors(errors, filePath, fileName, command, btn1show, btn1text, popup) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\t_this.errorUtil.clearAllErrorType();\r\n\t\r\n\t\tvar content = this.errorUtil.higlightErrors(errors);\r\n\t\t\r\n\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t_this.dialogResult[dialogId] = '1';\r\n\t\r\n\t\tvar buttons = [];\r\n\t\r\n\t\tif (btn1show == true) {\r\n\t\t\tvar button1 = {\r\n\t\t\t\ttext: btn1text,\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (popup)\r\n\t\t\t\t\t\tpopup.dialog('destroy');\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (popup == null && command == \"nextStep\")\r\n\t\t\t\t\t\t_this.nav.toActiveMain();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tbuttons.push(button1);\r\n\t\t}\t\r\n\t\tvar button2 = {\r\n\t\t\ttext: Translation.translation['continue'],\r\n\t\t\thandler: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuttons.push(button2);\r\n\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: '<div style=\"font-size:14px; color: #777;\">'+Translation.translation['errors']+'</div>',\r\n\t\t\twidth: 900,\r\n\t\t\theight: 550,\r\n\t\t\tresizable: true,\r\n\t\t\tstyle: {'background': 'rgba(0, 0, 0, 0) linear-gradient(to bottom, #eff5ff 0px, #e0ecff 20%) repeat-x scroll 0 0', 'border-color':'#95b8e7'},\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tmodal: true,\r\n\t\t\tcontent:content,\r\n\t\t\ttools: [{\r\n\t\t\t\t\ticonCls:'icon-rept',\r\n\t\t\t\t\thandler:function(){\r\n\t\t\t\t\t\tif (filePath != null) {\r\n\t\t\t\t\t\t\tvar url = _this.app.restUrl + \"&rnd=\" + Util.rnd() + \"&cmd=opf&fn=\" + encodeURIComponent(filePath) + \"&fr=\" + encodeURIComponent(fileName);\r\n\t\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t}],\r\n\t\t\tonOpen: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_ERRORS);\r\n\t\t\t\t$(\"li[uuid]\").on('click', function (e) {\r\n\t\t\t\t\tvar uuid = $(this).attr('uuid');\r\n\t\t\t\t\tvar rownum = -1;\r\n\t\t\t\t\tvar row = $(this).attr('row');\r\n\t\t\t\t\tif (row != null && row.length > 0)\r\n\t\t\t\t\t\trownum = parseInt(row);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t_this.focusComponent(uuid, rownum);\r\n\t\t\t\t\t\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\tlet opts = $(this).dialog('options');\r\n\t\r\n\t        \tif (_this.dialogResult[dialogId] == '0') {\r\n\t    \t\t\tvar par = {};\r\n\t    \t\t\tpar[\"cmd\"] = command;\r\n\t    \t\t\tpar[\"result\"] = \"save\";\r\n\t    \t\t\tUtil.blockPage(Translation.translation['saving']);\r\n\t    \t\t\t\r\n\t\t\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t\t\tif (data.result == \"success\") {\r\n\t\t\t\t\t\t\t_this.hideChangeMsg();\r\n\t\t\t\t\t\t\t_this.loadData({});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tUtil.alert(Translation.translation['error'], Util.ERROR);\r\n\t\t\t\t\t\t}\r\n\t    \t\t\t\t$('body').unblock();\r\n\t\t\t\t\t}, () => {\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t});\r\n\t        \t}\r\n\t        \tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t        \tInterfaceController.popDlgType.pop();\r\n\t        \t}\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\t\r\n\t\t_this.popupcount++;\r\n\t}\r\n\r\n\tshowForceErrors(errors, btn1show, filePath, fileName, btn1text, btn2text) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\t_this.errorUtil.clearAllErrorType();\r\n\t\r\n\t\tvar content = this.errorUtil.higlightErrors(errors);\r\n\t\r\n\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t_this.dialogResult[dialogId] = '1';\r\n\t\r\n\t\tvar buttons = [];\r\n\t\r\n\t\tif (btn1show == true) {\r\n\t\t\tvar button1 = {\r\n\t\t\t\ttext: btn1text,\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tbuttons.push(button1);\r\n\t\t}\t\r\n\t\tvar text2 = btn2text == undefined ? Translation.translation['continue'] : btn2text;\r\n\t\tvar button2 = {\r\n\t\t\ttext: text2,\r\n\t\t\thandler: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuttons.push(button2);\r\n\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: '<div style=\"font-size:14px; color: #777;\">'+Translation.translation['errors']+'</div>',\r\n\t\t\twidth: 900,\r\n\t\t\theight: 550,\r\n\t\t\tresizable: true,\r\n\t\t\tstyle: {'background': 'rgba(0, 0, 0, 0) linear-gradient(to bottom, #eff5ff 0px, #e0ecff 20%) repeat-x scroll 0 0', 'border-color':'#95b8e7'},\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tmodal: true,\r\n\t\t\tcontent:content,\r\n\t\t\ttools: [{\r\n\t\t\t\ticonCls:'icon-rept',\r\n\t\t\t\thandler:function(){\r\n\t\t\t\t\tif (filePath != null) {\r\n\t\t\t\t\t\tvar url = _this.app.restUrl + \"&rnd=\" + Util.rnd() + \"&cmd=opf&fn=\" + encodeURIComponent(filePath) + \"&fr=\" + encodeURIComponent(fileName);\r\n\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}],\r\n\t\t\tonOpen: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_NO_SEND);\r\n\t\t\t\t$(\"li[uuid]\").on('click', function (e) {\r\n\t\t\t\t\tvar uuid = $(this).attr('uuid');\r\n\t\t\t\t\tvar rownum = -1;\r\n\t\t\t\t\tvar row = $(this).attr('row');\r\n\t\t\t\t\tif (row != null && row.length > 0)\r\n\t\t\t\t\t\trownum = parseInt(row);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t_this.focusComponent(uuid, rownum);\r\n\t\t\t\t\t\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\r\n\t\t\t\tlet opts = $(this).dialog('options');\r\n\t\r\n\t\t\t\tvar par = {};\r\n\t        \tif (_this.dialogResult[dialogId] == '0') {\r\n\t        \t\tpar[\"commitResult\"] = 1;\r\n\t        \t} else {\r\n\t        \t\tpar[\"commitResult\"] = 0;\r\n\t        \t}\r\n\t        \t_this.app.query(par).then(response => {\r\n\t\t        \tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t\t        \tInterfaceController.popDlgType.pop();\r\n\t\t        \t}\r\n\t\t        });\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\t\r\n\t\t_this.popupcount++;\r\n\t}\r\n\r\n\tshowPopupErrors(errors, filePath, fileName, opts, popup, fatal, isDataIntegrityControl) {\r\n\t\t\r\n\t\tlet _this = this;\r\n\t\tvar content = this.errorUtil.higlightErrors(errors);\r\n\t\t\r\n\t\tthis.fatal = fatal;\r\n\t\tthis.isDataIntegrityControl = isDataIntegrityControl;\r\n\t\tthis.opts = opts;\r\n\t\r\n\t\tvar dialogId = 'or3_popup' + this.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\r\n\t\tvar buttons = [];\r\n\t\r\n\t\tvar button1 = {\r\n\t\t\ttext: Translation.translation['continue2'],\r\n\t\t\thandler: function() {\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuttons.push(button1);\r\n\t\t\r\n\t\tif (fatal && isDataIntegrityControl) {\r\n\t\t\tvar button3 = {\r\n\t\t\t\ttext: Translation.translation['cancel'],\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\tvar openedDialogs = InterfaceController.openedDialogs;\r\n\t\t\t\t\tif (openedDialogs.length > 0) {\r\n\t\t\t\t\t\tvar dialogId1 = openedDialogs[openedDialogs.length - 1];\r\n\t\t\t\t\t\t_this.setDialogBtnsEnabled(dialogId1, false);\r\n\t\t\t\t\t\t_this.sendUserDecision(\"1\");\r\n\t\t\t\t\t\t_this.dialogResult[dialogId1] = '1';\r\n\t\t\t\t\t\t$(\"#\" + dialogId1).dialog('destroy');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tbuttons.push(button3);\r\n\t\t} else {\r\n\t\t\tvar button2 = {\r\n\t\t\t\ttext: Translation.translation['save'],\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar par = {};\r\n\t\t        \tpar[\"uid\"] = opts.uid ;\r\n\t\t        \tpar[\"val\"] = '0';\r\n\t\t        \tif (opts.row != undefined) par[\"row\"] = opts.row;\r\n\t\t        \tif (opts.cuid != undefined) par[\"cuid\"] = opts.cuid;\r\n\t\t        \tpar[\"cmd\"] = \"closePopup\";\r\n\t\t        \t_this.loadData(par, true).then(() => {\r\n\t\t\t\t\t\tpopup.dialog('destroy');\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tbuttons.push(button2);\r\n\t\t}\r\n\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: '<div style=\"font-size:14px; color: #777;\">'+Translation.translation['errors']+'</div>',\r\n\t\t\twidth: 600,\r\n\t\t\theight: 400,\r\n\t\t\tstyle: {'background': 'rgba(0, 0, 0, 0) linear-gradient(to bottom, #eff5ff 0px, #e0ecff 20%) repeat-x scroll 0 0', 'border-color':'#95b8e7'},\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tmodal: true,\r\n\t\t\tcontent:content,\r\n\t\t\ttools: [{\r\n\t\t\t\ticonCls:'icon-rept',\r\n\t\t\t\thandler:function(){\r\n\t\t\t\t\tif (filePath != null) {\r\n\t\t\t\t\t\tvar url = _this.app.restUrl + \"&rnd=\" + Util.rnd() + \"&cmd=opf&fn=\" + encodeURIComponent(filePath) + \"&fr=\" + encodeURIComponent(fileName);\r\n\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}],\r\n\t\t\tonOpen: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_POPUP_ERRORS);\r\n\t\t\t\t$(\"li[uuid]\").on('click', function (e) {\r\n\t\t\t\t\tvar uuid = $(this).attr('uuid');\r\n\t\t\t\t\tvar rownum = -1;\r\n\t\t\t\t\tvar row = $(this).attr('row');\r\n\t\t\t\t\tif (row != null && row.length > 0)\r\n\t\t\t\t\t\trownum = parseInt(row);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t_this.focusComponent(uuid, rownum);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t\t\t\tInterfaceController.popDlg.pop();\r\n\t\t\t\t\tInterfaceController.popDlgType.pop();\r\n\t\t\t\t}\t\t\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\t\r\n\t\t_this.popupcount++;\r\n\t}\r\n\t\r\n\tfocusComponent(uuid, rownum) {\r\n\t\tlet _this = this;\r\n\t\tvar e = $('#' + uuid);\r\n\t\tif (rownum > -1) {\r\n\t\t\tvar td_fields = $(\".datagrid-btable td[field=\"+ uuid +\"]\");\r\n\t\t\tif (td_fields.length >= rownum) {\r\n\t\t\t\te = $(td_fields.get(rownum));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (e != null && e.length > 0) {\r\n\t\t\t// Если компонент лежит на табпанели, пробегаем по всем родителям - табпанелям\r\n\t\t\t$.each(e.parents('.tabs-panels > .panel > .panel-body'), function(i, selTab) {\r\n\t\t\t\tvar tabPanel = $(selTab).parent().parent().parent();\r\n\t\t\t\tvar index = parseInt($(selTab).attr('tabindex'));\r\n\t\t\t\ttabPanel.tabs('select', index);\r\n\t\t\t});\r\n\t\t\r\n\t\t\tif (rownum > -1) {\r\n\t\t\t\te.click();\r\n\t\t\t\tvar parent = e.parents('.datagrid-body');\r\n\t\t\t\tvar table = parent.find('.datagrid-btable');\r\n\t\t\t\t\r\n\t\t\t\tparent.scrollTop(e.offset().top - table.offset().top);\r\n\t\t\t\tparent.scrollLeft(e.offset().left - table.offset().left);\r\n\t\t\t\t\r\n\t\t\t\tvar openedDialogs = InterfaceController.openedDialogs;\r\n\t\t\t\tif (openedDialogs.length == 0) {\r\n\t\t\t\t\t$('#app').scrollTop(e.parents('.datagrid').offset().top - $('#app').children('div').offset().top);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (e.hasClass('easyui-datebox')) {\r\n\t\t\t\t\tif (!e.hasClass('datebox-f')) e.datebox();\r\n\t\t\t\t\te = e.datebox(\"textbox\")\r\n\t\t\t\t} else if (e.hasClass('easyui-datetimebox')) {\r\n\t\t\t\t\tif (!e.hasClass('datetimebox-f')) e.datetimebox();\r\n\t\t\t\t\te = e.datetimebox(\"textbox\");\r\n\t\t\t\t} else if (e.hasClass('easyui-combobox')) {\r\n\t\t\t\t\tif (!e.hasClass('combobox-f')) e.combobox();\r\n\t\t\t\t\te = e.combobox(\"textbox\");\r\n\t\t\t\t} else if (e.hasClass('easyui-numberbox')) {\r\n\t\t\t\t\tif (!e.hasClass('numberbox-f')) e.numberbox();\r\n\t\t\t\t\te = e.numberbox(\"textbox\");\r\n\t\t\t\t}\r\n\t\t\t\te.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tdownloadFile(e, id, row, col) {\r\n\t\tlet _this = this;\r\n\t\tvar curTime = (new Date).getTime();\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\t\r\n\t\tif (_this.lastDownloadTime == 0 || curTime - _this.lastDownloadTime > _this.waitTime) {\r\n\t\t\t_this.lastDownloadTime = curTime;\r\n\t\t\tvar par = {};\r\n\t\t\tpar[\"uid\"] = id;\r\n\t\t\tpar[\"cmd\"] = \"viewFile\";\r\n\t\t\tif (row != null)\r\n\t\t\t\tpar[\"row\"] = row;\r\n\t\t\tif (col != null)\r\n\t\t\t\tpar[\"col\"] = col;\r\n\t\t\t\r\n\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t_this.loadData({}, true);\r\n\t\t\t\tif (data.result == \"success\") {\r\n\t\t\t\t\tvar url = _this.app.restUrl + \"&trg=frm&cmd=opf&fn=\" + encodeURIComponent(data.file);\r\n\t\t\t\t\tif (url.indexOf(\"/\") > 0) url = \"/\" + url;\r\n\t\t\t\t\turl += \"&rnd=\" + Util.rnd();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (data.action == \"print\") {\r\n\t\t\t\t\t\tvar opts = {url: url};\r\n\t\t\t\t\t\tvar btn = $(\"<button></button>\").appendTo($('#trash'));\r\n\t\t\t\t\t\tbtn.printPage(opts);\r\n\t\t\t\t\t\tbtn.click();\r\n\t\t\t\t\t} else if (data.action == \"view\") {\r\n\t\t\t\t\t\tif (data.ext == \"html\") {\r\n\t\t\t\t\t\t\twindow.open(url);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\topenStartDialog(uid) {\r\n\t\tlet _this = this;\r\n\t\tUtil.blockPage();\r\n\t\tvar par = {};\r\n\t\tpar[\"uid\"] = uid;\r\n\t\tpar[\"cmd\"] = \"openTask\";\r\n\t\tpar[\"size\"] = 1;\r\n\t\t\r\n\t\t_this.app.post(par).then(data => {\r\n\t\t\tif (data.result == 'error') {\r\n\t\t\t\tUtil.alert(data.message, Util.ERROR);\r\n\t\t\t} else {\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\t_this.selectedRow = [];\r\n\t\t\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t\t\t\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t_this.dialogOpened = dialogId;\r\n\t\t\t\t\r\n\t\t\t\t$('#' + dialogId).dialog({\r\n\t\t\t\t\ttitle: '<div style=\"font-size:14px; color:#777;\">'+data.t+'</div>',\r\n\t\t\t\t\twidth: data.w,\r\n\t\t\t\t\theight: data.h,\r\n\t\t\t\t\tclosed: false,\r\n\t\t\t\t\tcache: false,\r\n\t\t\t\t\thref: _this.app.restUrl + '&cmd=openTask&uid=' + uid + \"&rnd=\" + Util.rnd(),\r\n\t\t\t\t\tmodal: true,\r\n\t\t\t\t\tuid: uid,\r\n\t\t\t\t\tonOpen: function() {\r\n\t\t\t\t\t\t$('#' + dialogId +' .panel').append($(\"<div class=\\\"glassDialog\\\"></div>\"));\r\n\t\t\t\t\t\t$('#' + dialogId + ' .glassDialog').height($('#' + dialogId +' .panel').height()).width($('#' + dialogId +' .panel').width());\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonLoad: function() {\r\n\t\t\t\t\t\t// Добавляем ID-окна в массив окон\r\n\t\t\t\t\t\tInterfaceController.openedDialogs.push(dialogId);\r\n\t\t\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_OPEN_AT_START);\r\n\t\t\t\t\t\t_this.loadData({});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('.clean-btn').click(function(e) {\r\n\t\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\t\tpar[\"uid\"] = $(this).attr('id').substring(3);\r\n\t\t\t\t\t\t\tpar[\"cmd\"] = \"clr\";\r\n\t\t\t\t\t\t\t_this.postAndParseData(par);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_this.preparefileUpload();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonClose: function() {\r\n\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t$('#' + dialogId).dialog('destroy');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\t\t\t// Удаляем ID-окна из массива окон\r\n\t\t\t\t\t\tInterfaceController.openedDialogs.pop();\r\n\t\t\t\t\t\t_this.dialogOpened = null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (_this.dialogResult[dialogId] == '1' || _this.dialogResult[dialogId] == 1) {\r\n\t\t\t\t\t\t\t_this.app.nav.cancelStart(uid);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t\t\t        \tInterfaceController.popDlgType.pop();\r\n\t\t\t        \t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbuttons: [{\r\n\t\t\t\t\t\ttext: Translation.translation['ok'],\r\n\t\t\t\t\t\thandler: function() {\r\n\t\t\t\t\t\t\t_this.setDialogBtnsEnabled(dialogId, false);\r\n\t\t\t\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t\t\t\t\t\t\t_this.app.nav.nextStep(true, dialogId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: Translation.translation['close'],\r\n\t\t\t\t\t\thandler: function() {\r\n\t\t\t\t\t\t\t_this.setDialogBtnsEnabled(dialogId, false);\r\n\t\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t\t$('#' + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t});\r\n\t\t\t\t_this.popupcount++;\r\n\t\t\t}\r\n\t\t}, 'json');\r\n\t}\r\n\r\n\tsendFile() {\r\n\t\tvar file = document.getElementById(\"chooser\").files.item(0);\r\n\t\t$('#getFile').dialog(\"close\");\r\n\t\tUtil.blockPage();\r\n\t\t\r\n\t    var url = this.app.restUrl + \"&rnd=\" + Util.rnd();\r\n\t   \r\n\t\tif (file) {\r\n\t\t\tvar formData = new FormData();                  \r\n\t\t\tformData.append('getFile', file);\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype : 'POST',\r\n\t\t\t\turl : url,\r\n\t\t\t\tcache : false,\r\n\t\t\t\tcontentType : false,\r\n\t\t\t\tprocessData : false,\r\n\t\t\t\tdata : formData,\r\n\t\t\t\tsuccess : function(data) {},\r\n\t\t\t\tdataType : 'json',\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tvar par = {};\r\n\t\t\tpar[\"cmd\"] = 'getFileIsNull';\r\n\t\t\tpar[\"json\"] = 1;\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype : 'POST',\r\n\t\t\t\turl : url,\r\n\t\t\t\tdata : par,\r\n\t\t\t\tsuccess : function(data) {},\r\n\t\t\t\tdataType : 'json',\r\n\t\t\t\tasync : false\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\treload(uid) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"cmd\":\"reload\",\"uid\":uid};\r\n\t\tthis.app.query(par).then(content => {\r\n\t\t\tvar parent = $('#' + uid).parent();\r\n\t\t\tparent.html(content);\r\n\t\t\tparent.find('.easyui-panel:not(.tamur-tabs)').panel();\r\n\t\t\tparent.find('.easyui-datagrid').datagrid();\r\n\t\t\tpreparefileUpload(parent);\r\n\t\r\n\t\t\tvar par = {};\r\n\t\t\tpar[\"rnd\"] = Util.rnd();\r\n\t\t\tpar[\"getChange\"] = \"\";\r\n\t\t\t_this.postAndParseData(par);\r\n\t\t});\r\n\t}\r\n\t\r\n\tcloseIfc() {\r\n\t\tthis.endEditing();\r\n\t\tUtil.blockPage(Translation.translation['saving']);\r\n\t\tvar par = {\"cmd\":\"closeIfc\"};\r\n\t\t\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\t$('body').unblock();\r\n\t\t});\r\n\t}\r\n\r\n\tresetChanges() {\r\n\t\tlet _this = this;\r\n\t\tUtil.blockPage(Translation.translation['canceling']);\r\n\t\tvar par = {\"cmd\":\"rollback\"};\r\n\t\tthis.loadData(par).then(data => {\r\n\t\t\t_this.hideChangeMsg();\r\n\t\t\tInterfaceController.styles = {};\r\n\t\t});\r\n\t}\r\n\t\r\n\tsaveChanges() {\r\n\t\tlet _this = this;\r\n\t\tthis.endEditing();\r\n\t\tUtil.blockPage(Translation.translation['saving']);\r\n\t\tvar par = {\"cmd\":\"commit\"};\r\n\t\t\t\r\n\t\tthis.app.post(par).then(data => {\r\n\t\t\tif (data.result == \"success\") {\r\n\t\t\t\t_this.hideChangeMsg();\r\n\t\t\t} else {\r\n\t\t\t\tif (data.result == \"fatal\") {\r\n\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t}\r\n\t\t\t\t_this.showErrors(data.errors, data.path, data.name, \"commit\", true, Translation.translation['save']);\r\n\t\t\t}\r\n\t\t\t$('body').unblock();\r\n\t\t});\r\n\t}\r\n\r\n\tdgBtnAction2(com, i, btn) {\r\n\t\tif (!btn.hasClass('l-btn-disabled')) {\r\n\t\t\tthis.dgBtnAction(com, i, btn);\r\n\t\t}\r\n\t}\r\n\t\r\n\tdgBtnAction(com, i, btn) {\r\n\t\tlet _this = this;\r\n\t\tthis.endEditing().then(() => {\r\n\t\t    var par = {};\r\n\t\t\tpar[\"uid\"] = i;\r\n\t\t\tif(com == \"del\") {\r\n\t\t\t\tvar objs = $('#'+i).datagrid('getSelections');\r\n\t\t\t\tif(objs.length > 0) {\r\n\t\t\t\t\tvar indxs = [objs.length];\r\n\t\t\t\t\tfor (var j = 0; j < objs.length; j++) {\r\n\t\t\t\t\t\tindxs[j] = _this.globalIndex($('#'+i), $('#'+i).datagrid('getRowIndex', objs[j]));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar idx = indxs.join(\",\");\r\n\t\t\t\t\tpar[\"idx\"] = idx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar st = com.indexOf('media/img/');\r\n\t\t\tif (st>-1) {\r\n\t\t\t\tvar fn = com.indexOf('.gif', st);\r\n\t\t\t\tpar[\"com\"] = com.substring(st+10,fn);\r\n\t\t\t} else {\r\n\t\t\t\tpar[\"com\"] = com;\r\n\t\t\t}\r\n\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\t\r\n\t\t\tif (btn && com == \"showDel\") {\r\n\t\t\t\tvar span = btn.find('.icon-showDel');\r\n\t\t\t\tif (span.length > 0)\r\n\t\t\t\t\tspan.removeClass('icon-showDel').addClass('icon-showDelUn');\r\n\t\t\t\telse\r\n\t\t\t\t\tbtn.find('.icon-showDelUn').removeClass('icon-showDelUn').addClass('icon-showDel');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\tif (data.changes) {\r\n\t\t\t\t\t_this.parseData(data);\r\n\t\t\t\t\t_this.reloadTables();\r\n\t\t\t\t} else {\r\n\t\t\t        if (data.result == \"success\") {\r\n\t\t\t        \t$.messager.confirm('', data.message, function(e){\r\n\t\t\t                if (e){\r\n\t\t\t                \tpar[\"sure\"] = 1;\r\n\t\t\t        \t\t\t_this.loadData(par).then(data => {\r\n\t\t\t        \t\t\t\t_this.showChangeMsg();\r\n\t\t\t        \t\t\t});\r\n\t\t\t                }\r\n\t\t\t            });\r\n\t\t\t        }\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\treportClick(btn) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {};\r\n\t\tpar[\"id\"] = btn.attr('reportid');\r\n\t\tpar[\"cmd\"] = \"print\";\r\n\t\t\r\n\t\t_this.app.post(par).then(data => {\r\n\t\t\tif (data.result == 'error') {\r\n\t\t\t\tUtil.alert(data.message, Util.ERROR);\r\n\t\t\t} else if (data.file) {\r\n\t\t\t\tvar url = _this.app.restUrl + \"&rnd=\" +Util.rnd() + \"&cmd=opf&fn=\" + encodeURIComponent(data.file);\r\n\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tchangeInterfaceLang(code, e) {\r\n\t\te.preventDefault();\r\n\t\r\n\t\tUtil.blockPage();\r\n\t\tthis.app.query({\"setLang\":code}).then(data => {\r\n\t\t\tvar url = \"index.jsp?guid=\" + guid + \"&rnd=\" + Util.rnd() + document.location.hash;\r\n\t\t\twindow.location.href = url;\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowOptions(options) {\r\n\t\tlet _this = this;\r\n\t\tvar content = \"<table class='options'><tr><td>\";\r\n\t\t$.each(options, function(i, option) {\r\n\t\t\tcontent += \"<tr><td><input type='radio' name='option' value='\" + i + \"'/>\" + option.o + \"</td></tr>\";\r\n\t\t});\r\n\t\tcontent += \"</table>\";\r\n\t\r\n\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\r\n\t\t_this.dialogResult[dialogId] = '1';\r\n\t\r\n\t\tvar buttons = [];\r\n\t\r\n\t\tvar button1 = {\r\n\t\t\ttext: 'Ok',\r\n\t\t\thandler: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuttons.push(button1);\r\n\t\tvar button2 = {\r\n\t\t\ttext: Translation.translation['cancel'],\r\n\t\t\thandler: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuttons.push(button2);\r\n\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: '<div style=\"font-size:14px; color:#777;\">Выбор дальнейшей обработки</div>',\r\n\t\t\twidth: 500,\r\n\t\t\theight: 250,\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tmodal: true,\r\n\t\t\tcontent:content,\r\n\t\t\tonOpen: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_NO_SEND);\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\tvar par = {\"optionResult\": -1};\r\n\t        \tif (_this.dialogResult[dialogId] == '0') {\r\n\t        \t\tvar checked = $('#' + dialogId).find('input:checked');\r\n\t        \t\tif (checked.length > 0)\r\n\t        \t\t\tpar[\"optionResult\"] = checked.val();\r\n\t        \t}\r\n\t        \t_this.app.query(par).then(response => {\r\n\t\t        \tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t\t        \tInterfaceController.popDlgType.pop();\r\n\t\t        \t}\r\n\t\t        });\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\t\r\n\t\t_this.popupcount++;\r\n\t}\r\n\t\r\n\topenTree(uid, title, row, colUid) {\r\n\t\tlet _this = this;\r\n\t\r\n\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t_this.dialogResult[dialogId] = '1';\r\n\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: '<div style=\"font-size:14px; color:#777;\">'+title+'</div>',\r\n\t\t\twidth: 800,\r\n\t\t\theight: 600,\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\thref: _this.app.restUrl + '&cmd=openTree&uid=' + uid + (row != undefined ? '&row=' + row + \"&cuid=\" + colUid : \"\"),\r\n\t\t\tmodal: true,\r\n\t\t\tuid: uid,\r\n\t\t\trow: row,\r\n\t\t\tcuid: colUid,\r\n\t\t\tonLoad: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_TREE_FIELD);\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\t_this.searchCount = -1;\r\n\t\t\t\tlet opts = $(this).dialog('options');\r\n\t        \tif (_this.dialogResult[dialogId] == 0) {\r\n\t                var par = {};\r\n\t        \t\tpar[\"cmd\"] = \"set\";\r\n\t            \tpar[\"uid\"] = opts.uid;\r\n\t            \tif (opts.row != undefined) par[\"row\"] = opts.row;\r\n\t            \tif (opts.cuid != undefined) par[\"cuid\"] = opts.cuid;\r\n\t    \t\t\tpar[\"val\"] = -1;\r\n\t        \t\tvar selNode = $(this).find('.easyui-tree').tree('getSelected');\r\n\t        \t\tif (selNode) {\r\n\t        \t\t\tpar[\"val\"] = selNode.id;\r\n\t        \t\t}\r\n\t        \t\t_this.loadData(par);\r\n\t        \t}\r\n\t        \tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t        \tInterfaceController.popDlgType.pop();\r\n\t        \t}\r\n\t\t\t},\r\n\t\t\tbuttons: [{\r\n\t\t\t\ttext: Translation.translation['ok'],\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t                _this.showChangeMsg();\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: Translation.translation['cancel'],\r\n\t\t\t\thandler: function() {\r\n\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t});\r\n\t\t\r\n\t\t_this.popupcount++;\r\n\t}\r\n\r\n\tuploadImage(uid) {\r\n\t\tlet _this = this;\r\n\t\t$('#upload').fileupload({\r\n\t\t\tdropZone: $('#' + uid),\r\n\t\t\tpasteZone: $('#' + uid),\r\n\t\t    url: _this.app.restUrl + '&uid=' + uid,\r\n\t\t    dataType: 'json',\r\n\t        done: function (e, data) {\r\n\t        \tif (data.result.result == 'success') {\r\n\t                _this.showChangeMsg();\r\n\t        \t\t_this.loadData({}, true);\r\n\t        \t} else\r\n\t        \t\tUtil.alert(data.result.message, Util.ERROR);\r\n\t        }\r\n\t\t}).fileupload('option', {acceptFileTypes: /(\\.|\\/)(gif|jpe?g|png)$/i}).click();\r\n\t}\r\n\t\r\n\tdisplayEmptyParentPanels(comp) {\r\n\t\tif (comp.parents('.popUpPanContent').length == 0) {\r\n\t\t\tlet _this = this;\r\n\t\t\tlet parentPanels = comp.parents('.orpanel');\r\n\t\t\t$.each(parentPanels, function(i, panel) {\r\n\t\t\t\tif ($(panel).attr('id') && !_this.hiddenPanels[$(panel).attr('id')]) {\r\n\t\t\t\t\t$(panel).show();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tlet childPanels = comp.find('.orpanel');\r\n\t\t\t$.each(childPanels, function(i, panel) {\r\n\t\t\t\tif (!_this.hiddenPanels[$(panel).attr('id')]) { \r\n\t\t\t\t\tlet children = $(panel).find(':not(td, tr, tbody, [onTop], [onTop] *)')\r\n\t\t\t\t\tvar show = false;\r\n\t\t\t\t\t$.each(children, function(k, child) {\r\n\t\t\t\t\t\tif ( $(child).css('display') != 'none' && $(child).css(\"visibility\") != \"hidden\") {\r\n\t\t\t\t\t\t\tshow = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (show) {\r\n\t\t\t\t\t\t$(panel).show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\t\t\t\r\n\r\n\thideEmptyParentPanels(comp) {\r\n\t\tif (comp.parents('.popUpPanContent').length == 0) { \r\n\t\t\tlet parentPanels = comp.parents('.orpanel');\r\n\t\t\t$.each(parentPanels, function(i, panel) {\r\n\t\t\t\tif ($(panel).find(':not(td, tr, tbody, [onTop], [onTop] *):visible').length == 0)\r\n\t\t\t\t\t$(panel).hide();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tsetFocus() {\r\n\t\t// чтобы при заходе в систему курсор сразу встал на input(глобальный поиск)\r\n\t\tdocument.getElementById(\"privateDeal\").focus();\r\n\t}\r\n\r\n\tchangeTooltipPref(val) {\r\n\t\t// всплывающие подсказки вкл, выкл\r\n\t\tval == 'true' ? true : false;\r\n\t\tvar par = {\"setTooltipPref\":val};\r\n\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\t  console.log(\"success changeTooltipPref\")\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// дописать остальную функцию \r\n\t\t// attachProcessTooltips('processess');\r\n\t}\r\n\r\n\tchangeNoteSoundPref(val) {\r\n\t\t// звук вкл, выкл\r\n\t\tval == 'true' ? true : false;\r\n\t\tvar par = {\"setNoteSoundPref\":val};\r\n\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\t  console.log(\"success changeNoteSoundPref\")\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tchangeInstantECPPref(val) {\r\n\t\t// Хранить пароль ЭЦП во время сессии\r\n\t\tvar par = {\"setInstantECPPref\": val};\r\n\t\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\t  console.log(\"success changeInstantECPPref\")\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tchangePwdDialog(obligatory) {\r\n\t\tlet this_ = this;\r\n\t\tvar dialogId = 'or3_popup' + this_.popupcount;\r\n\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\tthis_.dialogResult[dialogId] = '1';\r\n\t\r\n\t\tvar buttonOk = {\r\n\t\t\ttext: Translation.translation['change'],\r\n\t\t\thandler: function() {\r\n\t\t\t\tthis_.dialogResult[dialogId] = '0';\r\n\t\t\t\tvar par = {};\r\n\t\t\t\tpar[\"cmd\"] = \"changePass\";\r\n\t\t\t\tpar[\"oldPass\"] = $('#' + dialogId).find('[uid=\"oldPass\"]').val();\r\n\t\t\t\tpar[\"newPass\"] = $('#' + dialogId).find('[uid=\"newPass\"]').val();\r\n\t\t\t\tpar[\"confirmPass\"] = $('#' + dialogId).find('[uid=\"confirmPass\"]').val();\r\n\t\t\t\t$.post(window.mainUrl + \"&rnd=\" + Util.rnd(), par, function(json) {\r\n\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\tif (data.result == 'error') {\r\n\t\t\t\t\t\t\talert(data.message, Util.ERROR);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 'json');\r\n\t\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tvar buttonCancel = {\r\n\t\t\ttext: Translation.translation['cancel'],\r\n\t\t\thandler: function() {\r\n\t\t\t\tthis_.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tvar buttons = (obligatory) ? [buttonOk] : [buttonOk, buttonCancel];\r\n\t\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: Translation.translation['passChange'],\r\n\t\t\twidth: 300,\r\n\t\t\theight: 200,\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tclosable: obligatory != true,\r\n\t\t\thref: window.contextName + '/jsp/pwd.jsp?guid=' + guid + '&rnd=' + Util.rnd(),\r\n\t\t\tmodal: true,\r\n\t\t\tonLoad: function() {\r\n\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\tInterfaceController.popDlgType.push(this_.DLG_CHANGE_PD);\r\n\t\t\t},\r\n\t\t\tonClose: function() {\r\n\t\t\t\tthis_.dialogResult[dialogId] = '1';\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t\t\t\tInterfaceController.popDlg.pop();\r\n\t\t\t\t\tInterfaceController.popDlgType.pop();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\t\r\n\t\tthis_.popupcount++;\r\n\t}\r\n}\r\n","import {Util} from './util.js';\r\nimport {Translation} from './translation.js';\r\nimport {NCA} from './nca.js';\r\n                         \r\nexport class Login {\r\n\r\n\tsLogin = false;\r\n\tlanguage = \"KZ\";\r\n\r\n\tconstructor(contextName, mainUrl, lang) {\r\n\t\tthis.guid = Util.generateGUID();\r\n\r\n\t\tthis.contextName = contextName;\r\n\t\tUtil.restUrl = mainUrl;\r\n\t\tthis.lang = lang;\r\n\t\tthis.language = localStorage.getItem(\"EkyzmetLanguage\");\r\n\t}\r\n\r\n\tinit() {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tTranslation.init(this.lang);\r\n\t\tthis.browser = this.testBrowser();\r\n\t\t\r\n\t\tthis.ncaLayer = new NCA();\r\n\t\t\r\n\t\tthis.getContactInfo();\r\n\r\n\t\t$('#loginBtn').click(function() {\r\n\t\t\t$('#loginBtn').css({\"background-color\": \"#298F94\"});\r\n\t\t\treturn _this.login(false);\r\n\t\t});\r\n\t\t$('#password').keydown(function(event) {\r\n\t\t\tif(event.keyCode === 13) {\r\n\t\t\t\t$('#loginBtn').css({\"background-color\": \"#298F94\"});\r\n\t\t\t\treturn _this.login(false);\r\n\t\t\t}\r\n\t\t});\r\n\t\t$('#user').keydown(function(event) {\r\n\t\t \tif(event.keyCode === 13) {\r\n\t\t\t\t$('#loginBtn').css({\"background-color\": \"#298F94\"});\r\n\t\t\t\treturn _this.login(false);\r\n\t\t\t}\r\n\t\t});\r\n\t\t$(\"#topLangKz\").on(\"click\", function() {\r\n\t\t\t_this.setLangToolTip(\"KZ\");\r\n\t\t});\r\n\r\n\t\t$(\"#topLangRu\").on(\"click\", function() {\r\n\t\t\t_this.setLangToolTip(\"RU\");\r\n\t\t});\r\n\r\n\t\t$('#loginEcpBtn').click(function() {\r\n\t\t\treturn _this.loginECP();\r\n\t\t});\r\n\r\n\t\t$('#clearBtn').click(function() {\r\n\t\t\t$('#user').val('');\r\n\t\t\t$('#password').val('');\r\n\t\t\t$(\".login-error-text\").html(\"\");\r\n\t\t}).keydown(function(event) {\r\n\t\t\tif(event.keyCode === 13) {\r\n\t\t\t\t$('#user').val('');\r\n\t\t\t\t$('#password').val('');\r\n\t\t\t\t$(\".login-error-text\").html(\"\");\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$('.btn-login-ecp').click(function(e) {\r\n\t\t\t$('#login-pass-form').hide();\r\n\t\t\t$('.btn-login-pass').removeClass('selected');\r\n\t\t\t$('#login-ecp-form').show();\r\n\t\t\t$('.btn-login-ecp').addClass('selected');\r\n\t\t\t$(\".login-error-text\").html(\"\");\r\n\t\t});\r\n\t\t$('.btn-login-pass').click(function(e) {\r\n\t\t\t$('#login-pass-form').show();\r\n\t\t\t$('.btn-login-pass').addClass('selected');\r\n\t\t\t$('#login-ecp-form').hide();\r\n\t\t\t$('.btn-login-ecp').removeClass('selected');\r\n\t\t\t$(\".login-error-text\").html(\"\");\r\n\t\t});\r\n\t\t\r\n\t\t$('.label-forgot-pass').click(function(e) {\r\n\t\t\t_this.forgotPD(0);\r\n\t\t});\r\n\r\n\t\t$('.tooltip').css({'width':'800px'});\r\n\t}\r\n\t\r\n\ttestBrowser() {\r\n\t\tBrowserDetect.init();\r\n\t\r\n\t\tif (BrowserDetect.version === \"an unknown version\" || \r\n\t\t\t(\r\n\t\t\t\t(BrowserDetect.browser !== 'Chrome' || BrowserDetect.version < 35) \r\n\t\t\t\t&& (BrowserDetect.browser !== 'Firefox' || BrowserDetect.version < 69) \r\n\t\t\t\t&& (BrowserDetect.browser !== 'Explorer' || BrowserDetect.version < 10)\r\n\t\t\t\t&& (BrowserDetect.browser !== 'Mozilla' || BrowserDetect.version < 11)\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\t$('#loginForm').removeAttr('onsubmit');\r\n\t\t\t$('#loginECPForm').removeAttr('onsubmit');\r\n\t\t\t$('#loginBtn').removeAttr('onclick');\r\n\t\t\t$('#loginECPBtn').removeAttr('onclick');\r\n\t\t\t$('#resetBtn').removeAttr('onclick');\r\n\t\t\t$('#loginBtn').hide();\r\n\t\t\t$('#loginECPBtn').hide();\r\n\t\t\t$('#resetBtn').hide();\r\n\t\t\t$('#errmsg').show();\r\n\t\t}\r\n\t\t\t\r\n\t\treturn BrowserDetect.browser+\";\"+BrowserDetect.version+\";\"\r\n\t\t\t\t+BrowserDetect.OS+\";\"+BrowserDetect.mobile;\r\n\t}\r\n\r\n\tlogin(force) {\r\n\t\tthis.whatLanguageNow();\r\n\t\tlet _this = this,\r\n\t\t\twait = this.language == \"KZ\" ? \"Күте тұрыңыз...\" : \"Подождите...\",\r\n\t\t\tenterTheSystem = this.language == \"KZ\" ? \"Жүйеге кіру\" : \"Войти в систему\";\r\n\t\t\t\r\n\t\tif (force || !$('#loginBtn').hasClass('btn-disabled')) {\r\n\t\t\t$('#loginBtn').addClass('btn-disabled').attr(\"disabled\", \"disabled\").html(`<i class=\"icon-refresh icon-white icon-refresh-animate\"></i> ${wait}`);\r\n\r\n\t\t\tlet par = {\r\n\t\t\t\tname: $('#user').val(),\r\n\t\t\t\tpasswd: $('#password').val(),\r\n\t\t\t\tbrowser: this.browser,\r\n\t\t\t\tjson: 1,\r\n\t\t\t\tforce: (force ? 1 : 0),\r\n\t\t\t\tsLogin: (this.sLogin ? 1 : 0),\r\n\t\t\t\trnd: Util.rnd(),\r\n\t\t\t\tlang: this.lang,\r\n\t\t\t\tguid: this.guid\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tUtil.post2(par).then(data => {\r\n\t\t\t\tif (data.result == \"success\") {\r\n\t\t\t\t\tif (data.tempReg) {\r\n\t\t\t\t\t\talert(data.tempReg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\twindow.location.href = _this.contextName + \"/qyzmet/index.jsp?guid=\" + _this.guid + \"&rnd=\" + Util.rnd();\r\n\t\t\t\t} else if (data.passChange == \"1\") {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t$('.login-error-text').text(data.message);\r\n\t\t\t\t\t_this.changePwdDialog(false);\r\n\t\t\t\t}  else if (data.passChange == \"2\") {\r\n\t\t\t\t\t_this.sLogin = true;\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t$('.login-error-text').text(data.message);\r\n\t\t\t\t\t_this.changePwdDialog(false);\r\n\t\t\t\t} else if (data.reconnect == \"1\") {\r\n\t\t\t\t\tif (confirm(data.message)) {\r\n\t\t\t\t\t\t_this.login(true);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#loginBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(enterTheSystem);\r\n\t\t\t\t\t\t$('#resetBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tUtil.alert(data.message);\r\n\t\t\t\t\t$('.login-error-text').text(data.message);\r\n\t\t\t\t\t$('#loginBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(enterTheSystem);\r\n\t\t\t\t\t$('#resetBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tloginECP() {\r\n\t\tthis.whatLanguageNow();\r\n\t\tlet _this = this,\r\n\t\twait = this.language == \"KZ\" ? \"Күте тұрыңыз...\" : \"Подождите...\",\r\n\t\tactionCanceledUser = this.language == \"KZ\" ? \"Әрекетті пайдаланушы жойды\" : \"Действие отменено пользователем\",\r\n\t\tmistakeCode = this.language == \"KZ\" ? \"Қате коды: \" : \"Код ошибки: \",\r\n\t\tmessageForUser = this.language == \"KZ\" ? \" Хабар: \" : \" Сообщение: \",\r\n\t\tselectSertificate = this.language == \"KZ\" ? \"Сертификатты таңдаңыз\" : \"Выбрать сертификат\";\r\n\r\n\r\n\t\tif (!$('#loginEcpBtn').hasClass('btn-disabled')) {\r\n\t\t\t$('.login-error-text').empty();\r\n\t\t\t$('#loginEcpBtn').addClass('btn-disabled').attr(\"disabled\", \"disabled\").html(`<i class=\"icon-refresh icon-white icon-refresh-animate\"></i> ${wait}`);\t\r\n\t\t\t\r\n\t\t\tvar par = {cmd:'getSecret', rnd: Util.rnd(), guid: this.guid, json:1, lang: this.lang};\r\n\r\n\t\t\tUtil.post2(par).then(data => {\r\n\t\t\t\tif (data.secret) {\r\n\t\t\t\t\tlet xml = '<login><secret>' + secret + '</secret></login>';\r\n\t\t\t\t\t_this.ncaLayer.signXml(NCA.COMMON, NCA.AUTH, xml).then(data2 => {\r\n\t\t\t\t\t\tif (data2.responseObject) {\r\n\t\t\t\t\t\t\tlet signedData = data2.responseObject;\r\n\t\t\t\t\t\t\tpar = {\r\n\t\t\t\t\t\t\t\tsecret: data.secret,\r\n\t\t\t\t\t\t\t\tsignedData: signedData,\r\n\t\t\t\t\t\t\t\tbrowser: this.browser,\r\n\t\t\t\t\t\t\t\trnd: Util.rnd(),\r\n\t\t\t\t\t\t\t\tguid: this.guid,\r\n\t\t\t\t\t\t\t\tjson: 1,\r\n\t\t\t\t\t\t\t\tlang: this.lang\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t_this.sendLoginInfo(par);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet error = (data2.message === 'action.canceled')\r\n\t\t\t\t\t\t\t\t? actionCanceledUser\r\n\t\t\t\t\t\t\t\t: mistakeCode + data2.code + messageForUser + data2.message;\r\n\t\t\t\t\t\t\tconsole.error(\"msg text: \" + error);\r\n\t\t\t\t\t\t\t$('.login-error-text').text(error);\r\n\t\t\t\t\t\t\t$('#loginEcpBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(selectSertificate);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, error => {\r\n\t\t\t\t\t\tconsole.error(\"error text: \" + error);\r\n\t\t\t\t\t\t$('.login-error-text').text(error);\r\n\t\t\t\t\t\t$('#loginEcpBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(selectSertificate);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tUtil.alert(data.message);\r\n\t\t\t\t\t$('.login-error-text').text(data.message);\r\n\t\t\t\t\t$('#loginEcpBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(selectSertificate);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tsendLoginInfo(par) {\r\n\t\tthis.whatLanguageNow();\r\n\t\tlet _this = this,\r\n\t\t\tselectSertificate = this.language == \"KZ\" ? \"Сертификатты таңдаңыз\" : \"Выбрать сертификат\";\r\n\r\n\t\tUtil.post2(par).then(data => {\r\n\t\t\tif (data.result == \"success\") {\r\n\t\t\t\tif (data.dl) {\r\n\t\t\t\t\tUtil.alert(data.dl);\r\n\t\t\t\t}\r\n\t\t\t\tif (data.tempReg) {\r\n\t\t\t\t\tUtil.alert(data.tempReg);\r\n\t\t\t\t}\r\n\t\t\t\twindow.location.href = _this.contextName + \"/qyzmet/index.jsp?guid=\" + _this.guid + \"&rnd=\" + Util.rnd();\r\n\t\t\t} else if (data.reconnect == \"1\") {\r\n\t\t\t\tUtil.confirmMessage(data.message, function(e) {\r\n\t\t\t\t\tif (e) {\r\n\t\t\t\t\t\tpar[\"force\"] = 1;\r\n\t\t\t\t\t\t_this.sendLoginInfo(par);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#loginEcpBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(selectSertificate);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tUtil.alert(data.message);\r\n\t\t\t\t$('.login-error-text').text(data.message);\r\n\t\t\t\t$('#loginEcpBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(selectSertificate);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\treset() {\r\n\t\tif (!$('#resetBtn').hasClass('btn-disabled')) {\r\n\t\t\t$('#loginForm')[0].reset();\r\n\t\t\t$('#loginECPForm')[0].reset();\r\n\t\t}\r\n\t}\r\n\t\r\n\tforgotPD(purpose) {\r\n\t\tthis.whatLanguageNow();\r\n\t\tlet _this = this,\r\n\t\t\tenterUserName = this.language == \"KZ\" ? \"Пайдаланушы атын енгізіңіз\" : \"Введите имя пользователя\";\r\n\r\n\t\tvar un = $('#user').val();\r\n\t\tif (un == null || un.length < 1) {\r\n\t\t\tUtil.alert(enterUserName);\r\n\t\t} else {\r\n\t\t\tvar par = {};\r\n\t\t\tpar[\"arg0\"] = $('#user').val();\r\n\t\t\tpar[\"cmd\"] = \"execute\";\r\n\t\t\tpar[\"cls\"] = \"ВСПОМОГАТЕЛЬНЫЙ КЛАСС\";\r\n\t\t\tpar[\"name\"] = \"restoreAccess\";\r\n\t\t\tpar[\"arg1\"] = purpose;\r\n\t\t\tpar[\"json\"] = 1;\r\n\t\t\tpar[\"rnd\"] = Util.rnd();\r\n\t\t\tpar[\"arg2\"] = this.language;\r\n\t\t  \tUtil.post2(par).then(data => {\r\n\t\t\t\tconsole.log(data);\r\n\t\t\t\tlet msg = _this.language == \"KZ\" ? data.msgKz : data.msgRu;\r\n\t\t  \t\tif (purpose == 0 && data.code == 0) {\r\n\t\t  \t\t\tUtil.confirmMessage(msg, function(e) {\r\n\t\t  \t\t\t\tif (e)  \r\n\t\t  \t\t\t\t\t_this.forgotPD(1);\r\n\t\t  \t\t\t});\r\n\t\t  \t\t} else {\r\n\t\t \t\t\tUtil.alert(msg);\r\n\t\t  \t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetContactInfo() {\r\n\t\tthis.whatLanguageNow();\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"cmd\":'contactInfo', \"additionalInfo\": \"true\", \"json\":1};\r\n\t\tlet consultant = this.language == \"KZ\" ? \"Кеңесші\" : \"Консультант\",\r\n\t\t\tsupportService = this.language == \"KZ\" ? \"Қолдау қызметі\" : \"Служба поддержки\",\r\n\t\t\tdownloadCryptoSocket = this.language == \"KZ\" ? \"ЭЦҚ-мен жұмыс істеу үшін бағдарламаны жүктеу және орнату (CryptoSocket, 03.09.2021 жаңартылған)\" : \"Скачать и установить программу для работы с ЭЦП (CryptoSocket, обновлено 03.09.2021)\",\r\n\t\t\tconnectionCryptoSocket = this.language == \"KZ\" ? \"Cryptosocket көмегімен бастапқы қосылымды орнатыңыз\" : \"Установить первичное соединение с CryptoSocket\";\r\n\r\n\t\tUtil.query(par).then(response => {\r\n\t\t\tresponse.json().then(data => {\r\n\t\t\t\tif (data.contacts) {\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t// var table = `<div style=\"overflow: auto;\"><table class=\"contactInfoTable\"><thead><tr><th>${consultant}</th><th>Телефон</th><th>E-mail</th></tr></thead><tbody>`;\r\n\t\t\t\t\tvar table = `<div style=\"overflow: auto;\"><table class=\"contactInfoTable\"><thead><tr><th>Телефон</th><th>E-mail</th></tr></thead><tbody>`;\r\n\t\t\t\t\tfor (var i = 0; i < data.contacts.length; i++) {\r\n\t\t\t\t\t\tvar contact = data.contacts[i];\r\n\t\t\t\t\t\t// var row = \"<tr><td align='center' width='500'>\" + Util.encodeHTML(contact.person) + \"</td><td align='center' width='500'>\" + Util.encodeHTML(contact.telephone) + \"</td><td align='center' width='350'><a href=\\\"mailto:\" + Util.encodeHTML(contact.email) + \"\\\">\" + Util.encodeHTML(contact.email) + \"</a></td></tr>\";\r\n\r\n\t\t\t\t\t\tvar row = \"<tr><td align='center' width='250'>\" + Util.encodeHTML(contact.telephone) + \"</td><td align='center' width='150'><a href=\\\"mailto:\" + Util.encodeHTML(contact.email) + \"\\\">\" + Util.encodeHTML(contact.email) + \"</a></td></tr>\";\r\n\t\t\t\t\t\ttable = table + row;\r\n\t\t\t\t\t}\r\n\t\t\t\t  \ttable = table + \"</tbody></table><div>\";\r\n\t\t\t\t  \t// var content = `<div class=\"help-name\">${supportService}</div><br>` + table;\r\n\t\t\t\t\tvar content = table;\r\n\t\t\t\t  \t$('.tool-help').append($(content));\r\n\t\t\t\t}\r\n\t\t\t\tif (data.additionalInfo) {\r\n\t\t\t\t\t$('.tool-help').append(\"<br><div align='center' width='500' style='font-size: 10pt; font-weight: bold'>\" + Util.encodeHTML(data.additionalInfo) + \"</div>\")\r\n\t\t\t\t}\r\n\t\t  \t\tvar content = `<br><a href=\"${_this.contextName}/jsp/media/files/SetupCSPv6.3_20220903.exe\">${downloadCryptoSocket}</a>`;\r\n\t\t\t\tconsole.log(_this.contextName)\r\n\t\t  \t\t$('.tool-help').append($(content));\r\n\t\t  \t\tvar content = `<br><a href=\"https://localhost:6127/tumarcsp\">${connectionCryptoSocket}</a>`;\r\n\t\t  \t\t$('.tool-help').append($(content));\r\n\t\t  \t\t\r\n\t\t  \t\t$('.label-show-support').tooltip({\r\n\t\t\t\t\tdeltaX: -20,\r\n\t\t\t\t    content: $('.tool-help').html(),\r\n\t\t\t\t    showEvent: 'click',\r\n\t\t\t\t    onPosition: function() {\r\n\t\t\t\t    \t//$(this).tooltip('tip').css('left', $(this).offset().left + $(this).width() - $(this).tooltip('tip').width() - 15);\r\n\t\t\t\t    \t//$(this).tooltip('arrow').css('left', $(this).tooltip('tip').width() - 20);\r\n\t\t\t    \t},\r\n\t\t\t\t    onShow: function(){\r\n\t\t\t\t        var t = $(this);\r\n\t\t\t\t        t.tooltip('tip').unbind().bind('mouseenter', function(){\r\n\t\t\t\t            t.tooltip('show');\r\n\t\t\t\t        }).bind('mouseleave', function() {\r\n\t\t\t\t            t.tooltip('hide');\r\n\t\t\t\t        }).css({\r\n\t\t\t\t        \twidth: '500px'\r\n\t\t\t\t        });\r\n\t\t\t\t    }\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tchangePwdDialog(obligatory) {\r\n\t\tlet _this = this,\r\n\t\t\tchange = this.language == \"KZ\" ? \"Өзгерту\" : \"Изменить\",\r\n\t\t\tpassSuccessFullChanged = this.language == \"KZ\" ? \"Құпия сөз сәтті өзгертілді!\" : \"Пароль успешно изменен!\",\r\n\t\t\tcancelButton = this.language == \"KZ\" ? \"Бас тарту\" : \"Отмена\",\r\n\t\t\tenterTheSystem = this.language == \"KZ\" ? \"Жүйеге кіру\" : \"Войти в систему\",\r\n\t\t\tchangePassword = this.language == \"KZ\" ? \"Құпия сөзді өзгерту\" : \"Смена пароля\";\r\n\r\n\t\tvar dialogId = 'or3_popup';\r\n\t\t$('body').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\r\n\t\tvar buttonOk = {\r\n\t\t\ttext: change,\r\n\t\t\thandler: function() {\r\n\t\t\t\t$(\"#\" + dialogId + \" .dialog-button .l-btn\").linkbutton('disable');\r\n\t\t\t\tvar par = {json: 1, guid: _this.guid, browser: _this.browser, configNumber: 0};\r\n\t    \t\tpar[\"name\"] = $('#user').val();\r\n\t        \tpar[\"passwd\"] = $('#' + dialogId).find('[uid=\"oldPass\"]').val();\r\n\t        \tpar[\"newPass\"] = $('#' + dialogId).find('[uid=\"newPass\"]').val();\r\n\t        \tpar[\"confirmPass\"] = $('#' + dialogId).find('[uid=\"confirmPass\"]').val();\r\n\t    \t\t\r\n\t    \t\tUtil.post2(par).then(data => {\r\n\t        \t\tif (data.result == 'error') {\r\n\t        \t\t\talert(data.message);\r\n\t\t\t\t\t\t$(\"#\" + dialogId + \" .dialog-button .l-btn\").linkbutton('enable');\r\n\t        \t\t} else {\r\n\t        \t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t        \t\t\talert(passSuccessFullChanged);\r\n\t        \t\t\twindow.location.href = _this.contextName + \"/qyzmet/index.jsp?guid=\" + _this.guid + \"&rnd=\" + Util.rnd();\r\n\t        \t\t}\r\n\t    \t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tvar buttonCancel = {\r\n\t\t\ttext: cancelButton,\r\n\t\t\thandler: function() {\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t$('#loginBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(enterTheSystem);\r\n\t\t\t\t$('#resetBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\");\r\n\t\t\t\tif(_this.sLogin){\r\n\t\t\t\t\t_this.login(false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tvar buttons = (obligatory) ? [buttonOk] : [buttonOk, buttonCancel];\r\n\t\t\t\t\r\n\t\t$('#' + dialogId).dialog({\r\n\t\t\ttitle: changePassword,\r\n\t\t\twidth: 300,\r\n\t\t\theight: 200,\r\n\t\t\tclosed: false,\r\n\t\t\tcache: false,\r\n\t\t\tclosable: obligatory != true,\r\n\t\t\thref: _this.contextName + '/qyzmet/pwd.jsp?guid=' + guid + '&rnd=' + Util.rnd(),\r\n\t\t\tmodal: true,\r\n\t\t\tonClose: function() {\r\n\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t$('#loginBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\").html(enterTheSystem);\r\n\t\t\t\t$('#resetBtn').removeClass(\"btn-disabled\").removeAttr(\"disabled\");\r\n\t\t\t},\r\n\t\t\tonBeforeDestroy : function() {\r\n\t\t\t},\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t}\r\n\r\n\twhatLanguageNow() {\r\n\t\tthis.language = localStorage.getItem(\"EkyzmetLanguage\");\r\n\t}\r\n\r\n\tsetLangToolTip(language) {\r\n\t\tlet consultant = language == \"KZ\" ? \"Кеңесші\" : \"Консультант\",\r\n\t\t\tsupportService = language == \"KZ\" ? \"Қолдау қызметі\" : \"Служба поддержки\",\r\n\t\t\tdownloadCryptoSocket = language == \"KZ\" ? \"ЭЦҚ-мен жұмыс істеу үшін бағдарламаны жүктеу және орнату (CryptoSocket, 03.09.2021 жаңартылған)\" : \"Скачать и установить программу для работы с ЭЦП (CryptoSocket, обновлено 03.09.2021)\",\r\n\t\t\tconnectionCryptoSocket = language == \"KZ\" ? \"Cryptosocket көмегімен бастапқы қосылымды орнатыңыз\" : \"Установить первичное соединение с CryptoSocket\";\r\n\r\n\t\t$(\".help-name\").html(supportService);\r\n\t\t$(\".contactInfoTable thead th\").each(function(index) {\r\n\t\t\tif(index == 3) {\r\n\t\t\t\t$(this).html(consultant);\r\n\t\t\t}\r\n\t\t});\r\n\t\t$(\".contactInfoTable tbody tr td\").each(function(index) {\r\n\t\t\tif($(this).html() == \"Служба поддержки\") {\r\n\t\t\t\t$(this).html(supportService)\r\n\t\t\t}\r\n\t\t\tif($(this).html() == \"Қолдау қызметі\") {\r\n\t\t\t\t$(this).html(supportService)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(\".tooltip-content a\").each(function(index) {\r\n\t\t\tif(index == 3) {\r\n\t\t\t\t$(this).html(downloadCryptoSocket);\r\n\t\t\t}\r\n\t\t\tif(index == 4) {\r\n\t\t\t\t$(this).html(connectionCryptoSocket);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tchangeLanguage(lang) {\r\n\t\tthis.lang = lang;\r\n\t\tTranslation.init(lang);\r\n\t}\r\n}","import {DataChecker, Util} from './util.js';\r\nimport {Navigation} from './navigation.js';\r\nimport {InterfaceController} from './ifc.js';\r\nimport {Orders} from './orders.js';\r\nimport {Notifications} from './notifications.js';\r\nimport {Monitor} from './monitor.js';\r\n\r\nimport {Processes} from './processes.js';\r\nimport {Archives} from './archive.js';\r\nimport {Translation} from './translation.js';\r\nimport {EventOps} from './events.js';\r\nimport {Polling} from './polling.js';\r\nimport {Analytic} from './analytic.js';\r\nimport {NCA} from './nca.js';\r\nimport {Ping} from './ping.js';\r\nimport {PersonalPhoto} from './personalPhoto.js';\r\nimport {Autocomplete} from './autocomplete.js';\r\nimport {Help} from './help.js';\r\n\r\nexport class PortletApp {\r\n\t\r\n\tmainUrl = \"\";\r\n\trestUrl = \"\";\r\n\t// создал Жаркын\r\n\tcenterPanelWidth = null;\r\n\tcenterPanelLeft = null;\r\n\tOLAP_URL = \"\";\r\n\ttranslation = null;\r\n\r\n\tconstructor(mainUrl, restUrl, userId, lang) {\r\n\t\tthis.mainUrl = mainUrl;\r\n\t\tthis.restUrl = restUrl;\r\n\t\tthis.userId= userId;\r\n\t\tthis.lang = lang;\r\n\t\tUtil.restUrl = restUrl;\r\n\t\tthis.OLAP_URL = `http://${new URL(document.location.href).host}/analytic/rest/`;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet app = this;\r\n\r\n\t\tTranslation.init(this.lang);\r\n\t\tthis.translation = Translation.translation;\r\n\r\n\t\tthis.polling = new Polling(app);\r\n\t\tthis.polling.longPolling();\r\n\t\t\r\n\t\tlet nav = new Navigation(app);\r\n\t\tthis.nav = nav;\r\n\r\n\t\tthis.analytic = new Analytic(app);\r\n\t\t// this.analytic.getOlapPort();\r\n\r\n\t\tlet ifcController = new InterfaceController(app);\r\n\t\tthis.ifcController = ifcController;\r\n\t\tifcController.init();\r\n\r\n\t\tlet pingClass = new Ping();\r\n\t\tif ($('#ping').length > 0) pingClass.init();\r\n\r\n\t\tlet localStorLanguage = localStorage.getItem(\"EkyzmetLanguage\");\r\n\r\n\t\tif(localStorLanguage) {\r\n\t\t\tlet tempLang = $('#topLangKz').hasClass(\"selected\") ? \"KZ\" : \"RU\";\r\n\r\n\t\t\tif(localStorLanguage !== tempLang) {\r\n\t\t\t\tifcController.changeInterfaceLang(localStorLanguage, event)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.monitor = new Monitor(app);\r\n\t\tthis.monitor.init();\r\n\t\t\r\n\t\tlet orders = new Orders(app);\r\n\t\tthis.orders = orders;\r\n\t\tthis.orders.init();\r\n\t\t\r\n\t\tlet notifications = new Notifications(app);\r\n\t\tthis.notifications = notifications;\r\n\t\tthis.notifications.init();\r\n\r\n\t\tlet processes = new Processes(app);\r\n\t\tthis.processes = processes;\r\n\t\tthis.processes.init();\r\n\t\t\r\n\t\tlet archives = new Archives(app);\r\n\t\tthis.archives = archives;\r\n\t\tthis.archives.init();\r\n\r\n\t\tthis.help = new Help(app);\r\n\t\tthis.help.init();\r\n\t\t\r\n\t\tthis.ncaLayer = new NCA();\r\n\t\t\r\n\t\tlet photo = new PersonalPhoto(app);\r\n\t\tphoto.initProfile(app.userId);\r\n\t\t$(\"#change-my-photo\").on(\"click\", function() {\r\n\t\t\tphoto.uploadYourImage();\r\n\t\t});\r\n\t\t\r\n\t\t$(\"#delete-my-photo\").on(\"click\", function() {\r\n\t\t\tphoto.deleteImage();\r\n\t\t});\r\n\t\t\r\n\t\t$(\"#take-photo-from-sys\").on(\"click\", function() {\r\n\t\t\tphoto.copyImageFromData();\r\n\t\t});\r\n\t\tEventOps.init(this);\r\n\r\n\t\t$(window).on('hashchange', function() {\r\n\t\t\tvar day = location.hash;\r\n\t\t\tnav.hashChanged(day);\r\n\t\t});\r\n\t\tnav.hashChanged(location.hash);\r\n\r\n\t\t$(document).ready(function() {\r\n\t\t\tlet par = {\"sfunc\":1,\"cls\":\"MainPage\",\"name\":\"otherMethods\", \"arg0\":app.userId, \"arg1\": \"getPoruchWidth\"};\r\n\t\t\tapp.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n      \t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\t\tif(json.width == 1) {\r\n\t\t\t\t\t\t\tapp.pushAside();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '.order-type', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tif (jThis.hasClass('order-type-selected')) {\r\n\t\t\t\tconsole.log('no change');\r\n\t\t\t} else {\r\n\t\t\t\tvar type = jThis.attr('code');\r\n\t\t\t\tlocation.hash = 'orders=' + (type ? type : 'all');\r\n\t\t\t}\r\n\t\t    return false;\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '.order-block .title', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tif (jThis.attr('type') === 'out')\r\n\t\t\t\tnav.openOrder(null, jThis.attr('iuid'), jThis.attr('iter'), false);\r\n\t\t\telse\r\n\t\t\t\tnav.openOrder(jThis.attr('iter'), jThis.attr('proc'), jThis.attr('uid'), jThis.attr('type') !== 'my');\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '.collapse-portlet', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tif (jThis.hasClass('icon-arrows-up')) {\r\n\t\t\t\tjThis.parents('.portlet').find('.portletBody').hide();\r\n\t\t\t\tjThis.parents('.portlet').parent().css({\r\n\t\t\t\t\t\"flex-basis\": \"content\",\r\n\t\t\t\t\t\"flex-grow\": \"0\"\r\n\t\t\t\t});\r\n\t\t\t\tjThis.addClass('icon-arrows-down').removeClass('icon-arrows-up');\r\n\t\t\t} else {\r\n\t\t\t\tjThis.addClass('icon-arrows-up').removeClass('icon-arrows-down');\r\n\t\t\t\tjThis.parents('.portlet').parent().css({\r\n\t\t\t\t\t\"flex-basis\": \"\",\r\n\t\t\t\t\t\"flex-grow\": \"\"\r\n\t\t\t\t});\r\n\t\t\t\tjThis.parents('.portlet').find('.portletBody').show();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$('.user-info').tooltip({\r\n\t\t\tdeltaX: -20,\r\n\t\t    content: $('.popup_user_menu').html(),\r\n\t\t    showEvent: 'click',\r\n\t\t    onUpdate: function(content){\r\n\t\t    },\r\n\t\t    onPosition: function() {\r\n\t\t    \t$(this).tooltip('tip').css('left', $(this).offset().left + $(this).width() - $(this).tooltip('tip').width() - 15);\r\n\t\t    \t$(this).tooltip('arrow').css('left', $(this).tooltip('tip').width() - 20);\r\n\t    \t},\r\n\t\t    onShow: function(){\r\n\t\t        var t = $(this);\r\n\t\t        t.tooltip('tip').unbind().bind('mouseenter', function(){\r\n\t\t            t.tooltip('show');\r\n\t\t        }).bind('mouseleave', function() {\r\n\t\t            t.tooltip('hide');\r\n\t\t        });\r\n\t\t    }\r\n\t\t});\r\n\t\t\r\n\t\tkey('ctrl+shift+z', function() {\r\n\t\t\tvar str = \"\";\r\n\t\t\t$('[data-uid]').each(function(i, p) {\r\n\t\t\t\tif (($(this).closest('.popUpPanContent').length == 0))\r\n\t\t\t\t\tstr += $(this).attr('data-uid') + \"\\n\";\r\n\t\t\t});\r\n\t\t\tUtil.alert(str);\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tdocument.addEventListener(\"click\", function(e) {\r\n\t\t\tlet arr = ['popUpPan', \"popUpPanContent\", \"combo-p\", \"window-body\", \"panel-header\", \"dialog-button\", \"messager-window\", \"calendar-day\"];\r\n\t\t\tlet bool = false;\r\n\t\t\tfor(let nameClass of arr) {\r\n\t\t\t\tif(e.target.closest(\".\" + nameClass)) {\r\n\t\t\t\t\tbool = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!bool) {\r\n\t\t\t\tapp.hidePopUpPanContent();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.loadPortletsContent();\r\n\t\t\r\n\t\tAutocomplete.autocomplete(document.getElementById(\"privateDeal\"));\r\n\t}\r\n\t\r\n\tloadPortletsContent() {\r\n\t\tlet app = this;\r\n\t\t$(\".portlet, .widget\").each(function(i) {\r\n\t\t\tvar portlet = $(this);\r\n\t\t\tvar clsName = portlet.attr('cls');\r\n\t\t\tvar methodName = portlet.attr('method');\r\n\t\t\t\r\n\t\t\tapp.loadPortletContent(clsName, methodName);\r\n\t\t});\r\n\t}\r\n\t\r\n\tloadPortletContent(clsName, methodName, arg=\"\") { \r\n\t\t// arg - передовать объект с аргументами {\"arg1\": \"text1\", \"arg2\":\"text2\"}. Можно и не передовать\r\n\t\tif (clsName && methodName) {\r\n\t\t\tif(arg !== \"\") {\r\n\t\t\t\tlet mainSettings = {\"sfunc\":1,\"cls\":clsName,\"name\":methodName, \"arg0\":this.userId};\r\n\t\t\t\tvar par = {...mainSettings, ...arg};\r\n\t\t\t} else {\r\n\t\t\t\tvar par = {\"sfunc\":1,\"cls\":clsName,\"name\":methodName, \"arg0\":this.userId};\r\n\t\t\t}\r\n\r\n\t\t\tthis.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n      \t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\t\tthis.parsePortletContent(json);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tparsePortletContent(json) {\r\n\t\tif (json) {\r\n\t\t\tDataChecker.checkData(json).then(res => {\r\n\t\t\t\tif (res.portletId) {\r\n\t\t\t\t\tvar div = $('#' + res.portletId);\r\n\t\t\t\t\tif (div.length > 0) {\r\n\t\t\t\t\t\tif (res.title) {\r\n\t\t\t\t\t\t\t\t$('#' + res.portletId + ' .portletTitle span').html(res.title);\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// здесь код поменял Жаркын, чтобы узнать на каком языке показывать текст =========\r\n\t\t\t\t\t\t\tif($('#topLangKz').hasClass(\"selected\")) {\r\n\t\t\t\t\t\t\t\t$('#' + res.portletId + ' .portletTitle span').html(res.titleKz);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$('#' + res.portletId + ' .portletTitle span').html(res.titleRu);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// ==========================================\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (div.find('.portletBody').length > 0)\r\n\t\t\t\t\t\t\tthis.parseContentByType(res, div.find('.portletBody'));\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tthis.parseContent(res, div);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tparseContent(res, div) {\r\n\t\t// здесь код изменил Жаркын, чтобы выбрать язык\r\n\t\tif(!res.title) {\r\n\t\t\tif($('#topLangKz').hasClass(\"selected\")) {\r\n\t\t\t\tres.title = res.titleKz;\r\n\t\t\t\tres.value = res.valueKz;\r\n\t\t\t} else {\r\n\t\t\t\tres.title = res.titleRu;\r\n\t\t\t\tres.value = res.valueRu;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar html = '<img class=\"widget-img\" src=\"css/img/' + res.image + '\" /><div class=\"vert\">';\r\n\t\thtml += '<span class=\"widget-title\">' + res.title + '</span>';\r\n\t\thtml += '<span class=\"widget-value\">' + res.value + '</span></div>';\r\n\t\tdiv.append($(html));\r\n\t}\r\n\t\r\n\tparseContentByType(res, div) {\r\n\t\tlet app = this;\r\n\t\t\r\n\t\t// здесь код изменил Жаркын, чтобы выбрать язык\r\n\t\tif(!res.content) {\r\n\t\t\tres.content = $('#topLangKz').hasClass(\"selected\") ? res.contentKz : res.contentRu;\r\n\t\t}\r\n\t\tif (res.contentType == 'startProcess') {\r\n\t\t\t$.each(res.content, function(i, content) {\r\n\t\t\t\tvar html = '<div class=\"process\" uid=\"' + content.uid + '\">';\r\n\t\t\t\thtml += '<i class=\"icon-left icon-' + content.icon + '\"/>';\r\n\t\t\t\thtml += '<span>' + content.title + '</span>';\r\n\t\t\t\thtml += '<i class=\"icon-right icon-arrow-right\" />';\r\n\t\t\t\thtml += '</div>';\r\n\t\t\t\tdiv.append($(html));\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (res.contentType == 'openIfc') {\r\n\t\t\t$.each(res.content, function(i, content) {\r\n\t\t\t\tvar html = '<div class=\"ifc\">';\r\n\t\t\t\thtml += app.parseJSONContent(content, 'ifc');\r\n\t\t\t\thtml += '</div>';\r\n\t\t\t\tdiv.append($(html));\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (res.contentType == 'orders') {\r\n\t\t\tlet params = Util.parseHash(encodeURI(location.hash));\r\n\t\t\tlet tabSelected = params.orders ? params.orders : null;\r\n\t\t\r\n\t\t\tvar html = '<div class=\"orders\">';\r\n\t\t\thtml += '<div class=\"order-types\">';\r\n\t\t\t\r\n\t\t\tvar counts = {};\r\n\t\t\tvar ordersDivs = {};\r\n\t\t\t\r\n\t\t\t$.each(res.types, function(i, type) {\r\n\t\t\t\tvar isSelected = (tabSelected) ? (type.code == tabSelected) : (type.selected != null && type.selected != undefined);\r\n\t\t\t\thtml += '<span class=\"order-type' + (isSelected ? ' order-type-selected' : '') + '\"' \r\n\t\t\t\t\t\t+ ((type.code) ? ' code=\"' + type.code + '\"' : '') \r\n\t\t\t\t\t\t+ '>';\r\n\t\t\t\tif (type.code)\r\n\t\t\t\t\tcounts[type.code] = 0;\r\n\t\t\t\telse\r\n\t\t\t\t\tcounts.all = 0;\r\n\t\t\t\thtml += type.title;\r\n\t\t\t\thtml += '<span class=\"order-count\">';\r\n\t\t\t\thtml += '</span>';\r\n\t\t\t\thtml += '</span>';\r\n\t\t\t\t\r\n\t\t\t\tordersDivs[type.code] =  '<div class=\"order-blocks orders-' + type.code + (isSelected ? ' order-blocks-selected\"' : '\" style=\"display: none;\"')\r\n\t\t\t\t\t\t+ ((type.code) ? ' code=\"' + type.code + '\"' : '') \r\n\t\t\t\t\t\t+ '>';\r\n\t\t\t});\r\n\t\t\t// здесь код поменял Жаркын 24.01.2023, создал кнопку, чтобы задачи расскрыть на всю страницу\r\n\t\t\tlet language = \"ru\";\r\n\t\t\t$('#topLangKz').hasClass(\"selected\") ? language = \"kz\" : language = \"ru\";\r\n\t\t\tlet hint = language === \"kz\" ? \"Кеңейту\" : \"Расширить\";\r\n\t\t\thtml += `<button class=\"tasksFullWidth\" title=\"${hint}\">&hoarr;</button>`; // только эти строки добавил\r\n\r\n\t\t\thtml += '</div>';\r\n\t\t\t$.each(res.content, function(i, content) {\r\n\t\t\t\tif (content.type) {\r\n\t\t\t\t\tordersDivs[content.type] += '<div uid=\"' + content.uid + '\" class=\"order-block\" type=\"' + content.type + '\">';\r\n\t\t\t\t\tif (content.type == 'my')\r\n\t\t\t\t\t\tordersDivs[content.type] += '<i class=\"delete-order icon-close\" task=\"' + content.proc + '\"/>';\r\n\t\t\t\t\t\r\n\t\t\t\t\tordersDivs[content.type] += app.parseJSONContent(content, 'order');\r\n\t\t\t\t\tordersDivs[content.type] += '</div>';\r\n\t\t\t\t\tcounts[content.type]++;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tcounts.all++;\r\n\t\t\t});\r\n\t\t\t$.each(res.types, function(i, type) {\r\n\t\t\t\tordersDivs[type.code] += '</div>';\r\n\t\t\t\thtml += ordersDivs[type.code];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\thtml += '</div>';\r\n\t\t\tdiv.append($(html));\r\n\t\t\t\r\n\t\t\t$('.tasksFullWidth').on('click', function() {\r\n\t\t\t\tapp.pushAside();\r\n\t\t\t});  // и здесь\r\n\r\n\t\t\t$.each(counts, function(type, count) {\r\n\t\t\t\tif (type === 'all')\r\n\t\t\t\t\tdiv.find('.order-type:not([code]) .order-count').html(count);\r\n\t\t\t\telse\r\n\t\t\t\t\tdiv.find('.order-type[code=' + type + '] .order-count').html(count);\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (res.contentType == 'chart') {\r\n\t\t\tvar canvas = $('<canvas id=\"myChart\" width=\"100%\" height=\"100%\"></canvas>');\r\n\t\t\tdiv.append(canvas);\r\n\t\t\t\r\n\t\t\tvar scales = res.scales ? res.scales : {\r\n\t\t\t\tr: {\r\n\t\t\t\t\tbeginAtZero: true,\r\n\t\t\t\t\tmin: 0,\r\n\t\t\t        max: 5,\r\n\t\t\t\t\tautoSkip: false,\r\n\t\t\t        stepSize: 1\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// здесь код поменял Жаркын для выбора языка паутины\r\n\t\t\tres.data = $('#topLangKz').hasClass(\"selected\") ? res.dataKz : res.dataRu;\r\n\r\n\t\t\tconst myChart = new Chart(canvas, {\r\n\t    \t\ttype: res.chartType,\r\n\t    \t\tdata: res.data,\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tmaintainAspectRatio: false,\r\n\t\t\t\t\telements: {\r\n\t\t\t\t    \tline: {\r\n\t\t\t\t        \tborderWidth: 3\r\n\t\t\t\t      \t}\r\n\t\t\t\t    },\r\n\t\t\t\t\tscales: scales,\r\n\t\t\t\t\tplugins: {\r\n\t\t\t\t\t\tlegend: {\r\n\t\t\t\t\t\t\tposition: 'bottom'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tparseJSONContent(json, contentType) {\r\n\t\tvar res = \"\";\r\n\t\tlet orderStatus = [\"label-success\", \"label-warning\", \"label-important\", \"label-info\"];\r\n\t\t// здесь код изменил Жаркын, чтобы выбрать язык\r\n\t\tlet lang = \"ru\";\r\n\t\tlang = $('#topLangKz').hasClass(\"selected\") ? \"kz\" : \"ru\";\r\n\t\t\r\n\t\tfor (var tag in json) {\r\n\t\t\tif (tag === 'line') {\r\n\t\t\t\tres += '<div class=\"content-row\">';\r\n\t\t\t\tres += this.parseJSONContent(json[tag], contentType);\r\n\t\t\t\tif (json.ctrl) {\r\n\t\t\t\t\tlet textTitle = lang == \"kz\" ? \"Орындау мерзімі\" : \"Срок исполнения\";\r\n\t\t\t\t\tres += `<div class=\"order-deadline ${orderStatus[json.status]}\" title=\"${textTitle}\">${json.ctrl}</div>`;\r\n\t\t\t\t} \r\n\t\t\t\tres += '</div>';\r\n\t\t\t} else if (tag === 'col') {\r\n\t\t\t\tres += '<div class=\"content-column\">';\r\n\t\t\t\tres += this.parseJSONContent(json[tag], contentType);\r\n\t\t\t\tres += '</div>';\r\n\t\t\t} else if (tag === 'views') {\r\n\t\t\t\tres += '<span class=\"views\"><i class=\"icon-eye-opened\"/>' + json.views + '</span>';\r\n\t\t\t} else if (tag === 'image') {\r\n\t\t\t\tres += '<span class=\"content-image\"><img src=\"' + (json.image.length > 0 ? json.image : 'css/img/empty-avatar-30.png') + '\" /></span>';\r\n\t\t\t} else if (tag === 'typeIcon') {\r\n\t\t\t\t// res += '<i class=\"icon-type icon-type-' + json.typeIcon + '\"/>';\r\n\t\t\t} else if (tag === 'location') {\r\n\t\t\t\tres += '<span class=\"location\"><i class=\"icon-location\"/>' + json.location + '</span>';\r\n\t\t\t} else if (tag === 'linkRu') {\r\n\t\t\t\tif(!json.link) {json.link = lang == \"kz\" ? json.linkKz : json.linkRu;}\r\n\t\t\t\tres += '<a class=\"link\" onclick=\"javascript:openIfc(\\'' + json.ifc + '\\', \\'' + json.obj + '\\')\">' + json.link + '</a>';\r\n\t\t\t} else if (contentType === 'order' && tag === 'title') {\r\n\t\t\t\tlet iuidHtml = (json.line && json.line.col && json.line.col.iuid) ? ('\" iuid=\"' + json.line.col.iuid) : '';\r\n\t\t\t\tlet orderColor = \"\";\r\n\t\t\t\tif(json.type == \"in\" || json.type == \"out\") {\r\n\t\t\t\t\torderColor = json.status == 0 ? \"#468847\" : json.status == 1 ? \"#F89406\" : \"#E05540\";\r\n\t\t\t\t}\r\n\t\t\t\tres += '<span class=\"title\" style=\"color:' + orderColor + ';\" iter=\"' + json.iter + '\" proc=\"' + json.proc + '\" uid=\"' + json.uid + iuidHtml + '\" type=\"' + json.type + '\">' + json.title + '</span>';\r\n\t\t\t} else if (tag !== 'uid' && tag !== 'ifc' && tag !== 'obj' && tag !== 'type' && tag !== 'proc'  && tag !== 'iter' && tag !== 'linkKz' && tag !== \"status\" && tag !== \"ctrl\") {\r\n\t\t\t\tres += '<span class=\"' + tag + '\">' + json[tag] + '</span>';\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tquery(params) {\r\n\t\tlet url = (params.cmd) ? (this.restUrl + '&cmd=' + params.cmd) : this.restUrl;\r\n\t\treturn fetch(url, {\r\n\t\t\tmethod: 'POST',\r\n\t    \tcredentials: 'include',\r\n\t\t\tbody: $.param(params)\r\n\t    });\r\n\t}\r\n\t\r\n\tpost(par) {\r\n\t\tlet _this = this; \r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t_this.query(par).then(response => {\r\n\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tlogout() {\r\n\t\tlet _this = this;\r\n\t\t_this.ifcController.forseSaveChanges().then(data => {\r\n\t\t\t//if (confirm('Вы действительно хотите выйти из Системы?')) { #1532\r\n\t\t\tlet par = {\"cmd\":\"ext\", \"json\":1};\r\n\t\t\t_this.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\twindow.location.href = _this.mainUrl + \"/qyzmet/login.jsp?rnd=\" + Util.rnd();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t//}\r\n\t\t});\r\n\t}\r\n\r\n\tresize(selector) {\r\n\t\tlet app = this;\r\n\t\tvar comp = $(selector);\r\n\t\t\r\n\t\tif (comp.is(\":visible\")) {\r\n\t\t\tif (comp.hasClass('easyui-panel')) {\r\n\t\t\t\tcomp.panel();\r\n\t\t\t\tcomp.panel('resize');\r\n\t\t\t} else if (comp.hasClass('easyui-tabs'))\r\n\t\t\t\tcomp.tabs('resize');\r\n\t\t\t\r\n\t\t\t$.each(comp.children(), function(i, child) {\r\n\t\t\t\tapp.resize(child);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tresizeHeight() {\r\n\t\tvar c = $('#ui-panel').layout();\r\n\t\tvar pc = c.layout('panel','center');\t\t\t\t// панель интерфейса\r\n\t\tvar pn = c.layout('panel','north');\t\t\t\t\t// панель заголовка, крошек и тулбар\r\n\t\t\r\n\t\tpn.panel('resize', {height:'auto'});\t\t\t\t// подогнать высоту\r\n\t\tvar newHeight = pn.panel('panel').outerHeight();\t// считать новую высоту\r\n\t\tpc.height(c.height() - newHeight);\t\t\t\t\t// уменьшить высоту панели интерфейса\r\n\t\t\r\n\t\tpc.panel('move',{\t\t\t\t\t\t\t\t\t// и сместить ее\r\n\t\t\tleft: 0,\r\n\t\t\ttop: newHeight\r\n\t\t});\r\n\t\r\n\t\t$('#ui-panel .easyui-panel:not(.tamur-tabs)').panel();\t\t\t\t\t\t\t// пересчитать высоты в интерфейсе\r\n\t}\r\n\r\n\tpushAside() {\r\n\t\tlet this_ = this;\r\n\t\t// метод создал Жаркын, чтобы при нажатии кнопки(рядом с входящими), входящие открылись на полную\r\n\t\tlet language = \"ru\";\r\n\t\t$('#topLangKz').hasClass(\"selected\") ? language = \"kz\" : language = \"ru\";\r\n\t\tlet hint = language === \"kz\" ? \"Кеңейту\" : \"Расширить\";\r\n\t\tlet hint2 = language === \"kz\" ? \"Кішірейту\" : \"Уменьшить\";\r\n\r\n\t\tlet centerPanel = $(\"#orders\").parent().parent().parent(),\r\n\t\t\tbigWidth = centerPanel.parent().width(), //1200px\r\n\t\t\tcenterPanelWidth = centerPanel.width(), // 550px\r\n\t\t\tfirstChild = centerPanel.children(\":first\"),\r\n\t\t\tneighborAbove = centerPanel.prev(),\r\n\t\t\tneighborBelow = centerPanel.next();\r\n\r\n\t\tif(centerPanel.position().left !== 0) {\r\n\t\t\tthis.centerPanelLeft = centerPanel.position().left;\r\n\t\t\tthis.centerPanelWidth = centerPanelWidth;\r\n\t\t}\r\n\t\t\r\n\t\tlet l = this.centerPanelLeft,\r\n\t\t\tw = this.centerPanelWidth,\r\n\t\t\tsecond = 500;\r\n\t\r\n\t\tlet bigOrLittle = centerPanel.position().left == 0 ? true : false;\r\n\r\n\t\tif(bigOrLittle) {\r\n\t\t\tcenterPanel.fadeOut(second, function() {\r\n\t\t\t\tfirstChild.width(w);\r\n\t\t\t\t$(this).width(w);\r\n\t\t\t\t$(this).css({\"left\": `${l}px`});\r\n\t\t\t\t$(this).fadeIn(second);\r\n\t\t\t\tneighborAbove.fadeIn(second);\r\n\t\t\t\tneighborBelow.fadeIn(second);\t\r\n\r\n\t\t\t\tif(!$(this).hasClass(\"panel\")) {\r\n\t\t\t\t\t$(this).addClass(\"panel\");\r\n\t\t\t\t}\r\n\t\t\t\t$(\".tasksFullWidth\").attr('title', hint).html(\"&hoarr;\");\r\n\t\t\t});\r\n\r\n\t\t\tthis_.loadPortletContent(\"MainPage\", \"otherMethods\", {\r\n\t\t\t\t\"arg1\": \"setPoruchWidth\",\r\n\t\t\t\t\"arg2\":\"0\"\r\n\t\t\t})\r\n\r\n\t\t} else {\r\n\t\t\tneighborAbove.fadeOut(second);\r\n\t\t\tneighborBelow.fadeOut(second);\r\n\r\n\t\t\tcenterPanel.fadeOut(second, function() {\r\n\t\t\t\tfirstChild.width(bigWidth);\r\n\t\t\t\t$(this).width(bigWidth);\r\n\t\t\t\t$(this).css({\"left\": \"0px\"});\r\n\t\t\t\t$(this).fadeIn(second);\r\n\r\n\t\t\t\tif($(this).hasClass(\"panel\")) {\r\n\t\t\t\t\t$(this).removeClass(\"panel\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(\".tasksFullWidth\").attr('title', hint2).html(\"&roarr;\");\r\n\t\t\t});\r\n\r\n\t\t\tthis_.loadPortletContent(\"MainPage\", \"otherMethods\", {\r\n\t\t\t\t\"arg1\": \"setPoruchWidth\",\r\n\t\t\t\t\"arg2\":\"1\"\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\thidePopUpPanContent() {\r\n\t\t$(\".popUpPanContent\").each(function() {\r\n\t\t\tif($(this).css(\"display\") && $(this).css(\"display\") != \"none\") {\r\n\t\t\t\t$(this).fadeOut();\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}","import {Util, DataChecker} from './util.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class Monitor {\r\n\t\r\n\tstates = [\"state-green\", \"state-yellow\", \"state-red\"];\r\n\tstatesColor = [\"#468847\", \"#F89406\", \"#E05540\"];\r\n\tmonitorPageSize = 100;\r\n\tcurrentPageNumber = 1;\r\n\ttotal = 0;\r\n\t\r\n\tmonitorSearch = 0;\r\n\ttasksLoaded = false;\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet this_ = this;\r\n\t\t\r\n\t\tthis.loadTasksCount().then(data => {\r\n\t\t\tthis_.loadTasksContent();\r\n\t\t});\r\n\t\t\t\t\r\n\t\t$(\"body\").on('click', '.task-line .task-title', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tlet op = jThis.attr('op');\r\n\t\t\t\r\n\t\t\tif (op == \"1\")\r\n\t\t\t\tdocument.location.hash = \"#cmd=openTask&mnt=1&uid=\" + jThis.attr('uid');\r\n\t\t\telse if (op == \"2\")\r\n\t\t\t\tUtil.alert(Translation.translation['procPerformedMessage'], Util.WARNING);\r\n\t\t\telse if (op == \"3\")\r\n\t\t\t\tUtil.alert(Translation.translation['rptGenerateMessage'], Util.WARNING);\r\n\t\t\telse\r\n\t\t\t\tUtil.alert(Translation.translation['ifcNotExistMessage'], Util.WARNING);\r\n\t\t\t\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '.task-line .icon-close', function() {\r\n\t\t\tlet task = $(this).parent();\r\n\t\t\tthis_.killTask(task.attr('id'));\r\n\t\t});\r\n\t\t\r\n\t\t$(\"#monitor-panel\").on('keyup', \"#monitor-search-text\", function(event) {\r\n\t\t\tif(event.keyCode == 13){\r\n\t\t\t\tthis_.loadTasksContent(true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tloadTasksContent() {\r\n\t\tlet this_ = this;\r\n\t\r\n\t\t$('#monitor-pager').pagination({\r\n\t\t    pageSize: this_.monitorPageSize,\r\n\t\t    total: this_.total,\r\n\t\t    pageNumber: 1,\r\n\t\t    pageList: [100, 200, 500, 1000],\r\n\t\t\tlayout:['list','sep','first','prev','sep','links','sep','next','last','refresh','sep','manual'],\r\n\t\t    showPageList: true,\r\n\t\r\n\t\t\tonSelectPage:function(pageNumber, pageSize){\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\t$(this).pagination('loading');\r\n\t\t\t\t\r\n\t\t\t\tthis_.currentPageNumber = pageNumber;\r\n\t\t\t\tthis_.monitorPageSize = pageSize;\r\n\t\t\t\t\r\n\t\t\t\tthis_.loadTasks();\r\n\t\t\t\t\r\n\t\t\t\t$(this).pagination('loaded');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$('#monitor-pager').pagination('select');\r\n\t\tthis_.tasksLoaded = true;\r\n\t}\r\n\t\t\r\n\tloadTasksCount() {\r\n\t\tlet _this = this; \r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t_this.app.post({cmd: \"getTasksCount\"}).then(data => {\r\n\t\t\t\t_this.setTasksCount(data.message);\r\n\t\t\t\tresolve(data);\r\n\t\t\t});\t\r\n\t\t});\r\n\t}\r\n\t\r\n\tsetTasksCount(count) {\r\n\t\tthis.total = count;\r\n\t\t$('#monitor-total-counter').text(count);\r\n\t\r\n\t\tif (this.tasksLoaded) {\r\n\t\t\t$('#monitor-pager').pagination('refresh', {\r\n\t\t\t\ttotal: count\r\n\t\t\t});\r\n\t\t}\r\n\t}\t\r\n\t\r\n\tloadTasks() {\r\n\t\tlet this_ = this;\r\n\t\t\r\n\t\tvar end = 0;\r\n\t\tif (this_.total == 0)\r\n\t\t\tend = this_.monitorPageSize;\r\n\t\telse if (this_.total <= this_.currentPageNumber * this_.monitorPageSize)\r\n\t\t\tend = this_.total\r\n\t\telse\r\n\t\t\tend = this_.currentPageNumber * this_.monitorPageSize;\r\n\t\t\r\n\t\t\t\t\r\n\t\tvar par = {\"cmd\" : \"loadTasks\", \"rowFirst\": (this_.currentPageNumber-1) * this_.monitorPageSize, \r\n\t\t\t\"rowLast\": end};\r\n\t\t\t\r\n\t\tvar searchText = $('#monitor-search-text').val();\r\n\t\tif (searchText && searchText.length > 0) {\r\n\t\t\tpar[\"searchText\"] = searchText;\r\n\t\t}\r\n\r\n\t\tthis.app.post(par).then(data => {\r\n\r\n\t\t\tthis_.setTasksCount(data.tasksCount);\r\n\r\n\t\t\tvar processList = data.processes;\r\n\t\t\tprocessList.reverse();\r\n\t\t\t\r\n\t\t\t$('#monitor-panel .monitor-table .pcontent').empty();\r\n\t\t\t\r\n\t\t\t$.each(processList, function(i, o) {\r\n\t\t\t\t$.each(o, function(key, task) {\r\n\t\t\t\t\t$('#monitor-panel .monitor-table .pcontent').append(this_.makeTask(key, task));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$('body').unblock();\r\n\t\t});\r\n\t}\r\n\t\r\n\tmakeTask(key, task) {\r\n\t\tlet this_ = this;\r\n\t\tvar orderDiv = $(\"<div class='task-line'></div>\").attr('id', key);\r\n\r\n\t\torderDiv.append('<div class=\"task-condition ' + this.states[task.c2] + '\"></div>');\r\n\t\t\r\n\t\tvar col1Div = $(\"<div class='task-col'></div>\");\r\n\t\tvar authorDiv = $(\"<div class='task-author'></div>\").text(task.i);\r\n\t\tvar dateDiv = $(\"<div class='task-date'></div>\").text(task.d);\r\n\t\tcol1Div.append(authorDiv).append(dateDiv);\r\n\t\t\r\n\t\tvar col2Div = $(\"<div class='task-col'></div>\");\r\n\t\tvar pretitleDiv = $(\"<div class='task-pretitle'></div>\").text(task.t);\r\n\t\tvar titleDiv = $(\"<div class='task-title'></div>\").text(task.p)\r\n\t\t\t.attr('uid', key).attr('op', task.op).css({\"color\" : this_.statesColor[task.c2]});\r\n\t\tvar descDiv = $(\"<div class='task-desc'></div>\").text(task.o);\r\n\t\tcol2Div.append(pretitleDiv).append(titleDiv).append(descDiv);\r\n\t\t\t\r\n\t\torderDiv.append(col1Div);\r\n\t\torderDiv.append('<div class=\"task-delimeter\"></div>');\r\n\t\torderDiv.append(col2Div);\r\n\t\t\r\n\t\tif (task.k == 1) {\r\n\t\t\tvar closeDiv = $('<i class=\"icon icon-close\"></i>');\r\n\t\t\torderDiv.append(closeDiv);\r\n\t\t}\r\n\t\t\r\n\t\treturn orderDiv;\r\n\t}\r\n\t\r\n\tkillTask(flowId) {\r\n\t\tUtil.blockPage(Translation.translation['deleting']);\r\n\t\tvar par = {cmd: \"kill\", id: flowId};\r\n\t\tthis.app.query(par).then(() => {\r\n//\t\t\t$('body').unblock();\r\n\t\t});\r\n\t}\r\n\t\r\n\tdeleteTask(flowId) {\r\n\t\tlet _this = this;\r\n\t\tif (this.total > -1) {\r\n\t\t\t$('#monitor-panel .monitor-table .pcontent #' + flowId).remove();\r\n\t\t\t$('body').unblock();\r\n\t\t\t\r\n\t\t\t_this.setTasksCount(_this.total - 1);\r\n\t\t}\r\n\t}\r\n\t\r\n\taddTask(process) {\r\n\t\tlet _this = this; \r\n\t\tif (this.total > -1) {\r\n\t\t\tvar oldCount = this.total;\r\n\t\t\t$.each(process, function(key, task) {\r\n\t\t\t\t$('#monitor-panel .monitor-table .pcontent').prepend(_this.makeTask(key, task));\r\n\t\t\t\toldCount++;\r\n\t\t\t});\r\n\t\t\tthis.setTasksCount(oldCount);\r\n\t\t}\r\n\t\tvar search = $('#monitor-search-text');\r\n\t\tif (search && search.val() && search.val().length > 0) { \r\n\t\t\t_this.filterBySearchText(search.val());\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateTask(process) {\r\n\t\tlet _this = this;\r\n\t\t$.each(process, function(key, task) {\r\n\t\t\tvar html = _this.makeTask(key, task);\r\n\t\t\tif ($('#monitor-panel .monitor-table .pcontent .task-line[id=\"' + key + '\"]').length > 0)\r\n\t\t\t\t$('#monitor-panel .monitor-table .pcontent .task-line[id=\"' + key + '\"]').replaceWith(html);\r\n\t\t});\r\n\t\tvar search = $('#monitor-search-text');\r\n\t\tif (search && search.val() && search.val().length > 0) { \r\n\t\t\t_this.filterBySearchText(search.val());\r\n\t\t}\r\n\t}\r\n\t\r\n\tfilterBySearchText(search){\r\n\t\tlet all = $('#monitor-panel .monitor-table .pcontent').find('.task-line').length;\r\n\t\tall.show();\r\n\t\tvar a = all.length;\r\n\t\t\r\n\t\tif (search && search.length > 0){\r\n\t\t\tlet toHide = $('#monitor-panel .monitor-table .pcontent').find('.task-line').not(\":containsNoCase('\" + search + \"')\");\r\n\t\t\ttoHide.hide();\r\n\t\t\tvar b = toHide.length;\r\n\t\t\t$('#monitor-total-counter').text(search +': '+(a-b+'/'+a));\r\n\t\t} else {\r\n\t\t\t$('#monitor-total-counter').text(tasksCount);\r\n\t\t}\r\n\t}\r\n}\r\n","import {Util} from './util.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class Navigation {\r\n\tactiveMenuId = 'main-page';\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.prevHash = \"\";\r\n\t\tthis.app = app;\r\n\t\t\r\n\t\t$(\".profile-tab\").on('click', function() {\r\n\t\t\tvar tab_id = $(this).attr(\"tab\");\r\n\t\t\tdocument.location.hash = \"#select=profile&profileTab=\"+tab_id;\r\n\t\t});\r\n\r\n\t}\r\n\t\r\n\thashChanged(hash) {\r\n\t\tconsole.log('hash changed from ' + this.prevHash + ' to ' + hash);\r\n\t\tif (this.prevHash != hash) {\r\n\t\t\tthis.prevHash = hash;\r\n\t\t\tif (hash == \"\")\r\n\t\t\t\treturn false;\r\n\t\t\t\r\n\t\t\tthis.loadUI(encodeURI(hash));\r\n\t\t}\r\n\t}\r\n\t\r\n\tloadUI(hash) {\r\n\t\tvar params = Util.parseHash(hash);\r\n\t\tconsole.log(\"params = \" + JSON.stringify(params));\r\n\t\t\r\n\t\tif (params.cmd == 'exit') {\r\n\t\t\tthis.app.logout();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (params.select !== null && params.select !== undefined && params.select.length > 0) {\r\n\t\t\tthis.activeMenuId = params.select;\r\n\t\t\t$('.top-view-panel[id != \"' + this.activeMenuId + '-panel\"]').hide();\r\n\t\t\t$('#' + this.activeMenuId + '-panel').show();\r\n\t\t\t\r\n\t        $('.left-menu li.selected').removeClass('selected');\r\n        \t$('#menu-' + this.activeMenuId).parent().addClass(\"selected\");\r\n\r\n\t\t\t$('#' + this.activeMenuId + '-panel').panel();\r\n\t\t\tthis.app.resize('#' + this.activeMenuId + '-panel');\r\n\t\t\t\r\n\t\t\tconsole.log(\"show #\" + this.activeMenuId + '-panel');\r\n\t\t}\r\n\r\n\t\tif (params.profileTab !== null && params.profileTab !== undefined && params.profileTab.length > 0) {\r\n\t\t\t$('.profile-body').hide();\r\n\t\t\t$(\"#profile-panel-\"+params.profileTab).show();\r\n\t\r\n\t\t\t$('.profile-tab').removeClass(\"active\");\r\n\t\t\t$('.profile-tab[tab=\"' + params.profileTab + '\"]').addClass(\"active\");\r\n\t\t\t\r\n\t\t\tconsole.log(\"show #profile-panel-\" + params.profileTab);\r\n\t\t}\r\n\t\t\r\n\t\tif (params.orders) {\r\n\t\t\tthis.showOrders(params.orders);\r\n\t\t} else if (params.cmd == 'openTask') {\r\n\t\t\tUtil.blockPage();\r\n\t\t\tvar url = Util.makeUrl(params);\r\n\t\t\t$('#ui-body').attr('init',\"1\");\r\n\t\t\tthis.openTask(params.uid, url);\r\n\t\t} else if (params.cmd !== null && params.cmd !== undefined) {\r\n\t\t\tUtil.blockPage();\r\n\t\t\t$('.top-view-panel').hide();\r\n\t\t\t$('#ui-body').attr('init',\"1\");\r\n\t\t\t$('#ui-panel').show();\r\n\t\t\t$('#ui-title').show();\r\n\t\t\t$('.ui-toolbar').show();\r\n\t\t\t$('#ui-breadcrump').show();\r\n\t\t\t$(\"#nextBtn\").hide();\r\n\t\t\t\r\n\t\t\tthis.app.resize('#ui-panel');\r\n\t\t\t\r\n\t\t\tvar url = Util.makeUrl(params);\r\n\t\t\t$('#ui-body').panel('refresh', url);\r\n\t\t\tthis.app.resizeHeight();\r\n\t        //clearTimeout(refresher);\r\n\t\t}\r\n\t\t$('#ui-panel .easyui-panel:not(.tamur-tabs)').panel();\r\n\t}\r\n\r\n\tshowOrders(type) {\r\n\t\t// отменить выделение предыдущего типа поручений\r\n\t\t$('.order-type-selected').removeClass('order-type-selected');\r\n\t\t// выделяем нужный тип\r\n\t\tif (type === 'all')\r\n\t\t\t$('.order-type:not([code])').addClass(('order-type-selected'));\r\n\t\telse\r\n\t\t\t$('.order-type[code=' + type + ']').addClass(('order-type-selected'));\r\n\t\t// скрываем/отображаем поручения нужного типа\r\n\t\tif (type === 'all') {\r\n\t\t\t//$('.order-block').show();\r\n\t\t} else {\r\n\t\t\t$('.order-blocks[code=' + type + ']').show();\r\n\t\t\t$('.order-blocks[code!=' + type + ']').hide();\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\topenOrder(iter, proc, uid, startIfNotExists) {\r\n\t\tlet _this = this;\r\n\t\tUtil.blockPage();\r\n\t\t\r\n\t\tif (iter == null || iter == undefined || iter == \"\")\r\n\t\t\tdocument.location.hash = \"cmd=openOrder&iuid=\" + proc + \"&ouid=\" + uid;\r\n\t\t\r\n\t\telse {\r\n\t\t\tlet par = {\"uid\": proc, \"obj\": iter, \"cmd\": \"openProcess\"};\r\n\t\t\t\t\t\r\n\t\t\tthis.app.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t        if (data.result == \"success\" || data.acts == null || data.acts > 0 || (data.message != null && !startIfNotExists)) {\r\n\t\t\t\t     \t\t_this.showProcessUI(data);\r\n\t\t\t\t        } else if (startIfNotExists) {\r\n\t\t\t\t\t\t\tpar.cmd = \"startProcess\";\r\n\t\t\t\t\t\t\tpar.obj = uid;\r\n\t\t\t\t\t\t\t_this.app.query(par).then(response => {\r\n\t\t\t\t\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\t\t\t\t\tif (data.infMsg) {\r\n\t\t\t\t\t\t\t\t\t\t\tUtil.alert(data.infMsg);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t_this.showProcessUI(data);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\t\t\t\t\r\n\t\t\t\t        } else if(data.result == \"error\" && data.message == null){\r\n\t        \t\t\t\t$('body').unblock();\r\n\t            \t\t\tUtil.alert(Translation.translation['error'], Util.ERROR);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tshowProcessUI(data) {\r\n\t\tlet _this = this;\r\n\t\tlet ifc = this.app.ifcController;\r\n\t\t\r\n\t\tif (data.result == \"success\") {\r\n\t\t\tif (data.mode && data.mode==\"dialog\") {\r\n\t\t\t\tifc.openStartDialog(data.uid);\r\n\t\t\t} else if (data.mode && data.mode==\"no\") {\r\n\t\t\t\t_this.toActiveMain();\r\n\t\t\t\t$('body').unblock();\r\n\t\t\t} else if (data.uid) {\r\n\t\t\t\tif (document.location.hash.indexOf(\"cmd=openTask&uid=\" + data.uid) == -1)\r\n\t\t\t\t\tdocument.location.hash = \"cmd=openTask&uid=\" + data.uid + \"&rnd=\" + Util.rnd();\r\n\t\t\t} else {\r\n\t\t\t\t_this.toActiveMain();\r\n\t\t\t\t$('body').unblock();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar message = data.message;\r\n\t\t\tvar unblock = true;\r\n\t\t\t// здесь код поменял Жаркын, чтобы узнать на каком языке показывать текст =========\r\n\t\t\tlet myMessage = \" Открыть раннее запущенный процесс?\";\r\n\t\t\tif($('#topLangKz').hasClass(\"selected\")) {\r\n\t\t\t\tmyMessage = \" Бұрын іске қосылған процесті ашу?\";\r\n\t\t\t} else {\r\n\t\t\t\tmyMessage = \" Открыть раннее запущенный процесс?\";\r\n\t\t\t}\r\n\t\t\tif (message) {\r\n\t\t\t\tvar flowIdText = \"ID потока: \";\r\n\t\t\t\tvar index = message.indexOf(flowIdText);\r\n\t\t\t\tif (index > 0) {\r\n\t\t\t\t\tvar flowId = message.substring(index + flowIdText.length, message.length - 1);\r\n\t\t\t\t\tmessage = message.substring(0, index) + myMessage;\r\n\t\t\t\t\t$.messager.confirm('', message, function(e) {\r\n\t\t\t\t\t\tif (e) {\r\n\t\t\t\t\t\t\tdocument.location.hash = \"cmd=openTask&uid=\" + flowId + \"&rnd=\" + Util.rnd() + \"&isPrevProc=1\";\r\n\t\t\t\t\t\t\tunblock = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}); \r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(message);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tUtil.alert('error', Util.ERROR);\r\n\t\t\t}\r\n\t\t\tif (unblock)\r\n\t\t\t\t$('body').unblock();\r\n\t\t}\r\n\t}\r\n\t\r\n\topenTask(uid, url) {\r\n\t\tlet par = {\"uid\": uid, \"cmd\": \"taskType\", \"json\": 1, \"rnd\": Util.rnd()};\r\n\t\tlet nav = this;\r\n\t\tlet ifc = this.app.ifcController;\r\n\t\t\t\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\tif (data.type == \"report\" || data.type == \"fastreport\") {\r\n\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else if (data.type == \"htmlreport\") {\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\twindow.open(url);\r\n\t\t\t\t\t} else if (data.type == \"undefined\") {\r\n\t\t\t\t\t\tUtil.delay(3000).then(() => nav.openTask(uid, url));\r\n\t\t\t\t\t} else if (data.type == \"choose\") {\r\n\t\t\t\t\t\tifc.openStartDialog(uid);\r\n\t\t\t\t\t} else if (data.type == \"dialog\") {\r\n\t\t\t\t\t\tifc.openStartDialog(uid);\r\n\t\t\t\t\t} else if (data.type == \"option\") {\r\n\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\tpar[\"cmd\"] = \"openTask\";\r\n\t\t\t\t\t\tpar[\"uid\"] = uid;\r\n\t\t\t\t\t\tnav.app.query(par).then(response => {\r\n\t\t\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\t\t\tif (data.message) {\r\n\t\t\t\t\t\t\t\t\tUtil.alert(data.message, Util.INFO);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (data.type == \"error\") {\r\n\t\t\t            Util.alert(data.msg, Util.ERROR);\r\n\t\t\t\t\t\tnav.toActiveMain();\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else if (data.type == \"noop\") {\r\n\t\t\t\t\t\tnav.toActiveMain();\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('.top-view-panel').hide();\r\n\t\t\t\t\t\t$('#ui-panel').show();\r\n\t\t\t\t\t\t$('#ui-title').show();\r\n\t\t\t\t\t\t$('.ui-toolbar').show();\r\n\t\t\t\t\t\t$('#ui-breadcrump').show();\r\n\t\t\t\t\t\t$(\"#nextBtn\").show();\r\n\t\t\t\t\t\t$(\"#nextBtn\").addClass(\"active\");\r\n\r\n\t\t\t\t\t\t$('#ui-body').panel('refresh', url);\r\n\t\t\t\t\t\tnav.app.resizeHeight();\r\n\t\t\t\t\t\t$('.easyui-panel:not(.tamur-tabs)').panel();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\ttoActiveMain() {\r\n\t\tlet a = $('#menu-' + this.activeMenuId);\r\n\t\tdocument.location.hash = a.attr('href');\r\n\t\t//a.click();\r\n\t}\r\n\r\n\tstartProcess(pid) {\r\n\t\tlet nav = this;\r\n\t\t\r\n\t\tUtil.blockPage();\r\n\t\t\r\n\t\tlet par = {\"uid\": pid, \"cmd\": \"startProcess\"};\r\n\t\t\t\t\r\n\t\tthis.app.query(par).then(response => {\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\tif (data.infMsg) {\r\n\t\t\t\t\t\tUtil.alert(data.infMsg);\r\n\t\t\t   \t \t}\r\n\t\t\t\t\tnav.showProcessUI(data);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenArchive(pid) {\r\n\t\t$(\"#nextBtn\").hide();\r\n\t\tdocument.location.hash = \"cmd=openArch&uid=\" + pid;\r\n\t}\r\n\t\r\n\topenDict(pid) {\r\n\t\t$(\"#nextBtn\").hide();\r\n\t\tdocument.location.hash = \"cmd=openDict&uid=\" + pid;\r\n\t}\r\n\t\r\n\topenIfcWithObj(ui, obj) {\r\n\t\t$(\"#nextBtn\").hide();\r\n\t\tdocument.location.hash = \"cmd=openTaskIntf&intUid=\" + ui + \"&objUid=\" + obj;\r\n\t}\r\n\r\n\tcancelStart(uid) {\r\n\t\tvar par = {};\r\n\t\tpar[\"cmd\"] = \"cancelProcess\";\r\n\t\tpar[\"uid\"] = uid;\r\n\t\tthis.app.query(par);\r\n\t}\r\n\t\r\n\tstepSelected(ignore, did) {\r\n\t\tvar steps = document.getElementsByName(\"step\");\r\n\t\tvar transitionId;\r\n\t\tfor (var i = 0; i < steps.length; i++) {\r\n\t\t\tif (steps[i].checked)\r\n\t\t\t\ttransitionId = steps[i].value;\r\n\t\t}\r\n\t\tthis.nextStep(ignore, did, transitionId);\r\n\t\t$('#stepSelectionDlg').dialog(\"close\");\r\n\t\t$('body').unblock();\r\n\t}\r\n\t\r\n\tstepSelectionCanceled() {\r\n\t\t$('#stepSelectionDlg').dialog(\"close\");\r\n\t\t$('body').unblock();\r\n\t}\r\n\t\r\n\tnextStep(ignore, did, transitionId) {\r\n\t\tlet _this = this;\r\n\t\tlet ifc = this.app.ifcController;\r\n\t\tlet nav = this.app.nav;\r\n\t\t\r\n\t\tifc.endEditing();\r\n\t\tif (ignore || $(\"#nextBtn\").hasClass(\"active\")) {\r\n\t\t\tif (transitionId || ignore != undefined || did != undefined || confirm(Translation.translation['askNextStep'])) {\r\n\t\t\t\tvar par = {};\r\n\t\t\t\tpar[\"cmd\"] = \"nextStep\";\r\n\t\t\t\tif (transitionId) {\r\n\t\t\t\t\tpar[\"transitionId\"] = transitionId;\r\n\t\t\t\t}\r\n\t\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t\tif (data.result == \"success\") {\r\n\t\t\t\t\t\tifc.hideChangeMsg();\r\n\t\t\t\t\t\tif (did == null)\r\n\t\t\t\t\t\t\tnav.toActiveMain();\r\n\t\t\t\t\t\tif (data.message) {\r\n\t\t\t\t\t\t\tUtil.alert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (did)\r\n\t\t\t\t\t\t\t$('#' + did).dialog('destroy');\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else if (data.result == \"selectStep\") {\r\n\t\t\t\t\t\t// Показать диалог с выбором шага\r\n\t\t\t\t\t\tvar dialogDiv = document.getElementById('stepSelectionDlg');\r\n\t\t\t\t\t\tif (dialogDiv != null) {\r\n\t\t\t\t\t\t\tdialogDiv.parentNode.removeChild(dialogDiv);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialogDiv = $('<div />', {'class': 'easyui-dialog', 'id': 'stepSelectionDlg'});\r\n\t\t\t\t\t\tvar html = '<div style=\"padding: 20px\">';\r\n\t\t\t\t\t\tfor (var i = 0; i < data.transitions.length; i++) {\r\n\t\t\t\t\t\t\thtml += '<input style=\"margin: 0px 10px ' + (i < data.transitions.length - 1 ? '10px' : '0px') + ' 0px;\" type=\"radio\" name=\"step\" id=\"step_' + i + '\" value=\"' + data.transitions[i].value + '\"' + (i == 0 ? ' checked' : '') + '/>';\r\n\t\t\t\t\t\t\thtml += '<label for=\"step_' + i + '\">' + data.transitions[i].title + '</label>' + (i < data.transitions.length - 1 ? '<br>' : '');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</div>';\r\n\t\t\t\t\t\tdialogDiv.html(html);\r\n\t\t\t\t\t\tdialogDiv.dialog({\r\n\t\t\t\t\t\t\ttitle:'Выбор шага',\r\n\t\t\t\t\t\t\tclosed: true,\r\n\t\t\t\t\t\t\tdraggable: false,\r\n\t\t\t\t\t\t\tresizable: false,\r\n\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\tmodal:true,\r\n\t\t\t\t\t\t\tclosable: false,\r\n\t\t\t\t\t\t\tbuttons:[{\r\n\t\t\t\t\t\t\t\ttext:'Принять',\r\n\t\t\t\t\t\t\t\thandler:function(){_this.stepSelected(ignore, did);}\r\n\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\ttext:'Отмена',\r\n\t\t\t\t\t\t\t\thandler:function(){_this.stepSelectionCanceled();}\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t$('#stepSelectionDlg').dialog(\"open\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (data.message) {\r\n\t\t\t\t\t\t\tUtil.alert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (did)\r\n\t\t\t\t\t\t\tifc.setDialogBtnsEnabled(did, true);\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 'json');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tshowStack(stack, container) {}\r\n}\r\n","import {Util} from './util.js';\r\n\r\nexport class NCA {\r\n\t\r\n\tstatic APPLET = \"kz.gov.pki.knca.applet.Applet\";\r\n\tstatic COMMON = \"kz.gov.pki.knca.commonUtils\";\r\n\tstatic BASICS = \"kz.gov.pki.knca.basics\";\r\n\t\r\n\tstatic AUTH = 'AUTHENTICATION';\r\n\tstatic SIGN = 'SIGNATURE'; \r\n\t\r\n\ttokenStoresMap = {\r\n\t\t'AKEToken5110Store': 'eToken',\r\n\t\t'AKKaztokenStore': 'Казтокен',\r\n\t\t'PKCS12': 'Персональный компьютер',\r\n\t\t'AKKZIDCardStore': 'Удостоверение личности',\r\n\t}; \r\n\t\r\n\twebSocket = null;\r\n\tonMessage = null;\r\n\tonError = null;\r\n\t\r\n\tconstructor() {\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tif (_this.webSocket && _this.webSocket.readyState < 2) {\r\n\t        console.log(\"reusing the socket, state = \" + _this.webSocket.readyState);\r\n\t        return Promise.resolve();\r\n\t    }\r\n\t\t\r\n\t\treturn new Promise((resolve, reject)  => {\r\n\t\t\t_this.webSocket = new WebSocket('wss://127.0.0.1:13579/');\r\n\t\t\r\n\t\t\t_this.webSocket.onopen = function() {\r\n\t\t\t\tresolve();\r\n\t\t\t};\r\n\t\t\r\n\t\t\t_this.webSocket.onclose = function(event) {\r\n\t\t\t\t_this.webSocket = null;\r\n\t\t\t\tconsole.log(\"connection closed\");\r\n\t\t\t\tconsole.log('Code: ' + event.code + ' Reason: ' + event.reason);\r\n\t\t\t};\r\n\t\t\r\n\t\t\t_this.webSocket.onmessage = function(event) {\r\n\t\t\t\tvar dataStr = event.data;\r\n\t\t\t\tvar data = JSON.parse(dataStr);\r\n\t\t\t\tconsole.log(\"event.data: \" + data);\r\n\t\t\t\t\r\n\t\t\t\tif (data && data.result && data.result.version)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t\tif (_this.onMessage) {\r\n\t\t\t\t\t_this.onMessage(data);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t_this.webSocket.onerror = function(error) {\r\n\t\t\t\treject(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowError() {\r\n\t\tif (mode == 0) {\r\n\t\t\tthis.showErrorOnLoginPage(\"Ошибка соединения с NCALayer!\");\r\n\t\t} else if (mode == 1 || mode == 2) {\r\n\t\t\tUtil.alert('Ошибка соединения с NCALayer');\r\n\t\t}\r\n\t\tthis.resetOperation(true);\r\n\t}\r\n\t\r\n\tsendToNCALayer(module, method, args) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t_this.init().then(() => {\r\n\t\t\t\t_this.onMessage = resolve;\t\r\n\t\t\t\tconsole.log(\"sendToNCALayer: \" + module + \", method: \" + method + \", args: \" + args);\r\n\t\t\t\r\n\t\t\t\tvar json = {'module' : module, 'method' : method, 'args' : args};\r\n\t\t\t\t_this.webSocket.send(JSON.stringify(json));\r\n\t\t\t}, err => {\r\n\t\t\t\tconsole.error(\"socket error : \", err);\r\n\t\t\t\treject(\"Ошибка соединения с NCALayer!\");\r\n\t\t\t});\r\n\t\t}); \r\n\t}\r\n\t\r\n\tchooseStorage(data) {\r\n\t\tlet _this = this;\r\n\t\tif (data.responseObject) {\r\n\t\t\tif (data.responseObject.length == 0)\r\n\t\t\t\treturn Promise.resolve('PKCS12');\r\n\t\t\telse\r\n\t\t\t\treturn _this.showStorageSelectionDialog(data.responseObject);\r\n\t\t} else {\r\n\t\t\treturn Promise.reject(\"Ошибка при получении доступных хранилищ ключей\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetActiveTokens(module) {\r\n\t\treturn this.sendToNCALayer(module, \"getActiveTokens\", []);\r\n\t}\r\n\t\r\n\tsignXml(module, ecpType, xml) {\r\n\t\tlet _this = this;\r\n\r\n\t\tif (module === NCA.COMMON) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t_this.getActiveTokens(module).then(data => {\r\n\t\t\t\t\t_this.chooseStorage(data).then(alias => {\r\n\t\t\t\t\t\tlet args = [ alias, ecpType, xml, \"\", \"\" ];\r\n\t\t\t\t\t\t_this.sendToNCALayer(module, \"signXml\", args).then(resolve, reject);\r\n\t\t\t\t\t}, reject);\r\n\t\t\t\t}, reject);\r\n\t\t\t});\r\n\t\t} else if (module === NCA.BASICS) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tlet args = {\r\n\t\t\t\t\tallowedStorages: \"AKKaztokenStore,AKKZIDCardStore,AKEToken72KStore,AKJaCartaStore,PKCS12,JKS,AKAKEYStore,AKEToken5110Store,ABSIMCardStore,ABCloudServiceStore\",\r\n\t\t\t\t\tformat: \"xml\",\r\n\t\t\t\t\tdata: xml,\r\n\t\t\t\t\tsigningParams: {\r\n\t\t\t\t\t\tdecode: false,\r\n\t\t\t\t\t\tdigested: false,\r\n\t\t\t\t\t\tencapsulate: false,\r\n\t\t\t\t\t\ttsaProfile: null\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsignerParams: {\r\n\t\t\t\t\t\t// Проверка подлинности клиента (1.3.6.1.5.5.7.3.2) авторизация\r\n\t\t\t\t\t\t// Защищенная электронная почта (1.3.6.1.5.5.7.3.4) подписть\r\n\t\t\t\t\t\textKeyUsageOids: [\"1.3.6.1.5.5.7.3.2\"] \r\n\t\t\t\t\t},\r\n\t\t\t\t\tlocale: \"ru\"\r\n\t\t\t\t};\r\n\t\t\t\t_this.sendToNCALayer(module, \"sign\", args).then(data => {\r\n\t\t\t\t\tif (data.status === true) {\r\n\t\t\t\t\t\tlet response = (data.body.result) \r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tresponseObject: data.body.result[0]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmessage: 'action.canceled'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t} else if (data.status === false) {\r\n\t\t\t\t\t\tlet response = {\r\n\t\t\t\t\t\t\tcode: data.code,\r\n\t\t\t\t\t\t\tmessage: data.message + ' (' + data.details + ')'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject('Неизвестная ошибка NCALayer!');\r\n\t\t\t\t\t}\r\n\t\t\t\t}, reject);\r\n\t\t\t});\r\n\t\t} else\r\n\t\t\treturn Promise.reject(\"Неизвестный плагин NCALayer\"); \r\n\t}\r\n\t\r\n\tshowStorageSelectionDialog(conteiners) {\r\n\t\tlet _this = this;\r\n\t\r\n\t\tvar options = '<option value=\"\" disabled selected hidden>Выберите хранилище</option>' +\r\n\t\t\t\t\t\t'<option value=\"PKCS12\">' + this.tokenStoresMap['PKCS12'] +'</option>';\r\n\t\t\r\n\t\tfor (var ind = 0; ind < conteiners.length; ind++) {\r\n\t\t\tvar contId  = conteiners[ind];\r\n\t\t\toptions += '<option value=\"' + contId + '\">' + this.tokenStoresMap[contId] + '</option>';\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\r\n\t\t\tvar dialogDiv = $('<div />', {'class': 'easyui-dialog', 'id': 'storageInputDlg'}); \r\n\t\t\tdialogDiv.html('<div style=\"padding: 20px\">' +\r\n\t\t\t\t\t'<select id=\"keyStore1\">' +\r\n\t\t\t\t\t\toptions +\r\n\t\t\t\t\t'</select></div>');\r\n\t\t\t\r\n\t\t\tdialogDiv.find('#keyStore1').keyup(function(e) {\r\n\t\t\t\tif (e.which && e.which == 13)\r\n\t\t\t\t\t$('#storageInputDlgOkBtn').click();\r\n\t\t\t}).change(function (e) {\r\n\t\t\t\t$(\"#storageInputDlgOkBtn\").linkbutton(\"enable\");\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tdialogDiv.dialog({\r\n\t\t\t\ttitle:'Выбор хранилища ключей',\r\n\t\t\t\tclosed: true,\r\n\t\t\t\tdraggable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\tmodal:true,\r\n\t\t\t\tclosable: false,\r\n\t\t\t\tbuttons:[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext:'Принять',\r\n\t\t\t\t\t\tid: 'storageInputDlgOkBtn',\r\n\t\t\t\t\t\thandler:function(){\r\n\t\t\t\t\t\t\tlet storageAlias = $(\"#keyStore1 option:selected\").val();\r\n\t\t\t\t\t\t\t$(\"#storageInputDlg\").dialog('destroy');\r\n\t\t\t\t\t\t\tresolve(storageAlias);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext:'Отмена',\r\n\t\t\t\t\t\thandler:function(){\r\n\t\t\t\t\t\t\t$(\"#storageInputDlg\").dialog('destroy');\r\n\t\t\t\t\t\t\treject(\"Выбор хранилища отменен\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tonOpen: function() {\r\n\t\t\t\t\t$('#keyStore1').focus();\r\n\t\t\t\t},\r\n\t\t\t\tonClose: function() {\r\n\t\t\t\t\t$(\"#storageInputDlg\").dialog('destroy');\r\n\t\t\t\t\treject(\"Окно выбора хранилища закрыто\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\r\n\t\t\t$('body').unblock();\r\n\t\t\tvar e = document.getElementById(\"keyStore1\");\r\n\t\t\tif (e.options[e.selectedIndex].value.length == 0) {\r\n\t\t\t\t$(\"#storageInputDlgOkBtn\").linkbutton(\"disable\");\r\n\t\t\t} else {\r\n\t\t\t\t$(\"#storageInputDlgOkBtn\").linkbutton(\"enable\");\r\n\t\t\t}\r\n\t\t\t$('#storageInputDlg').dialog(\"open\");\r\n\t\t});\r\n\t}\r\n}\r\n","import {Util, DataChecker} from './util.js';\r\n\r\nexport class Notifications {\r\n\t\r\n\torderStatus = [\"label-success\", \"label-warning\", \"label-important\", \"label-info\"];\r\n\tnotificationPageSize = 50;\r\n\tcurrentPageNumber = 1;\r\n\ttotal = 0;\r\n\t\r\n\tsortColumn = \"sortInDate_asc\"\r\n\tstatusReadingNotification = 0;\r\n\tdateParseN1 = 0;\r\n\tdateParseN2 = 0;\r\n\tnotificationSearch = 0;\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet this_ = this;\r\n\t\t\r\n\t\t$('#notifications-pager').pagination({\r\n\t\t    pageSize: this_.notificationPageSize,\r\n\t\t    pageNumber: 1,\r\n\t\t    pageList: [10, 50, 100, 150, 200],\r\n\t\t    layout: ['list','sep','first','prev','sep','links','sep','next','last','sep','manual'],\r\n\t\t    showPageList: true,\r\n\r\n\t\t\tonSelectPage:function(pageNumber, pageSize){\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\t$(this).pagination('loading');\r\n\t\t\t\t\r\n\t\t\t\tthis_.currentPageNumber = pageNumber;\r\n\t\t\t\tthis_.notificationPageSize = pageSize;\r\n\t\t\t\t\r\n\t\t\t\tthis_.loadNotifications();\r\n\t\t\t\t\r\n\t\t\t\t$(this).pagination('loaded');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tthis_.loadNotifications();\r\n\t\t\r\n\t\t$(\"body\").on('click', '.notification-line .notification-title', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tthis_.app.nav.openOrder(jThis.attr('iter'), jThis.attr('proc'), jThis.attr('uid'), jThis.attr('type') !== 'my');\r\n\t\t});\r\n\t\t\r\n\t}\r\n\t\r\n\tloadNotifications() {\r\n\t\t// если доступно меню Уведомления пользователю\r\n\t\tif ($('#notifications-select-type').length > 0) {\r\n\t\t\ttry {\r\n\t\t\t\tUtil.blockPage();\r\n\t\t\t\tlet this_ = this;\r\n\t\t\t\t\r\n\t\t\t\tlet index = parseInt($('#notifications-select-type').val());\r\n\t\t\t\tthis_.statusReadingNotification = index;\r\n\t\t\r\n\t\t\t\tlet dateN1 = $(\"#dateN1\").datebox(\"getValue\");\r\n\t\t\t\tthis_.dateParseN1 = dateN1 != \"\" ? dateN1 + \" 00:00:00\" : 0;\r\n\t\t\t\tlet dateN2 = $(\"#dateN2\").datebox(\"getValue\");\r\n\t\t\t\tthis_.dateParseN2 = dateN2 != \"\" ? dateN2 + \" 00:00:00\" : 0;\r\n\t\t\r\n\t\t\t\tthis_.notificationSearch = $('#notifications-search-text').val().length > 0\r\n\t\t\t\t\t\t\t\t\t\t\t? $('#notifications-search-text').val() : \"0\";\r\n\t\t\t\r\n\t\t\t\tvar end = 0;\r\n\t\t\t\tif (this_.total == 0)\r\n\t\t\t\t\tend = this_.notificationPageSize;\r\n\t\t\t\telse if (this_.total <= this_.currentPageNumber * this_.notificationPageSize)\r\n\t\t\t\t\tend = this_.total\r\n\t\t\t\telse\r\n\t\t\t\t\tend = this_.currentPageNumber * this_.notificationPageSize;\r\n\t\t\r\n\t\t\t\tvar par = {\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": \"getNewNotificationOrders\", \r\n\t\t\t\t\t\"arg0\": 1, \"arg1\": (this_.currentPageNumber-1) * this_.notificationPageSize, \"arg2\": end,\r\n\t\t\t\t\t\"arg3\": this_.dateParseN1, \"arg4\": this_.dateParseN2, \r\n\t\t\t\t\t\"arg5\": this_.notificationSearch, \"arg6\": this_.statusReadingNotification, \r\n\t\t\t\t\t\"arg7\": this_.sortColumn};\r\n\t\t\t\r\n\t\t\t\tthis.app.query(par).then(response => {\r\n\t\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\t\t\tif (data.totalUnread > 0)\r\n\t\t\t\t\t\t\t\t\t$('#notifications-unread-counter').text(data.totalUnread);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('#notifications-pager').pagination({\r\n\t\t\t\t\t\t\t\t\ttotal: data.totalFilter ? data.totalFilter : data.total,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis_.total = data.total;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('#notifications-total-counter').text((data.totalFilter ? (data.totalFilter + '/') : '') + data.total);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('#notifications-panel .notifications-table .pcontent').empty();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (data.rows) {\r\n\t\t\t\t\t\t\t\t\t$.each(data.rows, function(i, o) {\r\n\t\t\t\t\t\t\t\t\t\t$.each(o, function(key, order) {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#notifications-panel .notifications-table .pcontent').append(this_.makeNotification(key, order));\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} catch(e) {\r\n\t\t\t\t$('body').unblock();\r\n\t\t\t\tconsole.log(\"упал на notifications \" + e)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tmakeNotification(key, order) {\r\n\t\tvar orderDiv = $(\"<div class='notification-line'></div>\").attr('id', key);\r\n\t\tif (order.openDate == \"\")\r\n\t\t\torderDiv.addClass('notification-unread');\r\n\t\t\t\t\t\t\t\t\r\n\t\tvar titleDiv = $(\"<div class='notification-title'></div>\").html(order.title)\r\n\t\t\t.attr('iter', order.iter).attr('proc', order.proc).attr('uid', key).attr('type', 'notif');;\r\n\t\t\r\n\t\tvar authorDiv = $(\"<div class='notification-author'></div>\").text(order.from);\r\n\t\tvar date1Div = $(\"<div class='notification-date'></div>\").text(order.inDate);\r\n\t\tvar date2Div = $(\"<div class='notification-date'></div>\").text(order.openDate);\r\n\t\tvar date3Div = $(\"<div class='notification-date'></div>\").text(order.awereDate);\r\n\t\t\r\n\t\torderDiv.append(titleDiv).append(authorDiv).append(date1Div).append(date2Div).append(date3Div);\r\n\t\t\r\n\t\treturn orderDiv;\r\n\t\t//var func = order.iter == '' ? \"href='javascript:openOrder(\\\"\"+order.proc+\"\\\",\\\"\"+key+\"\\\")'\" : \"href='javascript:startOrderIn(\\\"\"+order.iter+\"\\\",\\\"\"+order.proc+\"\\\",\\\"\"+key+\"\\\")'\";\r\n\t}\r\n\t\r\n\tdeleteNotification(byType) {\r\n\t\tlet _this = this;\r\n\t\t$.each(byType, function(type, o) {\r\n\t\t\tif (type == \"notif\") {\r\n\t\t\t\t$.each(o, function(i, uid) {\r\n\t\t\t\t\tlet existOrderDiv = $('#notifications-panel .notification-line[id=\"' + uid + '\"]');\r\n\t\t\t\t\tlet isImportant = existOrderDiv.hasClass('notification-unread');\r\n\t\t\t\t\texistOrderDiv.remove();\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar tmp = $('#notifications-total-counter').text();\r\n\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t$('#notifications-total-counter').text(oldCount - 1);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (isImportant) {\r\n\t\t\t\t\t\ttmp = $('#notifications-unread-counter').text();\r\n\t\t\t\t\t\toldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\tif (oldCount == 1) {\r\n\t\t\t\t\t\t\t$('#notifications-unread-counter').hide();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$('#notifications-unread-counter').show().text(oldCount - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tupdateNotification(byType) {\r\n\t\tlet _this = this;\r\n\t\t$.each(byType, function(type, o) {\r\n\t\t\tif (type == \"notif\") {\r\n\t\t\t\t$.each(o, function(i, uid) {\r\n\t\t\t\t\tlet par = {\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": \"getNewNotificationOrders\", \"arg0\": uid};\r\n\t\t\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t\t\tif (data.rows) {\r\n\t\t\t\t\t\t\t$.each(data.rows, function(type1, o1) {\r\n\t\t\t\t\t\t\t\t$.each(o1, function(key, order) {\r\n\t\t\t\t\t\t\t\t\tvar delta = 0;\r\n\t\t\t\t\t\t\t\t\tlet orderDiv = _this.makeNotification(key, order);\r\n\t\t\t\t\t\t\t\t\tdelta += (orderDiv.hasClass('notification-unread')) ? 1 : 0;\r\n\t\t\t\t\t\t\t\t\tlet existOrderDiv = $('#notifications-panel .notification-line[id=\"' + key + '\"]');\r\n\t\t\t\t\t\t\t\t\tdelta -= (existOrderDiv.hasClass('notification-unread')) ? 1 : 0;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (existOrderDiv.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\texistOrderDiv.replaceWith(orderDiv);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tvar firstRow = $('#notifications-panel .notification-line:first');\r\n\t\t\t\t\t\t\t\t\t\tif (firstRow.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t\tfirstRow.before(orderDiv);\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#notifications-panel .notifications-table .pcontent').append(orderDiv);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar tmp = $('#notifications-total-counter').text();\r\n\t\t\t\t\t\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\t\t\t\t\t$('#notifications-total-counter').text(oldCount + 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (delta != 0) {\r\n\t\t\t\t\t\t\t\t\t\tvar tmp = $('#notifications-unread-counter').text();\r\n\t\t\t\t\t\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\t\t\t\t\tif (oldCount == 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#notifications-unread-counter').hide();\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#notifications-unread-counter').show().text(oldCount + delta);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tnotificationsProcessing(json) {\r\n\t\tconsole.log(\"notificationsProcessing = \" + json);\r\n\t}\r\n\t\r\n\tdeleteNotifications(json) {\r\n\t\tconsole.log(\"deleteNotifications = \" + json);\r\n\t}\r\n\t\r\n\tloadNotifications2() {\r\n\t\tthis.currentPageNumber = 1;\r\n\t\t$('#notifications-pager').pagination('refresh',{\r\n\t\t\tpageNumber: 1\r\n\t\t});\r\n\t\tthis.loadNotifications();\r\n\t}\r\n\r\n\tcleanNotificationParams() {\r\n\t\tUtil.blockPage();\r\n\t\tlet this_ = this;\r\n\t\tlet dateN1 = $(\"#dateN1\").datebox(\"getValue\"),\r\n\t\t    dateN2 = $(\"#dateN2\").datebox(\"getValue\");\r\n\t\tif (dateN1 != \"\" || dateN2 != \"\") {\r\n\t\t\tconsole.log(\"this3\");\r\n\t\t\t$(\"#dateN1\").datebox(\"clear\");\r\n\t\t\t$(\"#dateN2\").datebox(\"clear\");\r\n\t\t}\r\n\t\t$('#notifications-select-type option').prop('selected', function() {\r\n\t\t\tconsole.log(\"this5\");\r\n\t\t\treturn this.defaultSelected;\r\n\t\t});\r\n\t\t$('#notifications-search-text').val(\"\");\r\n\t\tthis_.notificationSearch = 0;\r\n\t\tthis_.statusReadingNotification = 0;\r\n\t\tthis_.dateParseN1 = 0;\r\n\t\tthis_.dateParseN2 = 0;\r\n\t\tthis_.sortNotifColumn = \"sortInDate_asc\";\r\n\t\t// $('#toolNotif td a').removeClass('sortNotif asc desc');\r\n\t\t// $('#sortInDate').addClass('sortNotif').addClass('asc');\r\n\t\tthis_.loadNotifications();\r\n\t}\r\n}\r\n","import {DataChecker, Util} from './util.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class Orders {\r\n\t\r\n\torderStatus = [\"label-success\", \"label-warning\", \"label-important\", \"label-info\"];\r\n\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinit() {\r\n\t\tlet this_ = this;\r\n\t\t$(\".orders-tab\").on('click', function() {\r\n\t\t\tvar tab_id = $(this).attr(\"tab\");\r\n\t\t\tthis_.showTab(tab_id);\r\n\t\t});\r\n\t\t\r\n\t\tthis_.loadOrdersMy();\r\n\t\tthis_.loadOrdersIn();\r\n\t\tthis_.loadOrdersOut();\r\n\t\t\r\n\t\t$(\"body\").on('click', '.order-line .order-title', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tif (jThis.attr('type') === 'out')\r\n\t\t\t\tthis_.app.nav.openOrder(null, jThis.attr('iuid'), jThis.attr('iter'), false);\r\n\t\t\telse\r\n\t\t\t\tthis_.app.nav.openOrder(jThis.attr('iter'), jThis.attr('proc'), jThis.attr('uid'), jThis.attr('type') !== 'my');\t\t\t\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '.delete-order', function() {\r\n\t\t\tlet jThis = $(this);\r\n\t\t\tvar msg = Translation.translation['removeProcess'];\r\n\t\t\tUtil.confirmMessage(msg, function(e) {\r\n\t\t\t\tif (e) {\r\n\t\t\t\t\tlet span = jThis.parent().find('span.title');\r\n\t\t\t\t\tthis_.deleteOrder(span.attr('uid'), span.attr('iter'), span.attr('proc'));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowTab(tabId) {\r\n\t\tlet this_ = this;\r\n\t\t$('.orders-body').hide();\r\n\t\t$(\"#orders-panel-\"+tabId).show();\r\n\r\n\t\t$('.orders-tab').removeClass(\"active\");\r\n\t\t$('.orders-tab[tab=\"' + tabId + '\"]').addClass(\"active\");\r\n\t\t\r\n\t\t$(\"#orders-panel-\"+tabId).find('.easyui-panel').panel();\r\n\t}\r\n\t\r\n\tloadOrdersMy() {\r\n\t\tthis.loadOrders({\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": \"getMyOrders\", \"arg0\": 1}, 'my');\r\n\t}\r\n\r\n\tloadOrdersIn() {\r\n\t\tthis.loadOrders({\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": \"getOrders\", \"arg0\": 1}, 'in');\r\n\t}\r\n\r\n\tloadOrdersOut() {\r\n\t\tthis.loadOrders({\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": \"getOrdersOut\", \"arg0\": 1}, 'out');\r\n\t}\r\n\r\n\tloadOrders(par, tabId) {\r\n\t\tlet this_ = this;\r\n\t\t\t\t\r\n\t\tthis.app.post(par).then(data => {\r\n\t\t\tthis_.showOrdersLater(data, tabId, 20);\r\n\t\t});\r\n\t}\r\n\t\r\n\tshowOrdersLater(data, type, count) {\r\n\t\tlet _this = this;\r\n\t\tvar infire = 0;\r\n\t\tvar found = $('#ordersList_' + type + '_count').length > 0 && $('#ordersList_' + type).length > 0;\r\n\t\tif (found) {\r\n\t\t\t$('#ordersList_' + type + '_count').text(data.total);\r\n\r\n\t\t\tif (data.rows) {\r\n\t\t\t\t$.each(data.rows, function(i, o) {\r\n\t\t\t\t\t$.each(o, function(key, order) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet orderDiv = _this.makeOrderDiv(order, key, type);\r\n\t\t\t\t\t\t//var stop = order.isStop=='1' ? \"<td><input type='checkbox' class='my_check' key='\" + key + \"' task='\" + order.proc + \"' obj='\"+order.iter+\"'/></td>\" : \"\";\r\n\t\t\t\t\t\tif (type == 'in' && order.status == 2) {\r\n\t\t\t\t\t\t\tinfire++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('#ordersList_' + type).append(orderDiv);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//$('#ordersList_' + type).html(html);\r\n\t\t\tif (type == 'old') {\r\n\t\t\t\t$('#oldordersList_count').text(data.total);\r\n\t\t\t\tif(data.total == 0){\r\n\t\t\t\t\t$('#old_return').show();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (type == 'in') {\r\n\t\t\t\tif (infire > 0)\r\n\t\t\t\t\t$('#ordersList_in_fire_count').show().text(infire);\r\n\t\t\t\telse\r\n\t\t\t\t\t$('#ordersList_in_fire_count').hide();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t} else if (count > 0) {\r\n\t\t\tcount--;\r\n\t\t\tsetTimeout(function(){this.showOrdersLater(data, type, count);}, 800);\r\n\t\t}\r\n\t}\r\n\t\r\n\tmakeOrderDiv(order, key, type) {\r\n\t\tvar orderDiv = $(\"<div uid='\" + key + \"' class='order-line'></div>\");\r\n\t\t\t\t\t\t\r\n\t\torderDiv.append('<div class=\"order-photo\"><img src=\"'\r\n\t\t\t+ ((order.img && order.img.length > 0) ? order.img : 'css/img/empty-avatar-30.png')\r\n\t\t\t+ '\" /></div>');\r\n\t\t\r\n\t\tvar col1Div = $(\"<div class='order-col'></div>\");\r\n\t\tvar authorDiv = $(\"<div class='order-author'></div>\").text(order.from);\r\n\t\tvar dateDiv = $(\"<div class='order-date'></div>\").text(order.inDate);\r\n\t\tcol1Div.append(authorDiv).append(dateDiv);\r\n\t\t\r\n\t\tvar titles = order.title.split(':');\r\n\t\tvar col2Div = $(\"<div class='order-col'></div>\");\r\n\t\tvar pretitleDiv = $(\"<div class='order-pretitle'></div>\").text(titles.length > 1 ? titles[0] : \"\");\r\n\t\tvar titleDiv = $(\"<div class='order-title'></div>\").text(titles.length > 1 ? titles[1] : titles[0])\r\n\t\t\t.attr('iter', order.iter).attr('proc', order.proc).attr('iuid', order.iuid).attr('uid', key).attr('type', type);\r\n\t\t\t\r\n\t\tif (type != 'my' && type !='old' && order.status == 2)\r\n\t\t\ttitleDiv.addClass('order-important');\r\n\t\tcol2Div.append(pretitleDiv).append(titleDiv);\r\n\t\t\r\n\t\torderDiv.append(col1Div);\r\n\t\torderDiv.append('<div class=\"order-delimeter\"></div>');\r\n\t\torderDiv.append(col2Div);\r\n\t\tif (order.ctrl) {\r\n\t\t\tvar deadlineDiv = $('<div class=\"order-deadline\"></div>').text(order.ctrl).addClass(this.orderStatus[order.status]).attr('title', 'Срок исполнения');\r\n\t\t\torderDiv.append(deadlineDiv);\r\n\t\t}\r\n\t\treturn orderDiv;\r\n\t}\r\n\t\r\n\tmakeOrderBlock(order, key, type) {\r\n\t\tvar orderDiv = $(\"<div uid='\" + key + \"' class='order-block' type='\" + type + \"'></div>\");\r\n\t\t\r\n\t\tif (type == 'my')\r\n\t\t\torderDiv.append('<i class=\"delete-order icon-close\" task=\"' + order.proc + '\"/>');\r\n\t\t\t\t\t\t\r\n\t\tvar titles = order.title.split(':');\r\n\t\tvar pretitleSpan = $(\"<span class='preTitle'></span>\").text(titles.length > 1 ? titles[0] : \"\");\r\n\r\n\t\tvar titleSpan = $(\"<span class='title'></span>\").text(titles.length > 1 ? titles[1] : titles[0])\r\n\t\t\t.attr('iter', order.iter).attr('proc', order.proc).attr('iuid', order.iuid).attr('uid', key).attr('type', type);\r\n\t\t\r\n\t\tvar rowDiv = $(\"<div class='content-row'></div>\");\r\n\t\trowDiv.append('<span class=\"content-image\"><img src=\"'\r\n\t\t\t+ ((order.img && order.img.length > 0) ? order.img : 'css/img/empty-avatar-30.png')\r\n\t\t\t+ '\" /></span>');\r\n\t\t\t\r\n\t\tvar colDiv = $(\"<div class='content-column'></div>\");\r\n\t\tcolDiv.append(\"<span class='person'>От \" + order.from + \"</span>\");\r\n\t\tcolDiv.append(\"<span class='time'>\" + order.inDate + \"</span>\");\r\n\t\trowDiv.append(colDiv);\r\n\t\trowDiv.append(\"<i class='icon-type icon-type-in'></i>\");\r\n\t\t\r\n\t\torderDiv.append(pretitleSpan);\r\n\t\torderDiv.append(titleSpan);\r\n\t\torderDiv.append(rowDiv);\r\n\t\treturn orderDiv;\r\n\t}\r\n\r\n\tdeleteOrders(byType) {\r\n\t\tlet _this = this;\r\n\t\t$.each(byType, function(type, o) {\r\n\t\t\tif (type != \"notif\") {\r\n\t\t\t\t$.each(o, function(i, uid) {\r\n\t\t\t\t\tlet existOrderDiv = $('#ordersList_' + type + ' .order-line[uid=\"' + uid + '\"]');\r\n\t\t\t\t\tlet isImportant = (type == 'in' && existOrderDiv.find('.label-important').length > 0);\r\n\t\t\t\t\texistOrderDiv.remove();\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar tmp = $('#ordersList_' + type + '_count').text();\r\n\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t$('#ordersList_' + type + '_count').text(oldCount - 1);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (isImportant) {\r\n\t\t\t\t\t\ttmp = $('#ordersList_in_fire_count').text();\r\n\t\t\t\t\t\toldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\tif (oldCount == 1) {\r\n\t\t\t\t\t\t\t$('#ordersList_in_fire_count').hide();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$('#ordersList_in_fire_count').show().text(oldCount - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet existOrderDiv2 = $('.orders-' + type + ' .order-block[uid=\"' + uid + '\"]');\r\n\t\t\t\t\texistOrderDiv2.remove();\r\n\t\t\t\t\t\r\n\t\t\t\t\ttmp = $('.order-type[code=' + type + '] .order-count').text();\r\n\t\t\t\t\toldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t$('.order-type[code=' + type + '] .order-count').text(oldCount - 1);\r\n\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tupdateOrders(byType) {\r\n\t\tlet _this = this;\r\n\t\t$.each(byType, function(type, o) {\r\n\t\t\tif (type != \"notif\") {\r\n\t\t\t\t$.each(o, function(i, uid) {\r\n\t\t\t\t\tvar method = (type == \"in\") ? \"getOrders\" : \r\n\t\t\t\t\t\t\t \t(type == \"out\") ? \"getOrdersOut\" : \r\n\t\t\t\t \t\t\t \t(type == \"old\") ? \"getOldOrders\" : \"getMyOrders\";\r\n\t\r\n\t\t\t\t\tlet par = {\"sfunc\" : 1, \"cls\": \"XmlUtil\", \"name\": method, \"arg0\": uid};\r\n\t\t\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t\t\tif (data.rows) {\r\n\t\t\t\t\t\t\t$.each(data.rows, function(type1, o1) {\r\n\t\t\t\t\t\t\t\t$.each(o1, function(key, order) {\r\n\t\t\t\t\t\t\t\t\tvar delta = 0;\r\n\t\t\t\t\t\t\t\t\tlet orderDiv = _this.makeOrderDiv(order, key, type);\r\n\t\t\t\t\t\t\t\t\tdelta +=  (type == 'in' && orderDiv.find('.label-important').length > 0) ? 1 : 0;\r\n\t\t\t\t\t\t\t\t\tlet existOrderDiv = $('#ordersList_' + type + ' .order-line[uid=\"' + key + '\"]');\r\n\t\t\t\t\t\t\t\t\tdelta -=  (type == 'in' && existOrderDiv.find('.label-important').length > 0) ? 1 : 0;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (existOrderDiv.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\texistOrderDiv.replaceWith(orderDiv);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tvar firstRow = $('#ordersList_' + type + ' div:first');\r\n\t\t\t\t\t\t\t\t\t\tif (firstRow.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t\tfirstRow.before(orderDiv);\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#ordersList_' + type).append(orderDiv);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar tmp = $('#ordersList_' + type + '_count').text();\r\n\t\t\t\t\t\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\t\t\t\t\t$('#ordersList_' + type + '_count').text(oldCount + 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (delta != 0) {\r\n\t\t\t\t\t\t\t\t\t\tvar tmp = $('#ordersList_in_fire_count').text();\r\n\t\t\t\t\t\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\t\t\t\t\tif (oldCount == 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#ordersList_in_fire_count').hide();\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#ordersList_in_fire_count').show().text(oldCount + delta);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tlet orderDiv2 = _this.makeOrderBlock(order, key, type);\r\n\t\t\t\t\t\t\t\t\tlet existOrderDiv2 = $('.orders-' + type + ' .order-block[uid=\"' + key + '\"]');\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (existOrderDiv2.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\texistOrderDiv2.replaceWith(orderDiv2);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tvar firstRow = $('.orders-' + type + ' .order-block:first');\r\n\t\t\t\t\t\t\t\t\t\tif (firstRow.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t\tfirstRow.before(orderDiv2);\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tvar op = $('.orders-' + type);\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tif (op.hasClass('mCustomScrollbar')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\top.find('.mCSB_container').append(orderDiv2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t$('.order-blocks[code=' + type + ']').mCustomScrollbar(\"update\");\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\top.append(orderDiv2);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar tmp = $('.order-type[code=' + type + '] .order-count').text();\r\n\t\t\t\t\t\t\t\t\t\tvar oldCount = (tmp.length > 0) ? parseInt(tmp) : 0;\r\n\t\t\t\t\t\t\t\t\t\t$('.order-type[code=' + type + '] .order-count').text(oldCount + 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tupdateTask(process) {}\r\n\t\r\n\tdeleteOrder(uid, iter, proc) {\r\n\t\tUtil.blockPage(Translation.translation['deleting']);\r\n\t\tvar par = {};\r\n\t\tpar[\"uid\"] = proc;\r\n\t\tpar[\"obj\"] = iter;\r\n\t\tpar[\"key\"] = uid;\r\n\t\tpar[\"cmd\"] = \"kill\";\r\n\t\tthis.app.query(par).then(() => {\r\n\t\t\t$('body').unblock();\r\n\t\t});\r\n\t}\r\n}\r\n","import {DataChecker, Util} from './util.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class PersonalPhoto {\r\n\r\n    constructor(app) {\r\n        this.app = app;\r\n    }\r\n\t\r\n    initProfile() {    \r\n        let par = {\"objId\":this.app.userId,\"attr\":'аватар'};\r\n        $.post(window.mainUrl + \"&getAttr&rnd=\" + Util.rnd(), par, function(res) {\r\n            DataChecker.checkData(res).then(res1 => {\r\n                if (res1.result) {\r\n                    $('#my-image').attr('src', \"data:image/png;base64,\" + res1.result);\r\n                }\r\n            })\r\n        }, 'json');\t\r\n    }\r\n\r\n    uploadYourImage() {\r\n        let this_ = this;\r\n        \r\n        $('#yourUpload').fileupload({\r\n            dropZone: $('#my-photo'),\r\n            pasteZone: $('#my-photo'),\r\n            url: window.mainUrl + '&width=150&height=180',\r\n            dataType: 'json',\r\n            done: function (e, data) {\r\n                if (data.result.result == 'success') {\r\n                    let par = {};\r\n                    par[\"objId\"] = this_.app.userId;\r\n                    par[\"attr\"] = 'аватар';\r\n                    $.post(window.mainUrl + \"&getAttr&rnd=\" + Util.rnd(), par, function(res1) {\r\n                        DataChecker.checkData(res1).then(res => {\r\n                            if (res.result) {\r\n                                this_.deleteOldImage();\r\n                                $('#my-image').attr('src', \"data:image/png;base64,\" + res.result);\r\n                                $('.user-image img').attr('src', \"data:image/png;base64,\" + res.result);\r\n                            } else {\r\n                                alert(Translation.translation['error'], Util.ERROR);\r\n                            }\r\n                        })\r\n                    }, 'json');\r\n                } else {\r\n                    alert(data.result.message, Util.ERROR);\r\n                }\r\n            }\r\n        }).click();\r\n    }\r\n    \r\n\r\n    deleteImage() {\r\n        let this_ = this;\r\n\r\n        let par = {};\r\n        par[\"obj\"] = \"USER\";\r\n        par[\"name\"] = 'удалить фото из ЛД';\r\n        $.post(window.mainUrl + \"&sfunc&rnd=\" + Util.rnd(), par, function(res1) {\r\n            DataChecker.checkData(res1).then(res => {\r\n                if (res.result) {\r\n                    this_.deleteOldImage();\r\n                    $('#my-image').attr('src', '');\r\n                    $('.user-image img').attr('src', \"css/img/empty-avatar-34.png\");\r\n                    \r\n                } else {\r\n                    alert(Translation.translation['error']);\r\n                }\r\n            })\r\n        }, 'json');\r\n    }\r\n\r\n    copyImageFromData() {\r\n        let this_ = this;\r\n\r\n        let par = {};\r\n        par[\"obj\"] = \"USER\";\r\n        par[\"name\"] = 'взять фото из ЛД';\r\n        $.post(window.mainUrl + \"&sfunc&rnd=\" + Util.rnd(), par, function(res1) {\r\n            DataChecker.checkData(res1).then(res2 => {\r\n                if (res2.result) {\r\n                    var par = {};\r\n                    par[\"objId\"] = this_.app.userId;\r\n                    par[\"attr\"] = 'аватар';\r\n                    $.post(window.mainUrl + \"&getAttr&rnd=\" + Util.rnd(), par, function(res3) {\r\n                        DataChecker.checkData(res3).then(res4 => {\r\n                            if (res4.result) {\r\n                                this_.deleteOldImage();\r\n                                $('#my-image').attr('src', \"data:image/png;base64,\" + res4.result);\r\n                                $('.user-image img').attr('src', \"data:image/png;base64,\" + res4.result);\r\n                            } else {\r\n                                alert(Translation.translation['error']);\r\n                            }\r\n                        })\r\n                    }, 'json');\r\n                } else {\r\n                    alert(Translation.translation['error']);\r\n                }\r\n            })\r\n        }, 'json');\r\n    }\r\n\r\n    deleteOldImage() {\r\n        let par = {\"sfunc\" : 1, \"cls\": \"ImageUtil\", \"name\": \"deleteUserImage\", \"arg0\": this.app.userId, \"arg1\": \"34\", \"arg2\": \"0\"};\r\n    \r\n        this.app.query(par).then(response => {\r\n            if (response.status === 200) {\r\n                response.json().then(json => {\r\n                    DataChecker.checkData(json).then(data => {\r\n                        if(!data) {\r\n                            console.log(\"1 ошибка при вызове метода deleteUserImage в классе ImageUtil\");\r\n                        }\r\n                    });\r\n                });\r\n            } else {\r\n                console.log(\"2 ошибка при вызове метода deleteUserImage в классе ImageUtil\");\r\n            }\r\n        });\r\n    }\r\n}","import {Util} from './util.js';\r\n\r\nexport class Ping {\r\n\tpinger;\r\n    mainUrl = \"\";\r\n    breadcrumpsVisible = true;\r\n    lostRequests = Array();\r\n    editingTable = undefined;\r\n    ifcController;\r\n    editIndex = {};\r\n\r\n\tconstructor() {\r\n        // this.mainUrl = url;\r\n        // this.ifcController = ifcController;\r\n        // this.editingTable = editingTable;\r\n\t}\r\n\t\r\n\tinit() {\r\n        this.ping();\r\n\t}\r\n\r\n    ping() {\r\n        if (this.pinger != null) clearTimeout(this.pinger);\r\n        this.pingServer();\r\n        this.pinger = setTimeout(this.ping.bind(this), 30000);\r\n    }\r\n\r\n    pingServer() {\r\n        var url = window.mainUrl + \"&ping&rnd=\" + Util.rnd();\r\n        var beginTime = (new Date).getTime();\r\n        $.post(url, function(data) {\r\n            var pingTime = (new Date).getTime() - beginTime;\r\n            $('#ping').text('' + pingTime);\r\n        }, 'json');\r\n    }\r\n\r\n}","import { Translation } from './translation.js';\nimport {Util} from './util.js';\r\nimport {NCA} from './nca.js';\n\r\nexport class Polling {\r\n\t\r\n\tapp = null;\r\n\tnoConnection = false;\r\n\tscreenBlocked = false;\r\n\treconnectTimeout = 500;\r\n\tlostRequests = Array();\r\n\t\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\r\n\tlongPolling() {\r\n\t\tlet _this = this;\r\n\t\t// Идентификатор таймаута, который должен разблокировать экран при появлении связи\r\n\t\tvar timeoutId = null;\r\n\t\t// Если связи нет\r\n\t\tif (_this.noConnection) {\r\n\t\t\t// То запускаем таймер для разблокировки экрана\r\n\t\t\ttimeoutId = setTimeout(function() {\r\n\t\t\t\t_this.noConnection = false;\r\n\t\t\t\tif (_this.screenBlocked) {\r\n\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t_this.screenBlocked = false;\r\n\t\t\t\t\t_this.reconnectTimeout = 500;\r\n\t\t\t\t}\r\n\t\t\t\tvar requests = [];\r\n\t\t\t\tfor (var i=0; i<_this.lostRequests.length; i++) {\r\n\t\t\t\t\trequests.push(_this.lostRequests[i]);\r\n\t\t\t\t}\r\n\t\t\t\t_this.lostRequests = [];\r\n\t\t\t\tfor (var i=0; i<requests.length; i++) {\r\n\t\t\t\t\tvar req = requests[i];\r\n\t\t\t\t\t_this.saveAjaxRequest(req.type, req.url, req.params, req.success, req.dataType, true);\r\n\t\t\t\t}\r\n\t\t\t\trequests = null;\r\n\t\t\t\ttimeoutId = null;\r\n\t\t\t}, 2000 + _this.reconnectTimeout);\r\n\t\t}\r\n\t\t\r\n\t\tvar par = {\"polling\": Util.rnd()};\r\n\t\t\r\n\t\t_this.app.post(par).then(data => {\r\n\t\t\t_this.processingPolling(data);\r\n\t\t\tsetTimeout(function(){_this.longPolling();}, 500);\r\n\t\t}).catch(error => {\r\n\t\t\tconsole.error(\"Long polling error: \" + error);\n\t\t\tif (error.stack)\n\t\t\t\tconsole.log(error.stack);\r\n\t\t\t// Отменяем разблокировку экрана, так как связь не появилась\r\n\t\t\tif (timeoutId != null) {\r\n\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\tif (!_this.screenBlocked) {\r\n\t\t\t\t\t_this.screenBlocked = true;\r\n\t\t\t\t\t_this.reconnectTimeout = 2000;\r\n\t\t\t\t\tUtil.blockPage(\"Соединение с сервером утеряно.<br>Попытка возобновления связи!<br>Подождите...\");\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\t// Если связь была и вдруг пропала\r\n\t\t\tif (!_this.noConnection) {\r\n\t\t\t\t_this.noConnection = true;\r\n\t\t\t}\t\t\t\r\n\t\r\n\t\t\tsetTimeout(function(){_this.longPolling();}, _this.reconnectTimeout);\r\n\t\t});\r\n\t}\r\n\t\r\n\tprocessingPolling(data) {\r\n\t\tlet _this = this;\r\n\t\tlet ifc = this.app.ifcController;\n\t\tlet nav = this.app.nav;\n\t\tlet orders = this.app.orders;\n\t\tlet notifs = this.app.notifications;\n\t\tlet nca = this.app.ncaLayer;\n\t\tlet monitor = this.app.monitor;\n\t\t\r\n\t\tif (data.commands && data.commands.length>0) {\r\n\t\t\tvar cmd;\r\n\t\t\tfor (var i=0; i<data.commands.length; i++) {\r\n\t\t\t\tcmd = data.commands[i];\r\n\t\t\t\tif (cmd) {\r\n\t\t\t\t\tif (cmd.refresh != null) {\r\n\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\tpar[\"rnd\"] = Util.rnd();\r\n\t\t\t\t\t\tpar[\"getChange\"] = \"\";\r\n\t\t\t\t\t\tifc.postAndParseData(par);\r\n\t\t\t\t\t} else if (cmd.prevUI != null) {\r\n\t\t\t\t\t\tif (cmd.prevUI == 1)\r\n\t\t\t\t\t\t\tdocument.location.hash = \"cmd=prevUI&rnd=\" + Util.rnd();\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t_this.app.nav.toActiveMain();\r\n\t\t\t\t\t} else if (cmd.main_ui != null) {\r\n\t\t\t\t\t\t_this.app.nav.toActiveMain();\r\n\t\t\t\t\t} else if (cmd.closePopupInterface != null) {\r\n\t\t\t\t\t\tif (_this.app.ifcController.popupcount > 0) {\r\n\t\t\t\t\t\t\tvar did = 'or3_popup' + (_this.app.ifcController.popupcount - 1);\r\n\t\t\t\t\t\t\tifc.showChangeMsg();\r\n\t\t\t\t\t\t\tifc.dialogResult[did] = '0';\r\n\t\t\t\t\t\t\tvar opts = $('#' + did).dialog('options');\r\n\t\t\t\t\t\t    \r\n\t\t\t\t\t\t    var par = {};\r\n\t\t\t\t\t\t\tpar[\"uid\"] = opts.uid ;\r\n\t\t\t\t\t\t\tpar[\"val\"] = cmd.closePopupInterface;\r\n\t\t\t\t\t\t\tpar[\"cmd\"] = \"closePopup\";\r\n\t\t\r\n\t\t\t\t\t\t\tifc.loadData(par, true, function(data) {\r\n\t\t\t\t\t\t\t\tif (!data.result || data.result == 'success') {\r\n\t\t\t\t\t\t\t\t\t$(\"#\" + did).dialog('destroy');\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tifc.showPopupErrors(data.errors, data.path, data.name, opts, $('#' + did), data.fatal, data.isDataIntegrityControl);\r\n\t\t\t\t\t\t\t\t\tifc.setDialogBtnsEnabled(did, true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.closeInterface != null) {\r\n\t\t\t\t\t\tifc.closeIfc();\r\n\t\t\t\t\t} else if(cmd.startProcessWrp != null){\r\n\t\t\t\t\t\t_this.app.nav.startProcess(cmd.startProcessWrp);\r\n\t\t\t\t\t} else if (cmd.showProcessUI != null) {\r\n\t\t\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\t\tif (data.infMsg) {\r\n\t\t\t\t\t\t\tUtil.alert(data.infMsg);\r\n\t\t\t\t\t \t}\r\n\t\t\t\t\t\tvar message = JSON.parse(cmd.showProcessUI);\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t_this.app.nav.showProcessUI(message)\r\n\t\t\t\t\t\t}, message.waitTime);\t\t\t\t\t\r\n\t\t\t\t\t} else if(cmd.keyPressed) {\r\n\t\t\t\t\t\tlet command = cmd.keyPressed === 'Enter'? 13:cmd.keyPressed === 'Escape'? 27: 0;\r\n\t\t\t\t\t\tif(command != 0){\r\n\t\t\t\t\t\t\tvar e = jQuery.Event(\"keydown\");\r\n\t\t\t\t\t\t\te.which = command;\r\n\t\t\t\t\t\t\te.key = cmd.keyPressed;\r\n\t\t\t\t\t\t\t$(document).trigger(e);\r\n\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (cmd.start_ui) {\r\n\t\t\t\t\t\tif (document.location.hash.indexOf(\"cmd=openTask&uid=\" + cmd.start_ui) == -1) {\r\n\t\t\t\t\t\t\tdocument.location.hash = \"cmd=openTask&uid=\" + cmd.start_ui + \"&id=\" + _this.app.nav.activeMenu + \"&rnd=\" + Util.rnd();\r\n\t\t\t\t\t\t\tif (ifc.dialogOpened) {\r\n\t\t\t\t\t\t\t\tifc.dialogResult[ifc.dialogOpened] = '0';\r\n\t\t\t\t\t\t\t\t$('#' + ifc.dialogOpened).dialog('destroy');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.next_ui) {\r\n\t\t\t\t\t\tdocument.location.hash = \"cmd=openTask&uid=\" + cmd.next_ui + \"&id=\" + _this.app.nav.activeMenuId + \"&rnd=\" + Util.rnd();\r\n\t\t\t\t\t\tif (ifc.dialogOpened) {\r\n\t\t\t\t\t\t\tifc.dialogResult[ifc.dialogOpened] = '0';\r\n\t\t\t\t\t\t\t$('#' + ifc.dialogOpened).dialog('destroy');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.open_report) {\r\n\t\t\t\t\t\tvar url = _this.app.restUrl + \"&rnd=\" + Util.rnd() + \"&cmd=opf&fn=\" + encodeURIComponent(cmd.open_report);\r\n\t\t\t\t\t\t$('#report_frame').attr('src', url);\r\n\t\t\t\t\t} else if (cmd.signString) {\r\n\t\t\t\t\t\tvar str = cmd.signString.str;\r\n\t\t\t\t\t\tvar path = cmd.signString.path;\r\n\t\t\t\t\t\tvar pass = cmd.signString.pass;\r\n\t\t\t\t\t\tvar cont = cmd.signString.cont;\r\n\t\t\t\t\t\tvar auth = (cmd.signString.auth == \"true\") || (cmd.signString.auth == true);\r\n\t\r\n\t\t\t\t\t\tgenerateUcgoSign(str, path, pass, cont, auth);\r\n\t\t\t\t\t} else if (cmd.signTextWithNCA) {\r\n\t\t\t\t\t\tvar text = cmd.signTextWithNCA.text;\r\n\t\t\t\t\t\tvar path = cmd.signTextWithNCA.path;\r\n\t\t\t\t\t\tvar pass = cmd.signTextWithNCA.pass;\r\n\t\t\t\t\t\tvar cont = cmd.signTextWithNCA.cont;\r\n\t\r\n\t\t\t\t\t\tlet xml = '<signTextWithNCA><signText>' + Util.b64EncodeUnicode(text) + '</signText></signTextWithNCA>';\n\t\t\t\t\t\tnca.signXml(NCA.COMMON, NCA.SIGN, xml).then(data2 => {\n\t\t\t\t\t\t\tif (data2.responseObject) {\n\t\t\t\t\t\t\t\tlet signedData = data2.responseObject;\n\t\t\t\t\t\t\t\tvar par = {\n\t\t\t\t\t\t\t\t\tcmd: \"signTexWithNCAResult\",\n\t\t\t\t\t\t\t\t\tsignedData: signedData,\n\t\t\t\t\t\t\t\t\tsignText: text,\n\t\t\t\t\t\t\t\t\tsignDate: (new Date).getTime(),\n\t\t\t\t\t\t\t\t\trnd: Util.rnd()\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t_this.app.post(par)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlet error = (data2.message === 'action.canceled')\n\t\t\t\t\t\t\t\t\t? 'Действие отменено пользователем'\n\t\t\t\t\t\t\t\t\t: 'Код ошибки: ' + data2.code + ' Сообщение: ' + data2.message;\n\t\t\t\t\t\t\t\tconsole.error(\"msg text: \" + error);\n\t\t\t\t\t\t\t\tUtil.alert(error, Util.ERROR);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar par = {cmd: \"signTexWithNCAResult\", error: \"Подписание текста не выполнено!\"};\n\t\t\t\t\t\t    \t_this.app.post(par)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, error => {\n\t\t\t\t\t\t\tconsole.error(\"error text: \" + error);\n\t\t\t\t\t\t\tUtil.alert(error, Util.ERROR);\n\t\t\t\t\t\t\tvar par = {cmd: \"signTexWithNCAResult\", error: \"Подписание текста не выполнено!\"};\n\t\t\t\t\t    \t_this.app.post(par)\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else if (cmd.getFile) {\r\n\t\t\t\t\t\tif (document.getElementById('getFile') == null) {\r\n\t\t\t\t\t\t\tvar dialogDiv = $('<div />', {'class': 'easyui-dialog', 'id': 'getFile'}); \r\n\t\t\t\t\t\t\tdialogDiv.html('<div style=\\\"padding: 20px\\\"><input id=\\\"chooser\\\" type=\\\"file\\\" onchange=\\\"sendFile();\\\" style=\\\"display:none;\\\"><input id=\\\"chooserBtn\\\" type=\\\"button\\\" value=\\\"Выбрать\\\" style=\\\"width:100px; height:25px;\\\"></div>');\r\n\t\t\t\t\t\t\tdialogDiv.dialog({\r\n\t\t\t\t\t\t\t\ttitle:'Выбор файла',\r\n\t\t\t\t\t\t\t\tclosed: true,\r\n\t\t\t\t\t\t\t\tdraggable: false,\r\n\t\t\t\t\t\t\t\tresizable: false,\r\n\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\tmodal:true,\r\n\t\t\t\t\t\t\t\tclosable: false,\r\n\t\t\t\t\t\t\t\tbuttons:[{text:'Закрыть', id: 'closeDialog', handler:function(){ifc.sendFile();}}]\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$(\"#chooserBtn\").click(function() {\r\n\t\t\t\t\t\t\t\t$(\"#chooser\").click();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar chooserElement = $(\"#chooser\");\r\n\t\t\t\t\t\tchooserElement.replaceWith(chooserElement.val('').clone(true));\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\t$('#getFile').dialog(\"open\");\r\n\t\t\t\t\t} else if (cmd.generateUcgoPKCS10) {\r\n\t\t\t\t\t\tvar str = cmd.generateUcgoPKCS10.str;\r\n\t\t\t\t\t\tvar auth = (cmd.generateUcgoPKCS10.auth == \"true\") || (cmd.generateUcgoPKCS10.auth == true);\r\n\t\t\t\t\t\tgenerateUcgoPKCS10(str, auth);\r\n\t\t\t\t\t} else if (cmd.generateUcgoPKCS7) {\r\n\t\t\t\t\t\tvar str = cmd.generateUcgoPKCS7.str;\r\n\t\t\t\t\t\tvar auth = (cmd.generateUcgoPKCS7.auth == \"true\") || (cmd.generateUcgoPKCS7.auth == true);\r\n\t\t\t\t\t\tgenerateUcgoPKCS7(str, auth);\r\n\t\t\t\t\t} else if (cmd.saveUcgoCertificate) {\r\n\t\t\t\t\t\tvar cert = cmd.saveUcgoCertificate.cert;\r\n\t\t\t\t\t\tvar reader = cmd.saveUcgoCertificate.reader;\r\n\t\t\t\t\t\tvar uid = cmd.saveUcgoCertificate.uid;\r\n\t\t\t\t\t\tvar tokPD = cmd.saveUcgoCertificate.tokpd;\r\n\t\t\t\t\t\tsaveUcgoCertificate(cert, reader, uid, tokPD);\r\n\t\t\t\t\t} else if (cmd.haveUcgoCertificate) {\r\n\t\t\t\t\t\tvar reader = cmd.haveUcgoCertificate.reader;\r\n\t\t\t\t\t\tvar uid = cmd.haveUcgoCertificate.uid;\r\n\t\t\t\t\t\tvar tokPD = cmd.haveUcgoCertificate.tokpd;\r\n\t\t\t\t\t\thaveUcgoCertificate(reader, uid, tokPD);\r\n\t\t\t\t\t} else if (cmd.selectUcgoCertificate) {\r\n\t\t\t\t\t\tvar iin = cmd.selectUcgoCertificate.iin;\r\n\t\t\t\t\t\tvar bin = cmd.selectUcgoCertificate.bin;\r\n\t\t\t\t\t\tselectUcgoCertificate(iin, bin);\r\n\t\t\t\t\t} else if (cmd.deleteUcgoCertificate) {\r\n\t\t\t\t\t\tdeleteUcgoCertificate(cmd.deleteUcgoCertificate);\r\n\t\t\t\t\r\n\t\t\t\t\t// подключение к веб-сокету для работы с ПО ЭЦП УЦГО\r\n\t\t\t\t\t} else if (cmd.connectUcgoWebsocket) {\r\n\t\t\t\t\t\tconnectTamurSocket(true);\r\n\t\t\t\t\t} else if (cmd.showErrors) {\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\tif (ifc.dialogOpened){\r\n\t\t\t\t\t\t\tifc.setDialogBtnsEnabled(ifc.dialogOpened, true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (cmd.showErrors.btnEdt && cmd.showErrors.btnIgn){\r\n\t\t\t\t\t\t\tifc.showForceErrors(cmd.showErrors.errors, cmd.showErrors.fatal == 0, cmd.showErrors.path, cmd.showErrors.name, cmd.showErrors.btnIgn, cmd.showErrors.btnEdt);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tifc.showForceErrors(cmd.showErrors.errors, cmd.showErrors.fatal == 0, cmd.showErrors.path, cmd.showErrors.name, Translation.translation['ignore']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.connectScanWebsocket) {\r\n\t\t\t\t\t\tscan_connectSocket(null);\r\n\t\t\t\t\t} else if (cmd.disconnectScanWebsocket) {\r\n\t\t\t\t\t\tscan_disconnectSocket();\r\n\t\t\t\t\t} else if (cmd.startScan) {\r\n\t\t\t\t\t\tvar id = cmd.startScan.id;\r\n\t\t\t\t\t\tstartScan(id);\r\n\t\t\t\t\t} else if (cmd.openClientFiles) {\r\n\t\t            \t\r\n\t\t\t\t\t\tvar id = cmd.openClientFiles.id;\r\n\t\t\t\t\t\tvar windowTitle = cmd.openClientFiles.windowTitle;\r\n\t\t\t\t\t\tvar buttonTitle = cmd.openClientFiles.buttonTitle;\r\n\t\t\t\t\t\tvar dir = cmd.openClientFiles.dir;\r\n\t\t\t\t\t\tvar extensions = cmd.openClientFiles.extensions;\r\n\t\t\t\t\t\tvar description = cmd.openClientFiles.description;\r\n\t\r\n\t\t\t\t\t\tscan_openClientFiles(id, windowTitle, buttonTitle, dir, extensions, description);\r\n\t\t\t\t\t} else if (cmd.loadClientFile) {\r\n\t\t\t\t\t\tvar id = cmd.loadClientFile.id;\r\n\t\t\t\t\t\tvar path = cmd.loadClientFile.path;\r\n\t\t\t\t\t\tscan_loadClientFile(id, path);\r\n\t\t\t\t\t} else if (cmd.saveFileOnClient) {\r\n\t\t\t\t\t\tvar id = cmd.saveFileOnClient.id;\r\n\t\t\t\t\t\tvar path = cmd.saveFileOnClient.path;\r\n\t\t\t\t\t\tvar data = cmd.saveFileOnClient.data;\r\n\t\t\t\t\t\tscan_saveFileOnClient(id, path, data);\r\n\t\t\t\t\t} else if (cmd.showOptions) {\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\tifc.showOptions(cmd.showOptions.options);\r\n\t\t\t\t\t} else if (cmd.confirm) {\r\n\t\t\t\t\t\tUtil.confirmMessage(cmd.confirm);\r\n\t\t\t\t\t} else if (cmd.alert != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alert, 0, false);\r\n\t\t\t\t\t} else if (cmd.logout) {\r\n\t\t\t\t\t\tUtil.logout();\r\n\t\t\t\t\t} else if (cmd.notification) {\r\n\t\t\t\t\t\tnotifs.notificationsProcessing(cmd.notification);\r\n\t\t\t\t\t\tUtil.playNoteSound(); \r\n\t\t\t\t\t} else if (cmd.updateNotifications) {\r\n\t\t\t\t\t\tnotifs.loadNotifications2();\r\n\t\t\t\t\t} else if (cmd.deleteNotifications) {\r\n\t\t\t\t\t\tnotifs.deleteNotifications(cmd.deleteNotifications.objids);\r\n\t\t\t\t\t} else if (cmd.alertAndDrop) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertAndDrop, 0, true, true);\r\n\t\t\t\t\t} else if (cmd.alertError != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertError, Util.ERROR, false, false);\r\n\t\t\t\t\t} else if (cmd.alertWarning != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertWarning, Util.WARNING, false, false);\r\n\t\t\t\t\t} else if (cmd.alertInfoFlow != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertInfoFlow, 0, true);\r\n\t\t\t\t\t} else if (cmd.alertErrorFlow != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertErrorFlow, Util.ERROR, true, false);\r\n\t\t\t\t\t} else if (cmd.alertWarningFlow != null) {\r\n\t\t\t\t\t\tUtil.alert(cmd.alertWarningFlow, Util.WARNING, true, false);\r\n\t\t\t\t\t} else if (cmd.slide) {\r\n\t\t\t\t\t\tUtil.slide(cmd.slide);\r\n\t\t\t\t\t} else if (cmd.showWaiting) {\r\n\t\t\t\t\t\tdocument.body.style.cursor = 'wait';\r\n\t\t\t\t\t\tUtil.blockPage(cmd.showWaiting);\r\n\t\t\t\t\t} else if (cmd.closeWaiting) {\r\n\t\t\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t} else if (cmd.disableCancelBtn) {\r\n\t\t\t\t\t\tifc.hideChangeMsg();\r\n\t\t\t\t\t} else if (cmd.nodeType) {\r\n\t\t\t\t\t\t$('#nextBtn').linkbutton({text: cmd.nodeType});\r\n\t\t\t\t\t} else if(cmd.makeTreeTable){\r\n\t\t\t\t\t\tifc.makeTreeTable(cmd.makeTreeTable);\r\n\t\t\t\t\t} else if (cmd.cursor) {\r\n\t\t\t\t\t\tif (cmd.cursor == \"0\") {\r\n\t\t\t\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\t\t\t\t$('body').unblock();\r\n\t\t\t\t\t\t} else if (cmd.cursor == \"1\") {\r\n\t\t\t\t\t\t\tdocument.body.style.cursor = 'wait';\r\n\t\t\t\t\t\t\tUtil.blockPage();\r\n\t\t\t\t\t\t} else if (cmd.cursor == \"2\") {\r\n\t\t\t\t\t\t\tdocument.body.style.cursor = 'pointer';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.stack) {\r\n\t\t\t\t\t\tnav.showStack(cmd.stack);\r\n\t\t\t\t\t} else if (cmd.hideFullPath) {\r\n\t\t\t\t\t\t$(\"#fullPath\").hide();\r\n\t\t\t\t\t} else if (cmd.deleteTask) {\r\n\t\t\t\t\t\tmonitor.deleteTask(cmd.deleteTask);\r\n\t\t\t\t\t} else if (cmd.addTask) {\r\n\t\t\t\t\t\tmonitor.addTask(cmd.addTask);\r\n\t\t\t\t\t} else if (cmd.updateTask) {\r\n\t\t\t\t\t\tmonitor.updateTask(cmd.updateTask);\r\n\t\t\t\t\t} else if (cmd.deleteOrders) {\r\n\t\t\t\t\t\torders.deleteOrders(cmd.deleteOrders);\n\t\t\t\t\t\tnotifs.deleteNotification(cmd.deleteOrders);\r\n\t\t\t\t\t} else if (cmd.updateOrders) {\r\n\t\t\t\t\t\torders.updateOrders(cmd.updateOrders);\n\t\t\t\t\t\tnotifs.updateNotification(cmd.updateOrders);\r\n\t\t\t\t\t} else if (cmd.reload) {\r\n\t\t\t\t\t\tifc.reload(cmd.reload);\r\n\t\t\t\t\t} else if (cmd.hideSend) {\r\n\t\t\t\t\t\tif (cmd.hideSend == \"0\"){\r\n\t\t\t\t\t\t\t$('#nextBtn').hide();\r\n\t\t\t\t\t\t} else if (cmd.hideSend == \"1\") {\r\n\t\t\t\t\t\t\t$('#nextBtn').show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.hideSave) {\r\n\t\t\t\t\t\tif (cmd.hideSave == \"0\"){\r\n\t\t\t\t\t\t\t$('#saveBtn').hide();\r\n\t\t\t\t\t\t} else if (cmd.hideSave == \"1\"){\r\n\t\t\t\t\t\t\t$('#saveBtn').show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.hideCancel) {\r\n\t\t\t\t\t\tif (cmd.hideCancel == \"0\"){\r\n\t\t\t\t\t\t\t$('#cancelBtn').hide();\r\n\t\t\t\t\t\t} else if (cmd.hideCancel == \"1\") {\r\n\t\t\t\t\t\t\t$('#cancelBtn').show();\r\n\t\t\t\t\t\t} else if (cmd.hideCancel == \"2\") {\r\n\t\t\t\t\t\t\t$('#cancelBtn').show();\r\n\t\t\t\t\t\t\t$('#cancelBtn').linkbutton('enable');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t//} else if (cmd.readIdCard) {\r\n\t\t\t\t\t//\treadIdCard();\r\n\t\t\t\t\t//} else if (cmd.loadApplet) {\r\n\t\t\t\t\t//\tloadApplet(cmd.loadApplet);\r\n\t\t\t\t\t} else if (cmd.openArh) {\r\n\t\t\t\t\t\tnav.openArchive(cmd.openArh);\r\n\t\t\t\t\t} else if (cmd.openDocument) {\r\n\t\t\t\t\t\tUtil.openDocument(cmd.openDocument);\r\n\t\t\t\t\t} else if (cmd.askPassword) {\r\n\t\t\t\t\t\tUtil.askPassword(function(res) {\r\n\t\t\t\t\t\t\tif (res != null)\r\n\t\t\t\t\t\t\t\tpost({\"promptRes\":res, \"promptAction\":1});\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tpost({\"promptAction\":0});\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}, cmd.askPassword);\r\n\t\t\t\t\t} else if(cmd.setSelectedTab){\t\t\t\t\t\r\n\t\t\t\t\t\tvar compUid = cmd.setSelectedTab.split(',')[0];\r\n\t\t\t\t\t\tvar index = parseInt(cmd.setSelectedTab.split(',')[1]);\r\n\t\t\t\t\t\tif($('#'+compUid).hasClass('easyui-tabs')){\r\n\t\t\t\t\t\t\t$('#'+compUid).tabs('select', index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cmd.setMultiSelection) {\r\n\t\t\t\t\t\tlet compUid = cmd.setMultiSelection.split(',')[0];\r\n\t\t\t\t\t\tlet multi = cmd.setMultiSelection.split(',')[1] === 'true';\r\n\t\t\t\t\t\tconsole.log(\"workworkwork1\", compUid);\r\n\t\t\t\t\t\tif (ifc.multiSelection[compUid]) {\r\n\t\t\t\t\t\t    ifc.multiSelection[compUid] = multi;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tifc.multiSelection[compUid] = multi;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} \r\n\t}\r\n\t\r\n\tsaveAjaxRequest(type, url, params, success, dataType, async) {\r\n\t\tparams[\"rnd\"] = Util.rnd();\r\n\t\tparams[\"guid\"] = guid;\r\n\t\r\n\t\tfetch(this.restUrl, {\r\n\t\t\tmethod: type,\r\n\t    \tcredentials: 'include',\r\n\t\t\tbody: $.param(params)\r\n\t    }).then(response => {\r\n\t\t\tsuccess(response);\r\n\t\t}, () => {\r\n\t\t\tconsole.error('Rejected');\r\n\t\t\tif (async)\r\n\t\t\t\tlostRequests.push(new LostRequest(type, url, params, success, dataType));\r\n\t\t}).catch(error => {\r\n\t\t\tconsole.error('Error:', error);\r\n\t\t\tif (async)\r\n\t\t\t\tlostRequests.push(new LostRequest(type, url, params, success, dataType));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class LostRequest {\r\n\ttype = null;\r\n\turl = null;\r\n\tparams = null;\r\n\tsuccess = null;\r\n\tdataType = null;\r\n\t\r\n\tconstructor(type, url, params, success, dataType) {\r\n\t\tthis.type = type;\r\n\t\tthis.url = url;\r\n\t\tthis.params = params;\r\n\t\tthis.success = success;\r\n\t\tthis.dataType = dataType;\r\n\t}\r\n}","import {DataChecker} from './util.js';\r\nimport { Util } from './util.js';\r\n\r\nexport class Processes {\r\n\tsearchProcess = \"\";\r\n\tSearchText;\r\n    SearchCount = 0;\r\n\theightRange = 40;\r\n\tstyledInputElement;\r\n\tstyledElement;\r\n\r\n\torderStatus = [\"label-success\", \"label-warning\", \"label-important\", \"label-info\"];\r\n\timgExt = \".png\";\r\n\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tfindOfWordsAutocomplete() {\r\n\t\tconsole.log(\"findOfWordsAutocomplete\");\r\n\t}\r\n\r\n\tinit() {\r\n\t\tlet this_ = this;\r\n\t\t$('#processesList_Layout').layout();\r\n\r\n\t\t// $( \"#processSearchPage\" ).autocomplete({\r\n\t\t// \tsource:  this_.findOfWordsAutocomplete(),\r\n\t\t// });\r\n\r\n\t\t$(\"body\").on('keypress', '#processSearchPage', function(e) {\r\n\t\t\tvar key = e.which || e.keyCode;\r\n\t\t\tif (key === 13) {\r\n\t\t\t\tthis_.searchProcess = $(this).val();\r\n\t\t\t\tif(this_.SearchText == this_.searchProcess){\r\n\t\t\t\t\tthis_.SearchCount++;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tthis_.SearchText = this_.searchProcess;\r\n\t\t\t\t\tthis_.SearchCount = 0;\r\n\t\t\t\t}\r\n\t\t\t\tvar par = {\"cmd\":\"searchProcess\",\"text\":this_.searchProcess, \"index\": this_.SearchCount};\r\n\t\t\t\tthis_.post(par, function (data){\r\n\t\t\t\t\tDataChecker.checkData(data).then(json => {\r\n\t\t\t\t\t\tif(data.parent) {\r\n\t\t\t\t\t\t\tvar arr = data.parent.split(\",\").reverse();\r\n\t\t\t\t\t\t\tvar procUid = arr.pop();\r\n\t\t\t\t\t\t\tvar point = procUid.indexOf('.') + 1;\r\n\t\t\t\t\t\t\tvar procElId = 'processess' + procUid.substring(point);\r\n\t\t\t\t\t\t\tvar col = arr.length-1;\r\n\t\t\t\t\t\t\tvar element;\r\n\t\t\t\t\t\t\tif(col == 1) {\r\n\t\t\t\t\t\t\t\tvar node = $('#processTree').tree('find', arr[1]);\r\n\t\t\t\t\t\t\t\tif(node != null) {\r\n\t\t\t\t\t\t\t\t\t$('#processTree').tree('select', node.target);\r\n\t\t\t\t\t\t\t\t\tvar nodeTopPos = node.target.offsetTop;\r\n\t\t\t\t\t\t\t\t\tvar treeElement = document.getElementById('processesList_Tree');\r\n\t\t\t\t\t\t\t\t\tif(treeElement)\r\n\t\t\t\t\t\t\t\t\ttreeElement.scrollTop = nodeTopPos - (treeElement.offsetHeight - this_.heightRange);\r\n\t\t\t\t\t\t\t\t\tthis_.selectProcess(node, function() {\r\n\t\t\t\t\t\t\t\t\t\telement = document.getElementById(procElId);\r\n\t\t\t\t\t\t\t\t\t\tif(element){\r\n\t\t\t\t\t\t\t\t\t\t\telement.style.boxShadow = \"0px 0px 5px blue\";\r\n\t\t\t\t\t\t\t\t\t\t\tthis_.styledElement = element;\r\n\t\t\t\t\t\t\t\t\t\t\tvar atag = element.getElementsByTagName(\"A\")[0];\r\n\t\t\t\t\t\t\t\t\t\t\tif(atag){\r\n\t\t\t\t\t\t\t\t\t\t\t\tatag.style.color = \"blue\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis_.styledInputElement = atag;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tvar topPos = element.offsetTop;\r\n\t\t\t\t\t\t\t\t\t\t\tvar outerElement = document.getElementById('processesList_body');\r\n\t\t\t\t\t\t\t\t\t\t\tif(outerElement)\r\n\t\t\t\t\t\t\t\t\t\t\touterElement.scrollTop = topPos - (outerElement.offsetHeight - element.offsetHeight);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor(var i = 1; i < col; i++) {\r\n\t\t\t\t\t\t\t\t\tthis_.searchProcCallLater('expand', arr[i], 5);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis_.searchProcCallLater('select', arr[col], 5, function(){\r\n\t\t\t\t\t\t\t\t\telement = document.getElementById(procElId);\r\n\t\t\t\t\t\t\t\t\tif(element){\r\n\t\t\t\t\t\t\t\t\t\telement.style.boxShadow = \"0px 0px 5px blue\";\r\n\t\t\t\t\t\t\t\t\t\tthis_.styledElement = element;\r\n\t\t\t\t\t\t\t\t\t\tvar atag = element.getElementsByTagName(\"A\")[0];\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif(atag){\r\n\t\t\t\t\t\t\t\t\t\t\tatag.style.color = \"blue\";\r\n\t\t\t\t\t\t\t\t\t\t\tthis_.styledInputElement = atag;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tvar topPos = element.offsetTop;\r\n\t\t\t\t\t\t\t\t\t\tvar outerElement = document.getElementById('processesList_body');\r\n\t\t\t\t\t\t\t\t\t\tif(outerElement)\r\n\t\t\t\t\t\t\t\t\t\touterElement.scrollTop = topPos - (outerElement.offsetHeight - element.offsetHeight);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis_.app.lang == \"kz\" ? alert(\"Еш нәрсе табылмады!\") : alert(\"Ничего не найдено!\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$('#processTree').tree({\r\n\t\t\tonClick: function(node){\r\n\t\t\t\tthis_.selectProcess(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\t\r\n\t\t$(\"body\").on('click', '#processesList_body .proc', function() {\r\n\t\t\tvar procId = $(this).attr(\"procId\");\r\n\t\t\tthis_.app.nav.startProcess(procId);\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('click', '#freqUsedProcs .process', function() {\r\n\t\t\tvar procId = $(this).attr(\"uid\");\r\n\t\t\tthis_.app.nav.startProcess(procId);\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '#processesList_body .proc .icon-remove-favourite', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\t\r\n\t\t\tthis_.removeFromFavourite($(this));\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('click', '#processesList_body .proc .icon-add-favourite', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\t\r\n\t\t\tthis_.addToFavourite($(this));\r\n\t\t});\r\n\t}\r\n\t\r\n\tselectProcess(node, func) {\r\n\t\tlet this_ = this;\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet par = {\"cmd\": \"getProcessData\", \"leaf\": 1, \"id\": node.id};\r\n\t\t\t\r\n\t\t\tthis.app.query(par).then(response => {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tresponse.json().then(data => {\r\n\t\t\t\t\t\t$('#processesList_body').html(\"\");\r\n\t\t\t\t\t\t$.each(data, function(e, proc) {\r\n\t\t\t\t\t\t\tvar u = proc.id.indexOf(\".\");\r\n\t\t\t\t\t\t\tvar key = proc.id.substring(u+1);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar fav = (proc.favourite)\r\n\t\t\t\t\t\t\t\t\t\t? \"<i class='icon-remove-favourite' uid='\" + key + \"'></i>\"\r\n\t\t\t\t\t\t\t\t\t\t: \"<i class='icon-add-favourite' uid='\" + key + \"'></i>\";\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar fontWeight = proc.fontWeight ? \"font-weight:bold;\" : \"\";\r\n\t\t\t\t\t\t\t$('#processesList_body').append(\"<div time = '\" + proc.time + \"' desc = '\" + proc.procDesc + \"'id='processess\" + key \r\n\t\t\t\t\t\t\t\t+ \"' class='proc' procId='\" + proc.id + \"'>\"\r\n\t\t\t\t\t\t\t\t+ fav\r\n\t\t\t\t\t\t\t\t+ \"<span class='ico_proc ico_\" + proc.id.replace('.', '_') + \"'></span>\"\r\n\t\t\t\t\t\t\t\t+ \"<a style='\"+fontWeight+\"'>\" + proc.title + \"</a></div> \");\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.addProcIcon('#processesList_body .proc.ico_' + proc.id.replace('.', '_'), this_.app.restUrl + '/jsp/media/css/or3/'+proc.id.replace('.', '_')+this_.imgExt);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis_.attachProcessTooltips('processess'+key);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(func) {\r\n\t\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\taddProcIcon(className, src) {\r\n\t\tlet this_ = this;\r\n\t\tvar img = new Image();\r\n\t\timg.onload = function() {\r\n\t\t\tthis_.addStyle(className+' {background-image: url('+src+') !important}');\r\n\t\t};\r\n\t\timg.src = src;\r\n\t}\r\n\t\r\n\taddStyle(st) {\r\n\t    var style = document.createElement('style');\r\n\t\tstyle.type = 'text/css';\r\n\t\tstyle.innerHTML = st;\r\n\t\tdocument.getElementsByTagName('head')[0].appendChild(style);\r\n\t}\r\n\t\r\n\tattachProcessTooltips(proc_id) {\r\n\t\t\r\n\t}\r\n\t\r\n\taddToFavourite(elem) {\r\n\t\tvar procId = elem.parent().attr(\"procId\");\r\n\t\tvar par = {cmd: 'addToFavorites', processUID: procId,  json: 1};\r\n\t\tthis.app.query(par);\r\n\t\t\r\n\t\telem.removeClass('icon-add-favourite').addClass('icon-remove-favourite');\r\n\t\t\r\n\t\tvar html = '<div class=\"process\" uid=\"' + procId + '\">';\r\n\t\thtml += '<i class=\"icon-left icon-vacation\"/>';\r\n\t\thtml += '<span>' + elem.parent().find('a').text() + '</span>';\r\n\t\thtml += '<i class=\"icon-right icon-arrow-right\" />';\r\n\t\thtml += '</div>';\r\n\t\t\r\n\t\t$('#freqUsedProcs .portletBody').append($(html));\r\n\t\t\t\t\r\n\t}\r\n\t\r\n\tremoveFromFavourite(elem) {\r\n\t\tvar procId = elem.parent().attr(\"procId\");\r\n\t\tvar par = {cmd: 'removeFromFavorites', processUID: procId,  json: 1};\r\n\t\tthis.app.query(par);\r\n\t\t\r\n\t\telem.removeClass('icon-remove-favourite').addClass('icon-add-favourite');\r\n\t\t$('#freqUsedProcs .process[uid=\"' + procId + '\"]').remove();\r\n\t}\r\n\r\n\r\n\t// добавил Жаркын\r\n\tpost(par, func) {\r\n        this.saveAsyncPostRequest(window.mainUrl, par, func, func != null ? 'json' : null);\r\n    }\r\n\r\n    saveAsyncPostRequest(url, params, success, dataType) {\r\n        params[\"rnd\"] = Util.rnd();\r\n        params[\"guid\"] = guid;\r\n    \r\n        $.post(url, params, success, dataType).fail(function() {\r\n            // Добавляем запрос в хранилище необработанных запросов\r\n            // lostRequests.push(new LostRequest(\"POST\", url, params, success, dataType));\r\n        });\r\n    }\r\n\r\n\tsearchProcCallLater(name, id, count, func) {\r\n        //console.log(\"Count = \" + count);\r\n        var node = $('#processTree').tree('find', id);\r\n        if (node != null) {\r\n            $('#processTree').tree(name, node.target);\r\n            if(name === 'select') {\r\n                var nodeTopPos = node.target.offsetTop;\r\n                var treeElement = document.getElementById('processesList_Tree');\r\n                if(treeElement)\r\n                treeElement.scrollTop = nodeTopPos - (treeElement.offsetHeight - this.heightRange);\r\n                this.selectProcess(node, func);\r\n            }\r\n            return;\r\n        } else if (count > 0) {\r\n            let _this = this;\r\n            count--;\r\n            setTimeout(function(){_this.searchProcCallLater(name, id, count, func);}, 300);\r\n        }\r\n    \r\n    }\r\n}","import {EventOps} from './events.js';\r\nimport {Util} from './util.js';\r\nimport {Translation} from './translation.js';\r\nimport {TooltipOps} from './tooltip.js';\r\n\r\nexport class TableOps {\r\n\t\r\n\tstatic heightRange = 40;\r\n\t\r\n\teditIndex = {};\r\n\teditingTable = undefined;\r\n\tfocusedTable = undefined;\r\n\t\r\n\tselectedRow = [];\r\n\tclickedGrid = \"\";\r\n\t\r\n\tselectedTree = null;\r\n\tsearchTreeId = null;\r\n\tsearchTreeVal = null;\r\n\tfoundNodes = null;\r\n\tblockDlg = false;\r\n\t\r\n\tfirstShiftIndex = -1;\r\n\tlastShiftIndex = -1;\r\n\r\n\t_child = null;\r\n\tcurrentSelectedId = '';\r\n\r\n\t_searchText = null;\r\n\t_searchCount = 0;\r\n\t_lastId = -1;\r\n\tlastHiLitTreeElement = null;\r\n\tlastHiLitTreeTableElement = null;\r\n\tlastHighlightedNode = null;\r\n\r\n\tisOnCheck = true;\r\n\tnodeParent = false;\r\n\ttablesToReloadMap = {};\r\n\r\n\tconstructor(app) {\r\n\t\tthis.app = app;\r\n\t}\r\n\t\r\n\tinitDefaults(ifc) {\r\n\t\tlet _this = this;\r\n\t\tthis._child = ifc;\r\n\t\t\r\n\t\t$(\"body\").on('keypress', '.tree-search', function(e) {\r\n\t\t\tvar key = e.which || e.keyCode;\r\n\t\t\tif (key === 13 || key === 10) {\r\n\t\t\t\tvar treeId = $(this).attr('id').substring(1);\r\n\t\t\t\tvar str = $(this).val();\r\n\t\t\t\t_this._lastId = -1;\r\n\t\t\t\t_this.searchTreeId = treeId;\r\n\t\t\t\t_this.searchTreeVal = str;\r\n\t\t\t\t_this.findNode(treeId, str, false);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('keypress', '.treefield-search', function(e) {\r\n\t\t\tvar key = e.which || e.keyCode;\r\n\t\t\tif (key === 13 || key === 10) {\r\n\t\t\t\tif(!_this.blockDlg){\r\n\t\t\t\t\tvar treeId = $(this).attr('id').substring(1);\r\n\t\t\t\t\tvar str = $(this).val();\r\n\t\t\t\t\t_this._lastId = -1;\r\n\t\t\t\t\t_this.searchTreeId = treeId;\r\n\t\t\t\t\t_this.searchTreeVal = str;\r\n\t\t\t\t\t_this.findNode(treeId, str, true,  $(this).parent().parent());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(\"body\").on('keypress', '.treetable-search', function(e) {\r\n\t\t\tvar key = e.which || e.keyCode;\r\n\t\t\tif (key === 13 || key === 10) {\r\n\t\t\t\tvar treeId = $(this).attr('id').substring(1);\r\n\t\t\t\tvar str = $(this).val();\r\n\t\t\t\t_this.lastFoundId = -1;\r\n\t\t\t\t_this.searchTreeId = treeId;\r\n\t\t\t\t_this.searchTreeVal = str;\r\n\t\t\t\t_this.findTreeTableNode(treeId, str);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t$(\"body\").on('keyup', \".table-search\", function(e) {\r\n\t\t\tif (e.which && e.which == 13) {\r\n\t\t\t\tvar treeId = $(this).attr('id').substring(1);\r\n\t\t\t\tvar str = $(this).val();\r\n\t\t\t\t_this.lastFoundId = -1;\r\n\t\t\t\t_this.searchTreeId = treeId;\r\n\t\t\t\t_this.searchTreeVal = str;\r\n\t\t\t\t_this.findTableNode(treeId, str);\r\n\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$.fn.datagrid.defaults.onLoadSuccess = function(rData) {\r\n\t\t\tvar uid = $(this).attr(\"id\");\r\n\t\t\tdelete _this.tablesToReloadMap[uid];\r\n\t\t\t\r\n\t\t\tTooltipOps.addDatagridTooltip($(this));\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.datagrid.defaults.onLoadError = function() {\r\n\t\t\tvar uid = $(this).attr(\"id\");\r\n\t\t\tdelete _this.tablesToReloadMap[uid];\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.datagrid.defaults.onBeforeLoad = function() {\r\n\t\t\tvar isVisible = $(this).parents('.easyui-tabs').length == 0 // нету радительских табов\r\n\t\t\t\t\t\t\t|| ($(this).parents('.tabs-panels').length == $(this).parents('.easyui-tabs').length \t\t\t\t// или все табы распарсены \r\n\t\t\t\t\t\t\t&& $(this).parents('.tabs-panels>.panel:visible').length == $(this).parents('.tabs-panels').length); // и видимы\r\n\t\t\r\n\t\t\tvar uid = $(this).attr(\"id\");\r\n\t\t\t\r\n\t\t\tif (isVisible && (_this.tablesToReloadMap[uid] == null || _this.tablesToReloadMap[uid] == 0)) {\r\n\t\t\t\t_this.tablesToReloadMap[uid] = 1;\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tif (_this.tablesToReloadMap[uid] == null)\r\n\t\t\t\t\t_this.tablesToReloadMap[uid] = 0;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t$.extend($.fn.datagrid.methods, {\r\n\t\t\teditCell: function(jq,p) {\r\n\t\t\t\treturn jq.each(function(){\r\n\t\t\t\t\tvar table = $(this);\r\n\t\t\t\t\tvar realIndex = _this.globalIndex($(this), p.index);\r\n\t\t\t\t\tp.realIndex = realIndex;\r\n\t\t\t\t\tvar fields = table.datagrid('getColumnFields',true).concat(table.datagrid('getColumnFields'));\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (var i=0; i < fields.length; i++) {\r\n\t\t\t\t\t\tvar colOpt = $(this).datagrid('getColumnOption', fields[i]);\r\n\t\t\t\t\t\tif (fields[i] == p.field) {\r\n\t\t\t\t\t\t\tvar id = $(this).attr(\"id\");\r\n\r\n\t\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\t\tpar[\"uid\"] = id;\r\n\t\t\t\t\t\t\tpar[\"row\"] = realIndex;\r\n\t\t\t\t\t\t\tpar[\"cuid\"] = p.field;\r\n\t\t\t\t\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\t\t\t\t\tpar[\"com\"] = \"getEditor\";\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_this.app.post(par).then(res => {\r\n\t\t\t\t\t\t\t\tif (res.tree) {\r\n\t\t\t\t\t\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t\t\t\t\t\t_this.openTree(id, res.title, realIndex, p.field);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else if (res.popup) {\r\n\t\t\t\t\t\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t\t\t\t\t\t_this.openPopup(id, realIndex, p.field);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else if (res.type) {\r\n\t\t\t\t\t\t\t\t\tlet colOpt = table.datagrid('getColumnOption', p.field);\r\n\t\t\t\t\t\t\t\t\tcolOpt.editor = res;\r\n\r\n\t\t\t\t\t\t\t\t\ttable.datagrid('beginEdit', p.index);\r\n\t\t\t\t\t\t\t\t\tvar col = $('[field=\"' + p.field + '\"]');\r\n\t\t\t\t\t\t\t\t\tif (col.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\tvar ed = col.find('.numberbox .textbox-text');\r\n\t\t\t\t\t\t\t\t\t\tif (ed.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\ted.focusEnd();\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\ted = col.find('.datagrid-editable-input');\r\n\t\t\t\t\t\t\t\t\t\t\tif (ed.length > 0 && ed.attr('type') == 'checkbox') {\r\n\t\t\t\t\t\t\t\t                if (ed.prop(\"checked\")) {\r\n\t\t\t\t\t\t\t\t                    ed.prop(\"checked\", false);\r\n\t\t\t\t\t\t\t\t                } else\r\n\t\t\t\t\t\t\t\t                \ted.prop(\"checked\", true);\r\n\t\t\t\t\t\t\t\t                _this.endEditing(id, p);\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (ed.length > 0 && !ed.hasClass('combo-f') && (ed.attr('type') == 'text' || ed.prop(\"tagName\") == 'TEXTAREA')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\ted.focusEnd();\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\ted = col.find('.combo-f');\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (ed.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcol.find('.textbox-text').focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ted.combo('showPanel');\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else\r\n\t\t                \t\t\t_this.endEditing();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcolOpt.editor1 = colOpt.editor;\r\n\t\t\t\t\t\t\tcolOpt.editor = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tselectCell: function(jq, p){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\t$('.datagrid-body td.selected-cell', panel).removeClass('selected-cell');\r\n\t\t\t\tvar td = $('.datagrid-body tr[datagrid-row-index='+p.index+'] td[field='+p.field+']',panel);\r\n\t\t\t\ttd.addClass('selected-cell');\r\n\t\t\t},\r\n\t\t\tgetCell: function(jq, p){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\tvar td = $('.datagrid-body tr[datagrid-row-index='+p.index+'] td[field='+p.field+']',panel);\r\n\t\t\t\treturn td;\r\n\t\t\t},\r\n\t\t\tgetRow: function(jq, i){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\tvar tr = $('.datagrid-body tr[datagrid-row-index='+i+']',panel);\r\n\t\t\t\treturn tr;\r\n\t\t\t},\r\n\t\t\tgetSelectedIndexes: function(jq, p){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\tvar trs = $('.datagrid-body tr.datagrid-row-selected',panel);\r\n\t\t\t\tvar indxs = [];\r\n\t\t\t\t$.each(trs, function(i, tr) {\r\n\t\t\t\t\tindxs[i] = parseInt($(tr).attr('datagrid-row-index'));\r\n\t\t\t\t});\r\n\t\t\t\treturn indxs;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$.extend($.fn.treegrid.methods, {\r\n\t\t\teditCell: function(jq,p){\r\n\t\t\t\treturn jq.each(function() {\r\n\t\t\t\t\tvar doEdit = false;\r\n\t\t\t\t\tvar table = $(this);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar fields = $(this).treegrid('getColumnFields', true)\r\n\t\t\t\t\t\t\t.concat($(this).treegrid('getColumnFields'));\r\n\t\t\t\t\tfor (var i = 0; i < fields.length; i++) {\r\n\t\t\t\t\t\tvar colOpt = $(this).treegrid('getColumnOption', fields[i]);\r\n\t\t\t\t\t\tif (fields[i] == p.field) {\r\n\t\t\t\t\t\t\t// если это первый столбец, то раскрыть дерево\r\n\t\t\t\t\t\t\tif (i == 0) {\r\n\t\t\t\t\t\t\t\t$(this).treegrid( p.state == 'open' ? 'collapse' : 'expand', p.index);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar id = $(this).attr(\"id\");\r\n\t\t\t\t\t\t\t\tvar par = {};\r\n\t\t\t\t\t\t\t\tpar[\"uid\"] = id;\r\n\t\t\t\t\t\t\t\tpar[\"row\"] = p.index;\r\n\t\t\t\t\t\t\t\tpar[\"cuid\"] = p.field;\r\n\t\t\t\t\t\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\t\t\t\t\t\tpar[\"com\"] = \"getEditor\";\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t_this.app.post(par).then(res => {\r\n\t\t\t\t\t\t\t\t\tif (res.tree) {\r\n\t\t\t\t\t\t\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.openTree(id, res.title, p.index, p.field);\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if (res.popup) {\r\n\t\t\t\t\t\t\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.openPopup(id, p.index, p.field);\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if (res.type) {\r\n\t\t\t\t\t\t\t\t\t\tcolOpt = table.datagrid('getColumnOption', p.field);\r\n\t\t\t\t\t\t\t\t\t\tcolOpt.editor = res;\r\n\r\n\t\t\t\t\t\t\t\t\t\ttable.treegrid('beginEdit', p.index);\r\n\t\t\t\t\t\t\t\t\t\tvar col = $('[field=\"' + p.field + '\"]');\r\n\t\t\t\t\t\t\t\t\t\tif (col.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar ed = col.find('.numberbox .textbox-text');\r\n\t\t\t\t\t\t\t\t\t\t\tif (ed.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\ted.focusEnd();\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\ted = col.find('.datagrid-editable-input');\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (ed.length > 0 && ed.attr('type') == 'checkbox') {\r\n\t\t\t\t\t\t\t\t\t                if (ed.prop(\"checked\")) {\r\n\t\t\t\t\t\t\t\t\t                    ed.prop(\"checked\", false);\r\n\t\t\t\t\t\t\t\t\t                } else\r\n\t\t\t\t\t\t\t\t\t                \ted.prop(\"checked\", true);\r\n\t\t\t\t\t\t\t\t\t                _this.endEditing();\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (ed.length > 0 && !ed.hasClass('combo-f') && (ed.attr('type') == 'text' || ed.prop(\"tagName\") == 'TEXTAREA')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ted.focusEnd();\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ted = col.find('.combo-f');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (ed.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcol.find('.textbox-text').focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ted.combo('showPanel');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else\r\n\t\t\t                \t\t\t_this.endEditing();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcolOpt.editor1 = colOpt.editor;\r\n\t\t\t\t\t\t\tcolOpt.editor = null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetSelectedIndexes: function(jq, p){\r\n\t\t\t\tvar panel = jq.treegrid('getPanel');\r\n\t\t\t\tvar trs = $('.datagrid-view2 tr.datagrid-row-selected',panel);\r\n\t\t\t\tvar indxs = [];\r\n\t\t\t\t$.each(trs, function(i, tr) {\r\n\t\t\t\t\tindxs[i] = $(tr).attr('node-id');\r\n\t\t\t\t});\r\n\t\t\t\treturn indxs;\r\n\t\t\t},\r\n\t\t\tgetCell: function(jq, p){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\tvar td = $('.datagrid-body tr[node-id='+p.index+'] td[field='+p.field+']',panel);\r\n\t\t\t\treturn td;\r\n\t\t\t},\r\n\t\t\tselectCell: function(jq, p){\r\n\t\t\t\tvar panel = jq.datagrid('getPanel');\r\n\t\t\t\t$('.datagrid-body td.selected-cell', panel).removeClass('selected-cell');\r\n\t\t\t\tvar td = $('.datagrid-body tr[node-id='+p.index+'] td[field='+p.field+']',panel);\r\n\t\t\t\ttd.addClass('selected-cell');\r\n\t\t\t\tvar par = {};\r\n\t\t\t\tpar[\"uid\"] = $(jq).attr('id');\r\n\t\t\t\tpar[\"com\"] = 'sct';\r\n\t\t\t\tpar[\"cuid\"] = p.field;\r\n\t\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\t\tloadData(par, true);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$.fn.datagrid.defaults.onClickRow = function(rIndex, rData) {\r\n\t\t\tifc.hidePopUp($(this), \"#app\");\r\n\t\t\tvar tbl = $(this);\r\n\t\t\t\r\n\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\tvar objs = tbl.datagrid('getSelections');\r\n\t\t\t\tvar indxs = [];\r\n\t\t\t\tfor (var i = 0; i < objs.length; i++) {\r\n\t\t\t\t\tindxs[i] = tbl.datagrid('getRowIndex', objs[i]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar index = _this.globalIndex(tbl, rIndex);\r\n\t\t\t\tvar clickIndex = index;\r\n\t\t\t\tvar val = '';\r\n\t\t\t\tvar rowUnselecting = true;\r\n\t\t\t\tfor (var i=0; i<indxs.length; i++) {\r\n\t\t\t\t\tvar indx = indxs[i];\r\n\t\t\t\t\tindxs[i] = _this.globalIndex(tbl, indxs[i]);\r\n\t\t\r\n\t\t\t\t\tif (indxs[i] != index) {\r\n\t\t\t\t\t\tif (EventOps.ctrlPressed) {\r\n\t\t\t\t\t\t\tval += ',' + indxs[i];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttbl.datagrid('unselectRow', indx);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trowUnselecting = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (rowUnselecting && indxs.length > 0) {\r\n\t\t\t\t\tif (val.length > 0 && val != '') {\r\n\t\t\t\t\t\tval = val.substring(1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tval = index + '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tindex = indxs[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = index + val;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (_this.firstShiftIndex == -1 || !EventOps.shiftPressed){\r\n\t\t\t\t\t_this.firstShiftIndex = _this.lastShiftIndex = clickIndex;\r\n\t\t\t\t\tif(!EventOps.ctrlPressed)\r\n\t\t\t\t\t\tval = _this.lastShiftIndex + '';\r\n\t\t\t\t}\r\n\t\t\t\tif (indxs.length == 0){\r\n\t\t\t\t\t_this.firstShiftIndex = _this.lastShiftIndex = -1;\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (tbl.datagrid('getSelections').length == 0 && !EventOps.ctrlPressed & !EventOps.shiftPressed) {\r\n\t\t\t\t\ttbl.datagrid('selectRow', rIndex);\r\n\t\t\t\t\t_this.firstShiftIndex = _this.lastShiftIndex = _this.globalIndex(tbl, rIndex);\r\n\t\t\t\t\tval = _this.lastShiftIndex + '';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(EventOps.shiftPressed && _this.firstShiftIndex != -1 /*&& clickIndex != _this.firstShiftIndex*/){\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t\t_this.lastShiftIndex = clickIndex;\r\n\t\t\t\t\tvar i = _this.firstShiftIndex;\r\n\t\t\t\t\twhile(_this.lastShiftIndex>_this.firstShiftIndex?i<=_this.lastShiftIndex:i>=_this.lastShiftIndex){\r\n\t\t\t\t\t\ttbl.datagrid('selectRow', i);\r\n\t\t\t\t\t\tval += ',' + i;\t\t\t\t\r\n\t\t\t\t\t\t_this.lastShiftIndex>_this.firstShiftIndex?i++:i--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(index > -1){\r\n\t\t\t\t\t\tval = val.substring(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t_this.setSelection(tbl, val, clickIndex);\r\n\t\t\r\n\t\t\t\tvar toolbar_sel = tbl.parents(\".datagrid\").find(\".datagrid-toolbar:first .datagrid-sel\");\r\n\t\t\t\t$(toolbar_sel).html((index+1)+\"&nbsp;/\");\r\n\t\t\r\n\t\t\t\tvar panel = tbl.datagrid('getPanel').panel('panel');\r\n\t\t\t\tpanel.attr('tabindex', 0);\r\n\t\t\t\tpanel.focus();\r\n\t\t\t\t_this.focusedTable = tbl.attr('id');\r\n\t\t\t\tpanel.unbind('keydown').bind('keydown',function(event) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (event.which && event.which == 38 && EventOps.shiftPressed && _this.firstShiftIndex != -1) {\r\n\t\t\t\t\t\tif(_this.firstShiftIndex < _this.lastShiftIndex){\r\n\t\t\t\t\t\t\ttbl.datagrid('unselectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t\t_this.lastShiftIndex--;\r\n\t\t\t\t\t\t\tval = val.substring(0, val.length - 2);\r\n\t\t\t\t\t\t} else if(_this.lastShiftIndex > 0){\r\n\t\t\t\t\t\t\tif(_this.firstShiftIndex == _this.lastShiftIndex){\r\n\t\t\t\t\t\t\t\ttbl.datagrid('clearSelections');\r\n\t\t\t\t\t\t\t\ttbl.datagrid('selectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this.lastShiftIndex--;\r\n\t\t\t\t\t\t\ttbl.datagrid('selectRow',_this.lastShiftIndex);\r\n\t\t\t\t\t\t\tval+= \",\" + _this.lastShiftIndex;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.setSelection(tbl, val, index);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (event.which && event.which == 40 && EventOps.shiftPressed && _this.firstShiftIndex != -1) {\r\n\t\t\t\t\t\tvar rowCount = tbl.datagrid('getRows').length;\r\n\t\t\t\t\t\tif(_this.firstShiftIndex > _this.lastShiftIndex){\r\n\t\t\t\t\t\t\ttbl.datagrid('unselectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t\t_this.lastShiftIndex++;\r\n\t\t\t\t\t\t\tval = val.substring(0, val.length - 2);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else if(_this.lastShiftIndex < rowCount - 1){\r\n\t\t\t\t\t\t\tif(_this.firstShiftIndex == _this.lastShiftIndex){\r\n\t\t\t\t\t\t\t\ttbl.datagrid('clearSelections');\r\n\t\t\t\t\t\t\t\ttbl.datagrid('selectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this.lastShiftIndex++;\r\n\t\t\t\t\t\t\ttbl.datagrid('selectRow',_this.lastShiftIndex);\r\n\t\t\t\t\t\t\tval+= \",\" + _this.lastShiftIndex;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.setSelection(tbl, val, index);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (event.which && event.which == 38 && !EventOps.shiftPressed) {\r\n\t\t\t\t\t\tif(_this.firstShiftIndex != _this.lastShiftIndex){\r\n\t\t\t\t\t\t\ttbl.datagrid('clearSelections');\r\n\t\t\t\t\t\t\ttbl.datagrid('selectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.firstShiftIndex = _this.lastShiftIndex = tbl.datagrid('getRowIndex', tbl.datagrid('getSelected')) - 1;\r\n\t\t\t\t\t\tval = _this.lastShiftIndex + '';\r\n\t\t\t\t\t\treturn selectRow($(this), true);\r\n\t\t\t\t\t} else if (event.which && event.which == 40 && !EventOps.shiftPressed) {\r\n\t\t\t\t\t\tif(_this.firstShiftIndex != _this.lastShiftIndex){\r\n\t\t\t\t\t\t\ttbl.datagrid('clearSelections');\r\n\t\t\t\t\t\t\ttbl.datagrid('selectRow', _this.lastShiftIndex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.firstShiftIndex = _this.lastShiftIndex = tbl.datagrid('getRowIndex', tbl.datagrid('getSelected')) + 1;\r\n\t\t\t\t\t\tval = _this.lastShiftIndex + '';\r\n\t\t\t\t\t\treturn _this.selectRow($(this), false);\r\n\t\t\t\t\t} else if (event.which && event.which == 37) {\r\n\t\t\t\t\t\treturn _this.selectColumn($(this), true);\r\n\t\t\t\t\t} else if (event.which && event.which == 39) {\r\n\t\t\t\t\t\treturn _this.selectColumn($(this), false);\r\n\t\t\t\t\t} else if (event.which && event.which == 32) {\r\n\t\t\t\t\t\treturn _this.beginEditCell($(this));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.treegrid.defaults.onClickRow = function(rIndex, rData) {\r\n\t\t\t_this.selectedTree = $(this);\r\n\t\t\tifc.hidePopUp($(this),\"#app\");\r\n\t\t\tvar tbl = $(this);\r\n\t\t\t\r\n\t\t\tvar singlSel = tbl.treegrid('options').singleSelect;\r\n\t\t\tif(!singlSel){\r\n\t\t\t\tvar checked = tbl.treegrid('getCheckedNodes');\r\n\t\t\t\tif ($.inArray(rIndex,checked) >= 0) {\r\n\t\t\t\t\ttbl.treegrid('uncheckNode', rIndex.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttbl.treegrid('checkNode', rIndex.id);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\tvar indxs = tbl.treegrid('getSelectedIndexes');\r\n\t\t\t\tvar index = rIndex.id;\r\n\t\t\t\tvar val = '';\r\n\t\t\t\tvar rowUnselecting = true;\r\n\t\t\t\tfor (var i=0; i<indxs.length; i++) {\r\n\t\t\t\t\tif (indxs[i] != index) {\r\n\t\t\t\t\t\tif (EventOps.ctrlPressed) {\r\n\t\t\t\t\t\t\tval += ',' + indxs[i];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttbl.treegrid('unselectRow', indxs[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trowUnselecting = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (rowUnselecting && indxs.length > 0) {\r\n\t\t\t\t\tif (val.length > 0) val = val.substring(1);\r\n\t\t\t\t\tindex = indxs[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = index + val;\r\n\t\t\t\t}\r\n\t\t\t\tif (indxs.length == 0) {\r\n\t\t\t\t\ttbl.treegrid('selectRow', rIndex.id);\r\n\t\t\t\t}\r\n\t\t\r\n\t\t\t\tif (_this.selectedRow[tbl.attr(\"id\")] != rIndex) {\r\n\t\t\t\t\t_this.clickedGrid = tbl.attr(\"id\");\r\n\t\t\t\t\t_this.selectedRow[tbl.attr(\"id\")] = rIndex;\r\n\t\t\t\t}\r\n\t\t\t\tvar oldVal = tbl.attr('selRows');\r\n\t\t\t\tif (oldVal != val) {\r\n\t\t\t\t\tifc.setValue(tbl.attr('id'), val);\r\n\t\t\t\t\ttbl.attr('selRows', val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar id = tbl.attr('id');\r\n\t\t\t\t\tif (id != null && id != _this.currentSelectedId) {\r\n\t\t\t\t\t\t_this.currentSelectedId = id;\r\n\t\t\t\t\t\tvar par = {\"cmd\":\"fcs\",\"uid\":id};\r\n\t\t\t\t\t\t_this.app.post(par);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar panel = tbl.datagrid('getPanel').panel('panel');\r\n\t\t\t\tpanel.attr('tabindex', 0);\r\n\t\t\t\tpanel.focus();\r\n\t\t\t\t_this.focusedTable = tbl.attr('id');\r\n\t\t\t\tpanel.unbind('keydown').bind('keydown',function(event) {\r\n\t\t\t\t\tif (event.which && event.which == 38) {\r\n\t\t\t\t        return selectRowt($(this), true);\r\n\t\t\t\t\t} else if (event.which && event.which == 40) {\r\n\t\t\t\t        return selectRowt($(this), false);\r\n\t\t\t\t\t} else if (event.which && event.which == 37) {\r\n\t\t\t\t        return selectColumnt($(this), true);\r\n\t\t\t\t\t} else if (event.which && event.which == 39) {\r\n\t\t\t\t        return selectColumnt($(this), false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\t\t\r\n\t\t};\r\n\r\n\t\t$.fn.treegrid.defaults.onCheckNode = function(row, checked){\r\n\t\t\tvar tbl = $(this);\r\n\t\t\tvar singlSel = tbl.treegrid('options').singleSelect;\r\n\t\t\tif(!singlSel){\r\n\t\t\t\t_this.selectedTree = $(this);\r\n\t\t\t\tifc.hidePopUp($(this), \"#ui-panel\");\t\r\n\t\t\t\t\r\n\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\tvar index = row.id;\r\n\t\t\t\t\tif(checked){\r\n\t\t\t\t\t\ttbl.treegrid('selectRow', index);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttbl.treegrid('unselectRow', index);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (_this.selectedRow[tbl.attr(\"id\")] != row) {\r\n\t\t\t\t\t\t_this.clickedGrid = tbl.attr(\"id\");\r\n\t\t\t\t\t\t_this.selectedRow[tbl.attr(\"id\")] = row;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar val = '';\r\n\t\t\t\t\tvar checkedNodes = tbl.treegrid('getCheckedNodes');\r\n\t\t\t\t\tfor(var i = 0; i < checkedNodes.length; i++){\r\n\t\t\t\t\t\tval += ',' + checkedNodes[i].id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tval = val.substring(1);\r\n\t\t\t\t\tvar oldVal = tbl.attr('selRows');\r\n\t\t\t\t\tif(oldVal != val){\r\n\t\t\t\t\t\tifc.setValue(tbl.attr('id'), val);\r\n\t\t\t\t\t\ttbl.attr('selRows', val);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar id = tbl.attr('id');\r\n\t\t\t\t\t\tif (id != null && id != _this.currentSelectedId) {\r\n\t\t\t\t\t\t\t_this.currentSelectedId = id;\r\n\t\t\t\t\t\t\tvar par = {\"cmd\":\"fcs\",\"uid\":id};\r\n\t\t\t\t\t\t\t_this.app.post(par);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar panel = tbl.datagrid('getPanel').panel('panel');\r\n\t\t\t\t\tpanel.attr('tabindex', 0);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$.fn.treegrid.defaults.onLoadSuccess = function(rData) {\r\n\t\t\tif (rData == null) {\r\n\t\t\t\tvar tbl = $(this);\r\n\t\t\t\t_this.paintTreegridRows($(this).attr('id'));\r\n\t\t\t\tvar sel = tbl.attr('selRows');\r\n\t\t\t\tvar singleSel = tbl.treegrid('options').singleSelect;\r\n\t\t\t\tif (sel && sel != 0) {\r\n\t\t\t\t\tvar rows = sel.split(',');\r\n\t\t\t\t\tvar root = tbl.treegrid('getRoot');\r\n\t\t\t\t\tif(rows.length > 1 || (root && rows[0] != root.id)){\r\n\t\t\t\t\t\tfor (var ind = 0; ind < rows.length; ind++) {\r\n\t\t\t\t\t\t\tif ($(this).treegrid('find', rows[ind])) {\r\n\t\t\t\t\t\t\t\t$(this).treegrid('select', rows[ind]);\r\n\t\t\t\t\t\t\t\tif(!singleSel){\r\n\t\t\t\t\t\t\t\t\ttbl.treegrid('checkNode', rows[ind]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.datagrid.defaults.onDblClickCell = function(index, field) {\r\n\t\t\tvar cell = $(this).datagrid('getPanel').find('div.datagrid-body td[field = ' + field +'] div.datagrid-cell:not(:empty)')[index];\r\n\t\t\t$(cell).tooltip('destroy');\r\n\t\t\tvar id = $(this).attr(\"id\");\r\n\t\t\tvar opt = $(this).datagrid('getColumnOption', field);\r\n\t\t\tvar realIndex = _this.globalIndex($(this), index);\r\n\t\t\tif(opt && opt.editor && opt.editor == 'textarea') {\r\n\t\t\t\tvar fields = $(this).datagrid('getColumnFields',true).concat($(this).datagrid('getColumnFields'));\r\n\t\t\t\tfor(var i=0; i<fields.length; i++) {\r\n\t\t\t\t\tif (fields[i] == field) {\r\n\t\t\t\t\t\tvar par = {\"cmd\":\"set\", \"com\":\"getEditor\"};\r\n\t\t\t\t\t\tpar[\"uid\"] = id;\r\n\t\t\t\t\t\tpar[\"row\"] = realIndex;\r\n\t\t\t\t\t\tpar[\"cuid\"] = field;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_this.app.post(par).then(res => {\r\n\t\t\t\t\t\t\tvar doTextareaColumn = false;\r\n\t\t\t\t\t\t\tvar isShowTextAsXML = false; \r\n\t\t\t\t\t\t\tif (res.type) {\r\n\t\t\t\t\t\t\t\tdoTextareaColumn = false;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdoTextareaColumn = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (res.showTextAsXML) {\r\n\t\t\t\t\t\t\t\tisShowTextAsXML = res.showTextAsXML == \"1\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (doTextareaColumn) {\r\n\t\t\t\t\t\t\t\tvar text = $('.datagrid-body tr[datagrid-row-index='+index+'] td[field='+field+']').children().text();\r\n\t\t\t\t\t\t\t\tif(text != \"\") {\r\n\t\t\t\t\t\t\t\t\tvar dialogId = 'or3_popup' + _this.popupcount;\r\n\t\t\t\t\t\t\t\t\t$('#trash').append($(\"<div></div>\").attr('id', dialogId));\r\n\t\t\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tvar buttonOk = {\r\n\t\t\t\t\t\t\t\t\t\ttext: Translation.translation['ok'],\r\n\t\t\t\t\t\t\t\t\t\thandler: function() {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '0';\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tvar buttons = [buttonOk];\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tvar oldZindex = $.fn.window.defaults.zIndex;\r\n\t\t\t\t\t\t\t\t\t$.fn.window.defaults.zIndex = ifc.dialogZindex++;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$('#' + dialogId).dialog({\r\n\t\t\t\t\t\t\t\t\t\ttitle: opt.title,\r\n\t\t\t\t\t\t\t\t\t\twidth: 600,\r\n\t\t\t\t\t\t\t\t\t\theight: 400,\r\n\t\t\t\t\t\t\t\t\t\tclosed: true,\r\n\t\t\t\t\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t\t\t\t\t\tclosable: true,\r\n\t\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\t\tonLoad: function() {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#' + dialogId).parent().find('.panel-title').css({'height' : 'auto'});\r\n\t\t\t\t\t\t\t\t\t\t\tInterfaceController.popDlg.push(dialogId);\r\n\t\t\t\t\t\t\t\t\t\t\tInterfaceController.popDlgType.push(Util.DLG_NO_SEND);\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tonClose: function() {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.dialogResult[dialogId] = '1';\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + dialogId).dialog('destroy');\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tonBeforeDestroy : function() {\r\n\t\t\t\t\t\t\t\t        \t$.fn.window.defaults.zIndex = oldZindex;\r\n\t\t\t\t\t\t\t\t        \tif(dialogId == InterfaceController.popDlg[InterfaceController.popDlg.length-1]){\r\n\t\t\t\t\t\t\t\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t\t\t\t\t\t\t\t        \tInterfaceController.popDlgType.pop();\r\n\t\t\t\t\t\t\t\t        \t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tbuttons: buttons\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif (isShowTextAsXML) {\r\n\t\t\t\t\t\t\t\t\t\t$('#' + dialogId).text(text.replace(/\\n/g, '<br/>'));\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t$('#' + dialogId).html(text.replace(/\\n/g, '<br/>'));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t$('#' + dialogId).dialog(\"open\");\r\n\t\t\t\t\t\t\t\t\t_this.popupcount++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (opt && (opt.editor == null || opt.editor.type != 'checkbox')) {\r\n\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t_this.editingTable = id;\r\n\t\t\t\t\t_this.editIndex[id] = {index: index, field: field, realIndex: realIndex};\r\n\t\t\t\t\t$('#' + id).datagrid('editCell', {index:index,field:field});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.datagrid.defaults.onClickCell = function(index, field) {\r\n\t\t\tvar realIndex = _this.globalIndex($(this), index);\r\n\t\t\t$(this).attr('selectedCol', field);\r\n\t\t\t$(this).datagrid('selectCell', {index:index,field:field});\r\n\t\t\tvar id = $(this).attr(\"id\");\r\n\t\t\tvar opt = $(this).datagrid('getColumnOption', field);\r\n\t\t\tif (opt && opt.editor && opt.editor.type == 'checkbox') {\r\n\t\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t\t_this.editingTable = id;\r\n\t\t\t\t\t_this.editIndex[id] = {index: index, field: field, realIndex: realIndex};\r\n\t\t\t\t\t$('#' + id).datagrid('editCell', {index:index,field:field});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.treegrid.defaults.onDblClickCell = function(field, props) {\r\n\t\t\tvar tbl = $(this);\r\n\t\t\tvar id = tbl.attr(\"id\");\r\n\r\n\t\t\t_this.endEditing().then(() => {\r\n\t\t\t\t_this.editingTable = id;\r\n\t\t\t\t_this.editIndex[id] = {index: props.id, field: field, realIndex: props.id};\r\n\t\t\t\ttbl.treegrid('editCell', {index: props.id, field: field, state: props.state});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$.extend($.fn.datagrid.defaults.editors, {\r\n\t\t    file: {  \r\n\t\t        init: function(container, options){\r\n\t\t        \tif (options != undefined && options['uid']) {\r\n\t\t        \t\tif (options['action'] == \"DOC_UPDATE\") {\r\n\t\t\t        \t\tvar input = $('<span class=\"btn btn-small fileinput-button\" style=\"margin-right:2px;margin-top:2px; \">'\r\n\t\t\t\t        \t\t+'<i class=\"fam-attach\"></i>'\r\n\t\t\t\t        \t\t+'<span class=\"btn-label\" style=\"font-size:12px;font-weight:bold;\">Загрузить</span>'\r\n\t\t\t\t        \t\t+'<input class=\"or3-file-upload\" type=\"file\" '\r\n\t\t\t\t        \t\t+'data-url=\"' + _this.app.restUrl + '&uid='+options['uid']+'&row='+options['row']+'\" name=\"file\">'\r\n\t\t\t\t        \t\t+'</span>')\r\n\t\t\t\t        \t\t.appendTo(container);\r\n\t\t\t        \t\t\r\n\t\t\t                ifc.preparefileUpload();\r\n\t\t\t                return input;\r\n\t\t        \t\t} else if (options['action'] == \"DOC_EDIT\") {\r\n\t\t        \t\t}\r\n\t\t        \t\treturn $('<span></span>').appendTo(container);\r\n\t\t        \t} else {\r\n\t\t        \t\treturn $('<span></span>').appendTo(container);\r\n\t\t        \t}\r\n\t\t        },\r\n\t\t        getValue: function(target){\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t        }\r\n\t\t    },\r\n\t\t    checkbox: {  \r\n\t\t        init: function(container, options){  \r\n\t\t            var input = $('<input type=\"checkbox\" class=\"datagrid-editable-input\">').appendTo(container);  \r\n\t\t            input.data('checkbox',{options:options});\r\n\t\t            return input;  \r\n\t\t        },\r\n\t\t        getValue: function(target){  \r\n\t\t            var check = $(target).is(':checked');\r\n\t\t            if (typeof check !== 'undefined' && check !== false) {\r\n\t\t               \r\n\t\t                return \"x\";\r\n\t\t            } else {\r\n\t\t                return \"\";\r\n\t\t            }\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t            var opts = $(target).data('checkbox').options;\t\t\r\n\t\t            if (opts.callback) value = opts.callback.call(target, value);\r\n\t\t            if (value==\"x\") {\r\n\t\t                $(target).attr(\"checked\",\"checked\");\r\n\t\t            } else {\r\n\t\t                $(target).removeAttr(\"checked\");\r\n\t\t            }\r\n\t\t            $(target).val(value);  \r\n\t\t        }\r\n\t\t    },\r\n\t\t\tcombobox: {\r\n\t\t\t\tinit: function(container, options){  \r\n\t\t\t\t\toptions['formatter'] = comboTableFormat;\r\n\t\t\t\t\toptions['width'] = container.parent().width();\r\n\t\t\t\t\tvar input = $('<input type=\"text\" class=\"datagrid-editable-input\">').appendTo(container);\r\n\t\t\t\t\treturn input.combobox(options);\r\n\t\t        },\r\n\t\t        getValue: function(target){\r\n\t\t            return $(target).combobox('getValue');\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t            $(target).combobox('setValue', value);\r\n\t\t        }\r\n\t\t\t},\r\n\t\t    datehhmmEditor : {\r\n\t\t        init : function(container, opts) {\r\n\t\t            var input = $('<input  type=\"text\" class=\"datagrid-editable-input\" id=\"datehhmmEditor\" >').appendTo(container);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        setValue: function(target, value) {\r\n\t\t            $('#datehhmmEditor').inputmask(\"d.m.y h:s\").val(value);\r\n\t\t        },\r\n\t\t        getValue: function(target) {\r\n\t\t            return $('#datehhmmEditor').val();\r\n\t\t        }\r\n\t\t    },\r\n\t\t    datehhmmssEditor : {\r\n\t\t        init : function(container, opts) {\r\n\t\t            var input = $('<input  type=\"text\" class=\"datagrid-editable-input\" id=\"datehhmmssEditor\" >').appendTo(container);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        setValue: function(target, value) {\r\n\t\t            $('#datehhmmssEditor').inputmask(\"d.m.y h:s:s\").val(value);\r\n\t\t        },\r\n\t\t        getValue: function(target) {\r\n\t\t            return $('#datehhmmssEditor').val();\r\n\t\t        }\r\n\t\t    },\r\n\t\t    hhmmEditor : {\r\n\t\t        init : function(container, opts) {\r\n\t\t            var input = $('<input  type=\"text\" class=\"datagrid-editable-input\" id=\"hhmmEditor\" >').appendTo(container);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        setValue: function(target, value) {\r\n\t\t            $('#hhmmEditor').inputmask(\"h:s\").val(value);\r\n\t\t        },\r\n\t\t        getValue: function(target) {\r\n\t\t            return $('#hhmmEditor').val();\r\n\t\t        }\r\n\t\t    },\r\n\t\t    datebox : {\r\n\t\t        init : function(container, opts) {\r\n\t\t            var input = $('<input type=\"text\" id=\"cellDatabox\" />').appendTo(container);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        setValue: function(target, value) {\r\n\t\t            var dateParts = value.split(\".\");\r\n\t\t            var date = new Date(dateParts[2], (dateParts[1] - 1), dateParts[0]);\r\n\t\t\t\t\t$('#cellDatabox').datebox().combo('textbox').inputmask(\"d.m.y\", {\r\n\t\t\t\t\t\t\"placeholder\": \"дд.мм.гггг\",\r\n\t\t\t\t\t\t\"insertMode\" : false\r\n\t\t\t\t\t});\r\n\t\t            if (isNaN(date.getDay())) {\r\n\t\t            \t$('#cellDatabox').datebox('setValue', null);\r\n\t\t            } else {\r\n\t\t            \t$('#cellDatabox').datebox('setValue',value);\r\n\t\t            }\r\n\t\t        },\r\n\t\t        getValue: function(target) {\r\n\t\t            return $('#cellDatabox').combo('textbox').val();\r\n\t\t        }\r\n\t\t    },\r\n\t\t    datetimebox : {\r\n\t\t    \tsecs : false,\r\n\t\t        init : function(container, opts) {\r\n\t\t            secs = opts != null && opts.showSeconds;\r\n\t\t            var input = $('<input type=\"text\" id=\"cellDatabox\" ' + (secs ? '' : 'data-options=\"showSeconds:false\"') + '/>').appendTo(container);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        setValue: function(target, value) {\r\n\t\t        \tvar date = null;\r\n\t\t    \t\tvar dateTimeParts = value.split(\" \");\r\n\t\t    \t\tif (dateTimeParts.length > 1) {\r\n\t\t    \t\t\tvar s1 = dateTimeParts[0];\r\n\t\t    \t\t\tvar s2 = dateTimeParts[1];\r\n\t\t    \t\t\tvar dateParts = s1.split(\".\");\r\n\t\t    \t\t\tvar y = -1;\r\n\t\t    \t\t\tvar m = -1;\r\n\t\t    \t\t\tvar d = -1;\r\n\t\t    \t\t\tvar h = 0;\r\n\t\t    \t\t\tvar min = 0;\r\n\t\t    \t\t\tvar sec = 0;\r\n\t\t    \t\t\tif (dateParts.length > 2) {\r\n\t\t    \t\t\t\ty = dateParts[2];\r\n\t\t    \t\t\t\tm = dateParts[1] - 1;\r\n\t\t    \t\t\t\td = dateParts[0];\r\n\t\t    \t\t\t}\r\n\t\t    \t\t\tvar timeParts = s2.split(\":\");\r\n\t\t    \t\t\tif (timeParts.length > 0) {\r\n\t\t    \t\t\t\th = timeParts[0];\r\n\t\t    \t\t\t}\r\n\t\t    \t\t\tif (timeParts.length > 1) {\r\n\t\t    \t\t\t\tmin = timeParts[1];\r\n\t\t    \t\t\t}\r\n\t\t    \t\t\tif (timeParts.length > 2) {\r\n\t\t    \t\t\t\tsec = timeParts[2];\r\n\t\t    \t\t\t}\r\n\t\t    \t\t\tdate = new Date(y, m, d, h, min, sec);\r\n\t\t\r\n\t\t    \t\t\tif (secs) {\r\n\t\t\t\t\t\t\t$('#cellDatabox').datetimebox().combo('textbox').inputmask(\"d.m.y h:s:s\", {\r\n\t\t\t\t\t\t\t\t\"placeholder\": \"дд.мм.гггг чч:ММ:сс\",\r\n\t\t\t\t\t\t\t\t\"insertMode\" : false\r\n\t\t\t\t\t\t\t});\r\n\t\t    \t\t\t} else {\r\n\t\t\t\t\t\t\t$('#cellDatabox').datetimebox().combo('textbox').inputmask(\"d.m.y h:s\", {\r\n\t\t\t\t\t\t\t\t\"placeholder\": \"дд.мм.гггг чч:ММ\",\r\n\t\t\t\t\t\t\t\t\"insertMode\" : false\r\n\t\t\t\t\t\t\t});\r\n\t\t    \t\t\t}\r\n\t\t    \t\t}\r\n\t\t            if (date == null || isNaN(date.getDay())) {\r\n\t\t            \t$('#cellDatabox').datetimebox('setValue', null);\r\n\t\t            } else {\r\n\t\t            \t$('#cellDatabox').datetimebox('setValue',value);\r\n\t\t            }\r\n\t\t        },\r\n\t\t        getValue: function(target) {\r\n\t\t            return $('#cellDatabox').combo('textbox').val();\r\n\t\t        }\r\n\t\t    },\r\n\t\t    textareaNotReady : {\r\n\t\t    \t init : function(container, opts) {\r\n\t\t             var input = $('<input  type=\"text\" class=\"datagrid-editable-input\" id=\"hhmmEditor\" >').appendTo(container);\r\n\t\t             return input;\r\n\t\t         },\r\n\t\t         setValue: function(target, value) {\r\n\t\t             $('#hhmmEditor').inputmask(\"h:s\").val(value);\r\n\t\t         },\r\n\t\t         getValue: function(target) {\r\n\t\t             return $('#hhmmEditor').val();\r\n\t\t         }\r\n\t\t    },\r\n\t\t    intfield: {  \r\n\t\t        init: function(container, opts) {\r\n\t\t        \tvar w = container.innerWidth();\r\n\t\t            var input = $('<input type=\"text\" class=\"datagrid-editable-input\" />').appendTo(container);\r\n\t\t            input.width(w - 10);\r\n\t\t            \r\n\t\t            if (opts.maxlength != null && opts.maxlength > 0)\r\n\t\t            \tinput.attr(\"maxlength\", opts.maxlength);\r\n\t\t            \r\n\t\t            input.attr(\"include\", opts.include);\r\n\t\t            input.attr(\"exclude\", opts.exclude);\r\n\t\t            \r\n\t\t            if ((opts.include != null && opts.include.length > 0) ||\r\n\t\t            \t\t(opts.exclude != null && opts.exclude.length > 0)) {\r\n\t\t\t            input.bind('keypress', function(e) {\r\n\t\t\t            \treturn validChars(this, e);\r\n\t\t\t            });\r\n\t\t            }\r\n\t\t            return input;  \r\n\t\t        },\r\n\t\t        getValue: function(target){  \r\n\t\t            return $(target).val();\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t            $(target).val(value);  \r\n\t\t        }\r\n\t\t    },\r\n\t\t    floatfield: {\r\n\t\t    \tinit: function(container, opts) {\r\n\t\t        \tvar w = container.innerWidth();\r\n\t\t            var input = $('<input type=\"text\" class=\"datagrid-editable-input\" />').appendTo(container);\r\n\t\t            input.width(w - 10);\r\n\t\t            \r\n\t\t            return input;  \r\n\t\t        },\r\n\t\t        getValue: function(target){  \r\n\t\t            return $(target).val();\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t            $(target).val(value);  \r\n\t\t        }\r\n\t\t    },\r\n\t\t    text: {\r\n\t\t        init: function(container, options) {\r\n\t\t    \t\tvar upperAllChars = false;\r\n\t\t    \t\tvar upperCase = false;\r\n\t\t        \tif (options != undefined) {\r\n\t\t        \t\tif (options['upperAllChars']) {\r\n\t\t        \t\t\tupperAllChars = options['upperAllChars'];\r\n\t\t        \t\t}\r\n\t\t        \t\tif (options['upperCase']) {\r\n\t\t        \t\t\tupperCase = options['upperCase'];\r\n\t\t        \t\t}\r\n\t\t        \t\t\r\n\t\t        \t}\r\n\t\t        \tvar w = container.innerWidth();\r\n\t\t            var input = $('<textarea type=\"text\" class=\"datagrid-editable-input\" id=\"txtEditor\"' + ((upperAllChars || upperCase) ? ' onkeyup=\"changeToUpperCase(this, event, ' + upperAllChars + ', ' + upperCase + ')\"' : '') + '>').appendTo(container);\r\n\t\t            input.width(w - 10);\r\n\t\t            return input;\r\n\t\t        },\r\n\t\t        getValue: function(target){\r\n\t\t            return $(target).val();\r\n\t\t        },  \r\n\t\t        setValue: function(target, value){\r\n\t\t            $(target).val(value);  \r\n\t\t        }\r\n\t\t    }\r\n\t\t});\r\n\t\t\r\n\t\t$.fn.tree.defaults.onSelect = function(node, checked) {\r\n\t\t\tvar nodeCheck = true;\r\n\t\t\tif (!$(this).hasClass(\"nochange\")) {\r\n\t\t\t\tvar tree = $(this).tree('options');\r\n\t\t\t\tvar multi2 = tree.multiSelect;\r\n\t\t\t\tvar multi = _this.getOption($(this), 'checkbox');\r\n\t\t\t\tif(multi2 == true || multi == \"true\") {\r\n\t\t\t\t\tvar nodes = $(this).tree('getChecked');\r\n\t\t\t\t\t_this.isOnCheck = true;\r\n\t\t\t\t\tif(node.parent != 0) {\r\n\t\t\t\t\t    for (var i = 0; i<nodes.length; i++) {\r\n\t\t\t\t\t    \tif (node.target == nodes[i].target) {\r\n\t\t\t\t\t    \t\t$(this).tree('uncheck', node.target);\r\n\t\t\t\t\t    \t\tnodeCheck = false;\r\n\t\t\t\t\t    \t}\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif(!_this.nodeParent) {\r\n\t\t\t\t\t\t\tnodeCheck = true;\r\n\t\t\t\t\t\t\t_this.nodeParent = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).tree('uncheck', node.target);\r\n\t\t\t\t\t\t\tnodeCheck = false;\r\n\t\t\t\t    \t\t_this.nodeParent = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t    if (nodeCheck) $(this).tree('check', node.target);\r\n\t\t\t\t    _this.isOnCheck = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_this.setValue($(this).attr('id'), node.id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar tmp = $(this).attr('selectFolder');\r\n\t\t\tvar canSelectFolder = tmp == null || tmp == 'true';\r\n\t\t\t\r\n\t\t\tif (!canSelectFolder) {\r\n\t\t\t\tvar isFolder = $(node.target).find('.tree-folder').length > 0;\r\n\t\t\t\tvar dlg = $(node.target).closest('.panel');\r\n\t\t\t\t\r\n\t\t\t\tif (isFolder) {\r\n\t\t\t\t\tdlg.find(\".dialog-button .l-btn\").first().linkbutton('disable');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdlg.find(\".dialog-button .l-btn\").first().linkbutton('enable');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t};\r\n\t\t$.fn.tree.defaults.onCheck = function(node, checked) {\r\n\t\t\tvar tree = $(this).tree('options');\r\n\t\t\t\r\n\t\t\tvar multi2 = tree.multiSelect;\r\n\t\t\tvar multi = _this.getOption($(this), 'checkbox');\r\n\t\t\tif ((multi2 == true || multi == \"true\") && _this.isOnCheck){\r\n\t\t\t    var ids = \"\";\r\n\t\t\t    var nodes = $(this).tree('getChecked');\r\n\t\t\t    for (var i = 0; i<nodes.length; i++) {\r\n\t\t\t    \tids += nodes[i].id + \",\";\r\n\t\t\t    }\r\n\t\t\t    if (ids.length > 0){\r\n\t\t\t    \tids = ids.substring(0, ids.length-1);\r\n\t\t\t    }\r\n\t\t\t\t_this.setValue($(this).attr('id'), ids);\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t$.fn.treegrid.defaults.onContextMenu = function(e,node){\r\n\t\t\te.preventDefault();\r\n\t\t\t_this.selectedTree = $(this);\r\n\t\t\t$(this).treegrid('select', node.id);\r\n\t\t\t$('#treeTableMenu').menu('show',{\r\n\t\t\t\tleft: e.pageX,\r\n\t\t\t\ttop: e.pageY\r\n\t\t\t});\r\n\t\t};\r\n\t\t$.fn.tree.defaults.onContextMenu = function(e,node){\r\n\t\t\te.preventDefault();\r\n\t\t\t_this.selectedTree = $(this);\r\n\t\t\t_this.selectedTree.tree('select', node.target);\r\n\t\t\tvar viewType=_this.selectedTree.attr('viewType');\r\n\t\t\tvar sortType=_this.selectedTree.attr('sortType');\r\n\t\t\tvar pUp=false;\r\n\t\t\tvar pDown=false;\r\n\t\t\tif(sortType==1){\r\n\t\t\t\tvar nodep=_this.selectedTree.tree('getParent',node.target);\r\n\t\t\t\tif (nodep!=null){\r\n\t\t\t\t\tvar chs=_this.selectedTree.tree('getChildren',nodep.target);\r\n\t\t\t\t\tif (chs!=null && chs.length>0){\r\n\t\t\t\t\t\tvar chFirst=chs[0];\r\n\t\t\t\t\t\tif(node.id!=chFirst.id)\r\n\t\t\t\t\t\t\tpUp=true;\r\n\t\t\t\t\t\tvar chLast=chs[chs.length-1];\r\n\t\t\t\t\t\tif(node.id!=chLast.id)\r\n\t\t\t\t\t\t\tpDown=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(pUp) \r\n\t\t\t\t$('#treeMenu').menu('enableItem', $('#moveUp'));\r\n\t\t\telse\r\n\t\t\t\t$('#treeMenu').menu('disableItem', $('#moveUp'));\r\n\t\t\tif(pDown)\r\n\t\t\t\t$('#treeMenu').menu('enableItem', $('#moveDown'));\r\n\t\t\telse\r\n\t\t\t\t$('#treeMenu').menu('disableItem', $('#moveDown'));\r\n\t\t\t$('#treeMenu').menu('show',{\r\n\t\t\t\tleft: e.pageX,\r\n\t\t\t\ttop: e.pageY\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\t\r\n\tselectTableRows(t, rs) {\r\n\t\tt.attr('selRows', rs);\r\n\t\r\n\t\tvar count = t.datagrid('getRows') != null ? t.datagrid('getRows').length : 0;\r\n\t\tif (count > 0) {\r\n\t\t\tt.datagrid('clearSelections');\r\n\t\t\tif (rs) {\r\n\t\t\t\tvar rows = rs.split(',');\r\n\t\t\t\tvar count = t.datagrid('getRows').length;    // row count\r\n\t\t\t\t\r\n\t\t\t\tfor (var ind=0; ind<rows.length; ind++) {\r\n\t\t\t\t\trows[ind] = this.pageIndex(t, rows[ind]);\r\n\t\t\t\t    if (rows[ind] >= 0 && rows[ind] < count) {\r\n\t\t\t\t        t.datagrid('selectRow', rows[ind]);\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t\t\tvar selCol = t.attr('selectedCol');\r\n\t\t\t\tif (selCol != null) {\r\n\t\t\t\t\tt.datagrid('selectCell', {index:rows[0],field:selCol});\r\n\t\t\t\t}\r\n\t\t\t\tvar toolbar_sel = $(t).parents(\".datagrid\").find(\".datagrid-toolbar:first .datagrid-sel\");\r\n\t\t\t\t$(toolbar_sel).text((parseInt(rows[0])+1)+\" /\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tglobalIndex(t, index) {\r\n\t\tvar res = index;\r\n\t\tif (t.datagrid('getPager').length > 0) {\r\n\t\t\tres += (t.datagrid('getPager').find('.pagination-num').val() - 1) * t.datagrid('getPager').find('.pagination-page-list').val();\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\tpageIndex(t, index) {\r\n\t\tvar res = index;\r\n\t\tif (t.datagrid('getPager').length > 0) {\r\n\t\t\tres -= (t.datagrid('getPager').find('.pagination-num').val() - 1) * t.datagrid('getPager').find('.pagination-page-list').val();\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\tgetEditing() {\r\n\t\tif (this.editingTable == undefined) return null;\r\n\t\t\r\n\t\tvar id = this.editingTable;\r\n\t\tif (this.editIndex[id] == undefined) return null;\r\n\t\r\n\t\treturn {id: id, edIndex: this.editIndex[id]};\r\n\t}\r\n\t\r\n\trestoreEditing(pars) {\r\n\t\tvar t = $(\"#\" + pars.id);\r\n\t\r\n\t\tif (t.length > 0) {\r\n\t\t\tvar ed = t.datagrid('getEditor', {index:pars.edIndex.index, field:pars.edIndex.field});\r\n\t\r\n\t\t\tif (ed == null || ed.target == null) {\r\n\t\t\t\tt.datagrid('editCell', {index:pars.edIndex.index, field:pars.edIndex.field});\r\n\t\t\t} \r\n\t\t}\r\n\t}\r\n\r\n\tendEditing(tableId, columnId) {\r\n\t\tlet _this = this;\r\n\t\tif ((tableId == undefined || tableId == null) && this.editingTable == undefined) \r\n\t\t\treturn new Promise((resolve, reject) => {resolve()});\r\n\t\t\r\n\t\tvar id = tableId || this.editingTable;\r\n\t\tif ((columnId == undefined || columnId == null) && this.editIndex[id] == undefined)\r\n\t\t\treturn new Promise((resolve, reject) => {resolve()});\r\n\t\r\n\t\tvar edIndex = columnId || this.editIndex[id];\r\n\t\t\r\n\t\tthis.editIndex[id] = undefined;\r\n\t\tthis.editingTable = undefined;\r\n\t\r\n\t\tvar t = $(\"#\" + id);\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (t.length > 0) {\r\n\t\t\t\tvar ed = t.datagrid('getEditor', {index:edIndex.index,field:edIndex.field});\r\n\t\t\t\tvar val = \"\";\r\n\t\t\t\tif (ed && ed.type == 'combobox') {\r\n\t\t\t\t\tvar title = $(ed.target).combobox('getText');\r\n\t\t\t\t\tif (t.datagrid('getRows').length > 0)\r\n\t\t\t\t\t\tt.datagrid('getRows')[edIndex.index][edIndex.field + '-title'] = title;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tt.datagrid('getSelected')[edIndex.field + '-title'] = title;\r\n\t\t\t\t\tval = $(ed.target).combobox('getValue');\r\n\t\t\t\t} else if (ed && ed.type == 'datebox') {\r\n\t\t\t\t\tval = $(ed.target).datebox('getValue');\r\n\t\t\t\t} else if (ed && ed.type == 'datetimebox') {\r\n\t\t\t\t\tval = $(ed.target).datetimebox('getValue');\r\n\t\t\t\t} else if (ed && ed.type == 'checkbox') {\r\n\t\t\t\t\tval = $(ed.target).get(0).checked;\r\n\t\t\t\t} else if (ed && ed.type == 'or3checkbox') {\r\n\t\t\t\t\tval = $(ed.target).get(0).checked;\r\n\t\t\t\t} else if (ed && ed.type == 'numberbox') {\r\n\t\t\t\t\tval = $(ed.target).next().children().first().val();\r\n\t\t\t\t} else if (ed) {\r\n\t\t\t\t\tval = $(ed.target).val();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (ed && ed.target) {\r\n\t\t\t\t    _this.showChangeMsg();\r\n\t\t\t\t\tvar par = {};\r\n\t\t\t\t\tpar[\"uid\"] = id;\r\n\t\t\t\t\tpar[\"val\"] = val;\r\n\t\t\t\t\tpar[\"row\"] = edIndex.realIndex;\r\n\t\t\t\t\tpar[\"cuid\"] = edIndex.field;\r\n\t\t\t\t\tpar[\"cmd\"] = \"set\";\r\n\t\t\r\n\t\t\t\t\tvar count = t.datagrid('getRows').length;\r\n\t\t\t\t    var selected = t.datagrid('getSelected');\r\n\t\t\t\t    var selRow = 0;\r\n\t\t\t\t    if (selected) {\r\n\t\t\t\t    \tselRow = t.datagrid('getRowIndex', selected);\r\n\t\t\t\t    }\r\n\t\t\t\t\tt.datagrid('endEdit', edIndex.index);\r\n\t\t\t\t    if (selRow >= 0 && selRow < count) {\r\n\t\t\t\t        t.datagrid('selectRow', selRow);\r\n\t\t\t\t    }\r\n\t\t\t\t\t_this._child.loadData(par).then(data => {\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else\r\n\t\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n\ttreeTableSetSelected(tbl) {\r\n\t\tvar sel = tbl.attr('selRows');\r\n\t\tvar singleSel = tbl.treegrid('options').singleSelect;\r\n\t\tif (sel && sel != 0) {\r\n\t\t\tvar rows = sel.split(',');\r\n\t\t\tvar root = tbl.treegrid('getRoot');\r\n\t\t\tif(rows.length > 1 || (root && rows[0] != root.id)){\r\n\t\t\t\tfor (var ind = 0; ind < rows.length; ind++) {\r\n\t\t\t\t\tvar tr = tbl.treegrid('options').finder.getTr(tbl.get(0),rows[ind]);\r\n\t\t\t\t\tif (tr && tr.length > 0 && !tr.hasClass(\"datagrid-row-selected\")) {\r\n\t\t\t\t\t\ttbl.treegrid('select', rows[ind]);\r\n\t\t\t\t\t\tif(!singleSel){\r\n\t\t\t\t\t\t\ttbl.treegrid('checkNode', rows[ind]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfindTableNode(tableId, str) {\r\n\t\tif (str.length > 0) {\r\n\t\t\t// Находим таблицу\r\n\t\t\tvar t = $('#' + tableId);\r\n\t\t\tvar panel = t.datagrid('getPanel');\r\n\t\t\t\r\n\t\t\t// Находим ячейку содержащую текст\r\n\t\t\tvar tds = $('.datagrid-cell:contains(\"' + str + '\")', panel);\r\n\t\t\t\r\n\t\t\tvar nextIndex = -1;\r\n\t\t\t\r\n\t\t\tvar tr = null;\r\n\t\t\tfor (i=0; i<tds.length; i++) {\r\n\t\t\t\t// Строки\r\n\t\t\t\ttr = $(tds.get(i)).parent().parent();\r\n\t\t\t\t// индекс строки\r\n\t\t\t\tvar rIndex = parseInt(tr.attr('datagrid-row-index'));\r\n\t\t\t\tif (rIndex > this._lastId) {\r\n\t\t\t\t\tnextIndex = rIndex;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (nextIndex > -1) {\r\n\t\t\t\tthis._lastId = nextIndex;\r\n\t\t        t.datagrid('clearSelections');\r\n\t\t        // выделяем строку\r\n\t\t        t.datagrid('selectRow', nextIndex);\r\n\t\r\n\t\t        // отправляем номер выделенной строки на сервер\r\n\t\t        var index = this.globalIndex(t, nextIndex);\r\n\t\t        this.makeSelection(t, index);\r\n\t\t        \r\n\t\t\t\t// Таблица и ее контейнер \r\n\t\t\t\tvar div = tr.closest('.datagrid-body');\r\n\t\t\t\tvar table = div.children('.datagrid-btable');\r\n\t\t\t\t// скролируем контейнер до нужной строки\r\n\t\t\t\tdiv.scrollTop(tr.offset().top - table.offset().top);\r\n\t\t\t} else {\r\n\t\t\t\tUtil.alert('Ничего не найдено!');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfindTreeTableNode(treeId, str) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tif (_this._searchText == str)\r\n\t\t\t_this._searchCount++;\r\n\t\telse {\r\n\t\t\t_this._searchText = str;\r\n\t\t\t_this._searchCount = 0;\r\n\t\t}\r\n\t\t\r\n\t\tif (str.length > 0) {\r\n\t\t\tvar par = {\r\n\t\t\t\t\"treeFind\": treeId,\r\n\t\t\t\t\"id\":_this._lastId > -1 ? \"\" + _this._lastId : \"\",\r\n\t\t\t\t\"title\":str,\r\n\t\t\t\t\"index\":_this._searchCount\r\n\t\t\t};\r\n\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\tif (data.value) {\r\n\t\t\t\t\tvar cellVal = data.value.split(\"##\");\r\n\t\t\t\t\tvar selCol = cellVal[1];\r\n\t\t\t\t}\r\n\t\t\t\tif(data.parentNodes)\r\n\t\t\t\t\tvar parIds = data.parentNodes.split(\",\"); \r\n\t\t\t\tif (data.node) {\r\n\t\t\t\t\tvar nodeId = data.node;\r\n\t\t\t\t\t_this._lastId = nodeId;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar root = $('#' + treeId).treegrid('getRoot');\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (root.id == nodeId) {\r\n\t\t\t\t\t\tvar tr = $('.datagrid-view2 tr[node-id=' + root.id + ']');\r\n\t\t\t\t\t\tvar div = tr.closest('.datagrid-body');\r\n\t\t\t\t\t\tvar table = tr.closest('.datagrid-btable');\r\n\t\t\t\t\t\t_this.lastHiLitTreeTableElement = table;\r\n\t\t\t\t\t\ttable.find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\r\n\t\t\t\t\t\tstr = Util.sanitizeHtml(str);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$.each(tr.find('td'), function(i, td) {\r\n\t\t\t\t\t\t\tvar tag = $(td).find('.tree-title');\r\n\t\t\t\t\t\t\tif (tag.length == 0) tag = $(td).find('div');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar html = Util.sanitizeHtml(tag.get(0).textContent);\r\n\t\t\t\t\t\t\tvar ind = html.toUpperCase().indexOf(str.toUpperCase());\r\n\t\t\t\t\t\t\tif (ind > -1) {\r\n\t\t\t\t\t\t\t\thtml = html.substring(0, ind) + '<span class=\"higliht\">' + html.substring(ind, ind + str.length) + '</span>' + html.substring(ind + str.length);\r\n\t\t\t\t\t\t\t\ttag.html(html);\r\n\t\t\t\t\t\t\t\t$('#' + treeId).treegrid('select', root.id);\r\n\t\t\t\t\t\t\t\tdiv.scrollTop(tr.offset().top - table.offset().top);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t//\t\t\t\t\tvar children = $('#' + treeId).treegrid('getChildren', root.id);\r\n\t//\t\t\t\t\tfor (var i = 0; i<children.length; i++) {\r\n\t//\t\t\t\t\t\tif (root.id == children[i].parent)\r\n\t//\t\t\t\t\t\t\t$('#' + treeId).treegrid('remove', children[i].id);\r\n\t//\t\t\t\t\t}\r\n\t//\t\t\t\t\t$('#' + treeId).treegrid('reload');\r\n\t\t\t\t\t\t$('#' + treeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t\t\t\t\tif(parIds){\r\n\t\t\t\t\t\t\tvar col = parIds.length;\r\n\t\t\t\t\t\t\tfor(var i = 0; i < col; i++){\r\n\t\t\t\t\t\t\t\t_this.treegridCallLater('expand', $('#' + treeId), parIds[i], 20);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.treegridCallLater('select', $('#' + treeId), nodeId, 20);\r\n\t\t\t\t\t\t_this.treedridCallLaterHigliht($('#' + treeId), nodeId, str, 20, selCol);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$('#_' + treeId).focus();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#' + treeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t\t\t\tUtil.alert('Ничего не найдено!');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t$('#' + treeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\tmakeSelection(t, index) {\r\n\t\tif (this.selectedRow[t.attr(\"id\")] != index) {\r\n\t\t\tthis.clickedGrid = t.attr(\"id\");\r\n\t\t\tthis.selectedRow[t.attr(\"id\")] = index;\r\n\t\t\t\r\n\t\t\tthis._child.setValue(t.attr('id'), index);\r\n\t\t\tt.attr('selRows', index);\r\n\t\t}\r\n\t\tvar selCol = t.attr('selectedCol');\r\n\t\tif (selCol) {\r\n\t\t\tvar pIndex = this.pageIndex(t, index);\r\n\t\t\tt.datagrid('selectCell', {index:pIndex,field:selCol});\r\n\t\t}\r\n\t\tvar toolbar_sel = $(t).parents(\".datagrid\").find(\".datagrid-toolbar:first .datagrid-sel\");\r\n\t\t$(toolbar_sel).text((index+1)+\" /\");\r\n\t}\r\n\t\r\n\ttreeCallLater(name, comp, id, count) {\r\n\t\tlet _this = this;\r\n\t\tvar node = comp.tree('find', id);\r\n\t\tif (node != null) {\r\n\t\t\tcomp.tree(name, node.target);\r\n\t\t\treturn;\r\n\t\t} else if (count > 0) {\r\n\t\t\tcount--;\r\n\t\t\tsetTimeout(function(){_this.treeCallLater(name, comp, id, count);}, 800);\r\n\t\t}\r\n\t}\r\n\t\r\n\ttreegridCallLater(name, comp, id, count) {\r\n\t\tlet _this = this;\r\n\t\t//console.log(\"Count = \" + count);\r\n\t\tvar node = comp.treegrid('find', id);\r\n\t\tif (node != null) {\r\n\t\t\tcomp.treegrid(name, id);\r\n\t\t\treturn;\r\n\t\t} else if (count > 0) {\r\n\t\t\tcount--;\r\n\t\t\tsetTimeout(function(){_this.treegridCallLater(name, comp, id, count);}, 800);\r\n\t\t}\r\n\t}\r\n\t\r\n\ttreedridCallLaterHigliht(comp, id, text, count, selCol) {\r\n\t\tlet _this = this;\r\n\t\t//console.log(\"Count = \" + count);\r\n\t\tvar node = comp.treegrid('find', id);\r\n\t\tif (node != null) {\r\n\t\t\tvar tr = $('.datagrid-view2 tr[node-id=' + id + ']');\r\n\t\t\tvar div = tr.closest('.datagrid-body');\r\n\t\t\tvar table = div.children('.datagrid-btable');\r\n\t\t\t_this.lastHiLitTreeTableElement = table;\r\n\t\t\t\r\n\t\t\ttable.find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t\t\r\n\t\t\ttext = Util.sanitizeHtml(text);\r\n\t\t\t\r\n\t\t\tvar colIdx = 0;\r\n\t\t\t$.each(tr.find('td'), function(i, td) {\r\n\t\t\t\tvar tag = $(td).find('.tree-title');\r\n\t\t\t\tif (tag.length == 0) tag = $(td).find('div');\r\n\t\t\t\tvar html = Util.sanitizeHtml(tag.get(0).textContent);\r\n\t\t\t\tvar ind = html.toUpperCase().indexOf(text.toUpperCase());\r\n\t\t\t\tif (ind > -1) {\r\n\t\t\t\t\tif(selCol){\r\n\t\t\t\t\t\tif(colIdx == selCol)\r\n\t\t\t\t\t\t\thtml = html.substring(0, ind) + '<span class=\"higliht\">' + html.substring(ind, ind + text.length) + '</span>' + html.substring(ind + text.length);\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\thtml = html.substring(0, ind) + '<span class=\"higliht\">' + html.substring(ind, ind + text.length) + '</span>' + html.substring(ind + text.length);\r\n\t\t\t\t\ttag.html(html);\r\n\t\t\t\t\tdiv.scrollTop(tr.offset().top - (table.offset().top + _this.heightRange));\r\n\t\t\t\t}\r\n\t\t\t\tcolIdx++;\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} else if (count > 0) {\r\n\t\t\tcount--;\r\n\t\t\tsetTimeout(function(){_this.treedridCallLaterHigliht(comp, id, text, count, selCol);}, 800);\r\n\t\t}\r\n\t}\r\n\r\n\tsetSelection(tbl, val, index){\r\n\t\tif(val.length > 0){\r\n\t\t\tif (this.selectedRow[tbl.attr(\"id\")] != index) {\r\n\t\t\t\tthis.clickedGrid = tbl.attr(\"id\");\r\n\t\t\t\tthis.selectedRow[tbl.attr(\"id\")] = index;\r\n\t\t\t}\r\n\t\t\tvar selIdx = this.selectedRow[tbl.attr(\"id\")];\r\n\t\r\n\t\t\tvar oldVal = tbl.attr('selRows');\r\n\t\t\tif (oldVal != val) {\r\n\t\t\t\tthis._child.setValue(tbl.attr('id'), val);\r\n\t\t\t\ttbl.attr('selRows', val);\r\n\t\t\t\tthis.currentSelectedId = id;\r\n\t\t\t} else {\r\n\t\t\t\tvar id = tbl.attr('id');\r\n\t\t\t\tif (id != null && id != this.currentSelectedId) {\r\n\t\t\t\t\tthis.currentSelectedId = id;\r\n\t\t\t\t\tvar par = {\"cmd\":\"fcs\",\"uid\":id};\r\n\t\t\t\t\tthis.app.post(par);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tselectRow(elem, up){\r\n\t    var t = elem.find('.easyui-datagrid');\r\n\t\t\r\n\t    if (t.datagrid('getPanel').find('.datagrid-row-editing').length > 0) return true;\r\n\t\r\n\t\tvar count = t.datagrid('getRows').length;    // row count\r\n\t    var selected = t.datagrid('getSelected');\r\n\t    if (selected){\r\n\t        var rIndex = t.datagrid('getRowIndex', selected);\r\n\t        rIndex = rIndex + (up ? -1 : 1);\r\n\t        if (rIndex < 0 || rIndex >= count) return true;\r\n\t        t.datagrid('clearSelections');\r\n\t        t.datagrid('selectRow', rIndex);\r\n\t\r\n\t        var index = this.globalIndex(t, rIndex);\r\n\t        this.makeSelection(t, index);\r\n\t    } else {\r\n\t    \tvar rIndex = up ? count-1 : 0;\r\n\t        t.datagrid('selectRow', rIndex);\r\n\t    \t\r\n\t        var index = this.globalIndex(t, rIndex);\r\n\t        this.makeSelection(t, index);\r\n\t    }\r\n\t    return false;\r\n\t}\r\n\t\r\n\tselectColumn(elem, left){\r\n\t    var t = elem.find('.easyui-datagrid');\r\n\t    var selected = t.datagrid('getSelected');\r\n\t\tvar selCol = t.attr('selectedCol');\r\n\t    if (selected && selCol) {\r\n\t        var index = t.datagrid('getRowIndex', selected);\r\n\t    \tvar td = t.datagrid('getCell', {index:index, field:selCol});\r\n\t    \tif (td.parent().hasClass('datagrid-row-editing')) return true;\r\n\t    \tvar next = left ? td.prev('td') : td.next('td');\r\n\t    \tif (!next || next.length == 0) {\r\n\t    \t\treturn true;\r\n\t    \t\t//next = left ? td.parent().find('td:last') : td.parent().find('td:first'); \r\n\t    \t}\r\n\t    \tvar field = next.attr('field');\r\n\t    \tt.datagrid('selectCell', {index:index, field:field});\r\n\t    \tt.attr('selectedCol', field);\r\n\t    \treturn false;\r\n\t    }\r\n\t    return true;\r\n\t}\r\n\t\r\n\tbeginEditCell(elem){\r\n\t    var t = elem.find('.easyui-datagrid');\r\n\t    var selected = t.datagrid('getSelected');\r\n\t\tvar selCol = t.attr('selectedCol');\r\n\t    if (selected && selCol) {\r\n\t        var index = t.datagrid('getRowIndex', selected);\r\n\t    \tvar td = t.datagrid('getCell', {index:index, field:selCol});\r\n\t    \tif (td.parent().hasClass('datagrid-row-editing')) return true;\r\n\t\t\tif (this.endEditing()) {\r\n\t\t\t\tvar realIndex = this.globalIndex(t, index);\r\n\t\t\t\r\n\t\t\t\tvar id = t.attr(\"id\");\r\n\t\t\t\tthis.editingTable = id;\r\n\t\t\t\tthis.editIndex[id] = {index: index, field: selCol, realIndex: realIndex};\r\n\t\t\t\tt.datagrid('editCell', {index:index,field:selCol});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t    }\r\n\t    return true;\r\n\t}\r\n\t\r\n\tupdateTreeTableRow(i, index, row) {\r\n\t\tlet _this = this;\r\n\t\tif ($(\"#\" + i).treegrid('find', index)) {\r\n\t\t\t$(\"#\" + i).treegrid('update',{\r\n\t\t\t\tid: index,\r\n\t\t\t\trow: row\r\n\t\t\t});\r\n\t\t\tif (row.children) {\r\n\t\t\t\t$.each(row.children, function(ri, chrow) {\r\n\t\t\t\t\t_this.updateTreeTableRow(i, chrow.id, chrow);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tpaintTreegridRows(uid) {\r\n\t\tlet _this = this;\r\n\t\tvar par = {\"cmd\":'treegridZebraColors'};\r\n\t\tpar[\"uid\"] = uid;\r\n\t\tpar[\"json\"] = 1;\r\n\t\tpar[\"rnd\"] = Util.rnd();\r\n\t\t\r\n\t\t_this.app.post(par).then(data => {\r\n\t\t\tif (data.zebra1 || data.zebra2) {\r\n\t\t\t\tlet zebra1 = data.zebra1 ? data.zebra1 : \"\";\r\n\t\t\t\tlet zebra2 = data.zebra2 ? data.zebra2 : \"\";\r\n\t\r\n\t\t\t\tif (zebra1 != \"#FFFFFF\" || zebra2 != \"#FFFFFF\") {\r\n\t\t\t\t\tvar rootNode = $('#' + uid).treegrid('getRoot');\r\n\t\t\t\t\tif (rootNode != null) {\r\n\t\t\t\t\t\tvar opts = $('#' + uid).treegrid('options');\r\n\t\t\t\t\t\t_this.viewChild($('#' + uid), opts, rootNode, zebra1, zebra2, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tviewChild(comp, opts, node, zebra1, zebra2, hiddenNodesCount) {\r\n\t\tvar tr = opts.finder.getTr(comp[0], node[opts.idField]);\r\n\t\tvar cell = tr.find('div.datagrid-cell-rownumber');\r\n\t\tvar value = cell.text();\r\n\t\tvar index = parseInt(value) - hiddenNodesCount;\r\n\t\tif (index % 2 == 0) {\r\n\t\t\ttr.css('background', zebra1);\r\n\t\t} else {\r\n\t\t\ttr.css('background', zebra2);\r\n\t\t}\r\n\t\tvar children = this.getMyChildren(comp, node.id);\r\n\t\tif (children.length > 0) {\r\n\t\t\tif (node.state == \"open\") {\r\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\thiddenNodesCount += this.viewChild(comp, opts, children[i], zebra1, zebra2, hiddenNodesCount);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn comp.treegrid('getChildren', node.id).length;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\t\r\n\tgetMyChildren(comp, parentId) {\r\n\t\tvar children = comp.treegrid('getChildren', parentId);\r\n\t\tvar myChildren = [];\r\n\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\tif (children[i].parent == parentId) {\r\n\t\t\t\tmyChildren.push(children[i]);\t\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn myChildren;\r\n\t}\r\n\t\r\n\treloadTables() {\r\n\t\tthis.clickedGrid = \"\";\r\n\t}\r\n\t\r\n\tmakeTreeTable(operation) {\r\n\t\tif (this.selectedTree) {\r\n\t\t\tvar node = this.selectedTree.treegrid('getSelected');\r\n\t\t\tthis.selectedTree.treegrid(operation, node.id);\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetOption(elem, option){\r\n\t\tvar out = null;\r\n\t\tvar opt = $(elem).data('options');\r\n\t\tif (opt != null) {\r\n\t\t\tvar opts = opt.split(',');\r\n\t\t\t$.each(opts, function(i, opt) {\r\n\t\t\t\tvar p = opt.indexOf(':');  \r\n\t\t\t\tvar param=$.trim(opt.substring(0,p));\r\n\t\t\t\tvar val = opt.length>p+1?opt.substring(p+1):'';\r\n\t\t\t\tif(param == option){\r\n\t\t\t\t\tout = val;\r\n\t\t\t\t\treturn out;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\t\r\n\tmakeTree(operation) {\r\n\t\tif (this.selectedTree) {\r\n\t\t\tvar node = this.selectedTree.tree('getSelected');\r\n\t\t\tthis.selectedTree.tree(operation, node.target);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfindNode(treeId, str, trfld, dlg) {\r\n\t\tlet _this = this;\r\n\t\tif (str.length > 0) {\r\n\t\t\tif(_this.searchText == str){\r\n\t\t\t\t_this.searchCount++;\r\n\t\r\n\t\t\t\tif (_this.lastHighlightedNode != null)\r\n\t\t\t\t\t_this.showPath(_this.lastHighlightedNode.parentNode, str, treeId, trfld, dlg, _this.foundNodes, _this.lastHighlightedNode.level, _this.lastHighlightedNode.index, _this.lastHighlightedNode.count);\r\n\t\t\t\telse\r\n\t\t\t\t\t_this.showPath(null, str, treeId, trfld, dlg, _this.foundNodes, 0, 0, 1);\r\n\t\t\t} else {\r\n\t\t\t\t_this.searchText = str;\r\n\t\t\t\t_this.searchCount = 0;\r\n\t\t\t\t_this.foundNodes = null;\r\n\t\t\t\t_this.lastHighlightedNode = null;\r\n\t\r\n\t\t\t\tif (dlg) {\r\n\t\t\t\t\tUtil.blockDialog(dlg);\r\n\t\t\t\t\t_this.blockDlg = true;\r\n\t\t\t\t\tconsole.log(\"block on line 1992\");\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar par = {\"treeFind\":treeId, \"title\":str};\r\n\t\t\t\t\r\n\t\t\t\t_this.app.post(par).then(data => {\r\n\t\t\t\t\tif(data.foundNodes){\r\n\t\t\t\t\t\t_this.foundNodes = data.foundNodes;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_this.lastHighlightedNode = null;\r\n\t\t\t\t\t\t_this.showPath(null, str, treeId, trfld, dlg, _this.foundNodes, 0, 0, 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#' + treeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t\t\t\t\talert('Ничего не найдено!');\r\n\t\t\t\t\t\tif(dlg){\r\n\t\t\t\t\t\t\tdlg.unblock();\r\n\t\t\t\t\t\t\t_this.blockDlg = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t$('#' + treeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t}\r\n\t\t$('#_' + treeId).focus();\r\n\t}\r\n\t\r\n\tgetNode(treeId, parentNode, level, index, count) {\r\n\t\tif (parentNode == null) {\r\n\t\t\tif (index > 0)\r\n\t\t\t\treturn null;\r\n\t\t\telse\r\n\t\t\t\treturn {\r\n\t\t\t\t\t'node' : $('#' + treeId).tree('getRoot'),\r\n\t\t\t\t\t'parent' : null,\r\n\t\t\t\t\t'index' : 0,\r\n\t\t\t\t\t'level' : 0,\r\n\t\t\t\t\t'count' : 1\r\n\t\t\t\t};\r\n\t\t} else {\r\n\t\t\tif (index < count) {\r\n\t\t\t\tvar children = this.getDirectTreeNodeChildren(treeId, parentNode);\r\n\t\t\t\treturn {\r\n\t\t\t\t\t'node' : children[index],\r\n\t\t\t\t\t'parent' : parentNode,\r\n\t\t\t\t\t'index' : index,\r\n\t\t\t\t\t'level' : level,\r\n\t\t\t\t\t'count' : count\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tvar parentParentNode = $('#' + treeId).tree('getParent', parentNode.target);\r\n\t\t\t\tif (parentParentNode != null) {\r\n\t\t\t\t\tvar children = this.getDirectTreeNodeChildren(treeId, parentParentNode);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar parentIndex = -1;\r\n\t\t\t\t\tfor(j = 0; j < children.length; j++) {\r\n\t\t\t\t\t\tif (parentNode.id == children[j].id) {\r\n\t\t\t\t\t\t\tparentIndex = j;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn this.getNode(treeId, parentParentNode, level - 1, parentIndex + 1, children.length);\r\n\t\t\t\t} else \r\n\t\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetDirectTreeNodeChildren(treeId, node) {\r\n\t\tvar children = $('#' + treeId).tree('getChildren', node.target);\r\n\t\tvar directChildren = [];\r\n\t\tfor (var i=0; i<children.length; i++) {\r\n\t\t\tif (children[i].parent == node.id)\r\n\t\t\t\tdirectChildren[directChildren.length] = children[i];\r\n\t\t}\r\n\t\treturn directChildren;\r\n\t}\r\n\t\r\n\tshowPath(parentNode, str, treeId, trfld, dlg, foundNodes, level, indexInParent, count) {\r\n\t\tlet _this = this;\r\n\t\t\r\n\t\tvar fullTreeId = (trfld) ? ('trfld'+treeId) : treeId;\r\n\t\tvar nodeStruct = this.getNode(fullTreeId, parentNode, level, indexInParent, count);\r\n\t\t\r\n\t\t\r\n\t\tif (nodeStruct != null) {\r\n\t\t\tparentNode = nodeStruct.parent;\r\n\t\t\tindexInParent = nodeStruct.index;\r\n\t\t\tcount = nodeStruct.count;\r\n\t\t\tlevel = nodeStruct.level;\r\n\t\t\tvar node = nodeStruct.node;\r\n\t\t\t\r\n\t\t\tvar curData = null;\r\n\t\t\t\r\n\t\t\tfor(i=0; i< foundNodes.length; i++){\r\n\t\t\t\tif(foundNodes[i].node == node.id && !foundNodes[i].done){\r\n\t\t\t\t\tfoundNodes[i].done = true;\r\n\t\t\t\t\tcurData = foundNodes[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (curData == null) {\r\n\t\t\t\tfor(i=0; i< foundNodes.length; i++) {\r\n\t\t\t\t\tif (foundNodes[i].parentNodes && !foundNodes[i].done) {\r\n\t\t\t\t\t\tvar parIds = foundNodes[i].parentNodes.split(\",\"); \r\n\t\t\t\r\n\t\t\t\t\t\tif(node.id == parIds[level]) {\r\n\t\t\t\t\t\t\tif (node.state == 'open') {\r\n\t\t\t\t\t\t\t\tvar children = this.getDirectTreeNodeChildren(fullTreeId, node);\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t_this.showPath(node, str, treeId, trfld, dlg, foundNodes, level + 1, 0, children.length);\r\n\t\t\t\t\t\t\t\t}, 50);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tonTreeExpand = function() {\r\n\t\t\t\t\t\t\t\t\tvar children = _this.getDirectTreeNodeChildren(fullTreeId, node);\r\n\t\t\t\t\t\t\t\t\t_this.showPath(node, str, treeId, trfld, dlg, foundNodes, level + 1, 0, children.length);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t_this.treeCallLater('expand', $('#' + fullTreeId), node.id, 20);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t_this.showPath(parentNode, str, treeId, trfld, dlg, foundNodes, level, indexInParent + 1, count);\r\n\t\t\t\t}, 50);\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\t_this.lastHighlightedNode = {\r\n\t\t\t\t\t'parentNode' : parentNode,\r\n\t\t\t\t\t'level' : level,\r\n\t\t\t\t\t'index' : indexInParent,\r\n\t\t\t\t\t'count' : count\r\n\t\t\t\t};\r\n\t\t\t\tvar nodeId = curData.node;\r\n\t\t\t\tvar root = $('#' + fullTreeId).tree('getRoot');\r\n\t\t\t\tvar rootChildren = $('#' + fullTreeId).tree('getChildren', root.target);\r\n\t\t\t\t$('#' + fullTreeId).find('.higliht').removeClass('higliht').addClass('nohigliht');\r\n\t\t\t\t_this.treeCallLater('select', $('#' + fullTreeId), nodeId, 20);\r\n\t\t\t\t_this.treeCallLaterHigliht($('#' + fullTreeId), nodeId, str, 20, trfld, dlg);\r\n\t\r\n\t\t\t\tif(dlg){\r\n\t\t\t\t\tdlg.unblock();\r\n\t\t\t\t\t_this.blockDlg = false;\r\n\t\t\t\t\tconsole.log(\"unblock on line 2033\");\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t$('#_' + treeId).focus();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor(i=0;i<foundNodes.length; i++){\r\n\t\t\t\tdelete foundNodes[i].done;\r\n\t\t\t}\r\n\t\t\t_this.lastHighlightedNode = null;\r\n\t\t\t\r\n\t\t\t_this.showPath(null, str, treeId, trfld, dlg, foundNodes, 0, 0, 1);\r\n\t\t}\r\n\t}\t\t\r\n}\r\n","export class TooltipOps {\r\n\t\r\n\tconstructor() {\r\n\t}\r\n\t\r\n\tinit() {\r\n\t}\r\n\t\r\n\tstatic addDatagridTooltip(tbl) {\r\n\t\tvar headerCells = tbl.datagrid('getPanel').find('div.datagrid-header td[field] div.datagrid-cell:not(:empty)');\r\n\t\theaderCells.tooltip({\r\n\t\t\tposition : 'top',\r\n\t\t\tcontent : function(){\r\n\t\t\t\tvar content = this.getElementsByClassName('tableColumnTooltipText')[0];\t\t\t\r\n\t\t\t\tif(content){\r\n\t\t\t\t\tvar pElem = content.getElementsByTagName('p')[0];\r\n\t\t\t\t\tvar fontElem = content.getElementsByTagName('font')[0];\r\n\t\t\t\t\tif(fontElem){\r\n\t\t\t\t\t\tvar color = fontElem.color;\r\n\t\t\t\t\t\tsetAllChildrenColor(pElem, color);\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn content.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonShow : function(){\r\n\t\t\t\tvar content = this.getElementsByClassName('tableColumnTooltipText')[0];\r\n\t\t\t\tif(content){\r\n\t\t\t\t\tvar t = $(this); \r\n\t\t\t\t\t$(this).tooltip('tip').css({\r\n\t\t\t\t\t\tbackgroundColor: '#fafad2',\r\n\t\t\t\t\t\tborderColor: '#666',\r\n\t\t\t\t\t}).unbind().bind('mouseenter', function(){\t\t\t\t\t            \t   \r\n\t\t\t\t\t\tt.tooltip('show');\r\n\t\t\t\t\t}).bind('mouseleave', function() {\r\n\t\t\t\t\t\tt.tooltip('hide');\t\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(this).tooltip(\"destroy\");\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar cells = tbl.datagrid('getPanel').find('div.datagrid-body td[field] div.datagrid-cell:not(:empty)');\r\n\t\tcells.tooltip({\r\n\t\t\tposition : 'top',\r\n\t\t\tcontent: function(){\t\r\n\t\t\t\tvar scrWidth = this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0] ? this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0].scrollWidth : this.lastChild.parentNode.scrollWidth;\r\n\t\t\t\tvar clWidth = this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0]  ? this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0].clientWidth : this.lastChild.parentNode.clientWidth;\r\n\t\t\t\tif(scrWidth > clWidth){\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar tp = this.lastChild.textContent;\r\n\t\t\t\t\tif(!tp){\r\n\t\t\t\t\t\ttp = this.lastChild.getElementsByTagName(\"INPUT\")[0].value;\r\n\t\t\t\t\t}\t    \t\t\t\t \r\n\t\t\t\t\treturn tp;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonShow: function(){\r\n\t\t\t\tvar scrWidth = this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0] ? this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0].scrollWidth : this.lastChild.parentNode.scrollWidth;\r\n\t\t\t\tvar clWidth = this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0]  ? this.lastChild.parentNode.getElementsByTagName(\"INPUT\")[0].clientWidth : this.lastChild.parentNode.clientWidth;\r\n\t\t\t\tif(scrWidth > clWidth){\r\n\t\t\t\t\tvar t = $(this); \r\n\t\t\t\t\t$(this).tooltip('tip').css({\r\n\t\t\t\t\t\tbackgroundColor: '#fafad2',\r\n\t\t\t\t\t\tborderColor: '#666',\r\n\t\t\t\t\t}).unbind().bind('mouseenter', function(){\t\t\t\t\t            \t   \r\n\t\t\t\t\t\tt.tooltip('show');\r\n\t\t\t\t\t}).bind('mouseleave', function() {\r\n\t\t\t\t\t\tt.tooltip('hide');\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if($(this).tooltip){\r\n\t\t\t\t\t$(this).tooltip(\"destroy\");\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","export class Translation {\r\n\tstatic translation = {};\r\n\r\n\tstatic init(lang) {\r\n\t\tif (lang == 'kz') {\r\n\t\t\tthis.translation['ok'] = 'OK';\r\n\t\t\tthis.translation['cancel'] = 'Болдырмау';\r\n\t\t\tthis.translation['print'] = 'Баспаға';\r\n\t\t\tthis.translation['continue'] = 'Жалғастыру';\r\n\t\t\tthis.translation['continue2'] = 'Енгізуді жалғастыру';\r\n\t\t\tthis.translation['save'] = 'Сақтау';\r\n\t\t\tthis.translation['errors'] = 'Мәліметтерді енгізу қателері';\r\n\t\t\tthis.translation['askNextStep'] = 'Мәліметтерді ары қарай өңдеуге жіберуге сенімдісіз бе?';\r\n\t\t\tthis.translation['ignore'] = 'Елемеу';\r\n\t\t\tthis.translation['error'] = 'Қате';\r\n\t\t\tthis.translation['wait'] = 'Күте тұрыңыз...';\r\n\t\t\tthis.translation['close'] = 'Жабу';\r\n\t\t\tthis.translation['saving'] = 'Мәліметтерді сақтау...';\r\n\t\t\tthis.translation['canceling'] = 'Өзгерiстерді болдырмау...';\r\n\t\t\tthis.translation['removeProcess'] = 'Тапсырманы жоюға сенімдісіз бе?';\r\n\t\t\tthis.translation['deleting'] = 'Жою...';\r\n\t\t\tthis.translation['procPerformedMessage'] = 'Процедурасы орындалуда';\r\n\t\t\tthis.translation['rptGenerateMessage'] = 'Есеп қалыптастырылуда';\r\n\t\t\tthis.translation['ifcNotExistMessage'] = 'Интерфейс тағайындалмаған';\r\n\t\t\tthis.translation['passChange'] = 'Құпия сөзді өзгерту';\r\n\t\t\tthis.translation['change'] = 'Өзгерту';\r\n\t\t} else { \r\n\t\t\tthis.translation['ok'] = 'OK';\r\n\t\t\tthis.translation['cancel'] = 'Отмена';\r\n\t\t\tthis.translation['print'] = 'Печать';\r\n\t\t\tthis.translation['continue'] = 'Продолжить';\r\n\t\t\tthis.translation['continue2'] = 'Продолжить ввод';\r\n\t\t\tthis.translation['save'] = 'Сохранить';\r\n\t\t\tthis.translation['errors'] = 'Ошибки заполнения данных';\r\n\t\t\tthis.translation['saving'] = 'Сохранение данных...';\r\n\t\t\tthis.translation['askNextStep'] = 'Вы уверены, что хотите передать данные в дальнейшую обработку?';\r\n\t\t\tthis.translation['ignore'] = 'Игнорировать';\r\n\t\t\tthis.translation['error'] = 'Ошибка';\r\n\t\t\tthis.translation['wait'] = 'Подождите...';\r\n\t\t\tthis.translation['close'] = 'Закрыть';\r\n\t\t\tthis.translation['canceling'] = 'Отмена внесенных изменений...';\r\n\t\t\tthis.translation['removeProcess'] = 'Вы уверены, что хотите удалить задачу?';\r\n\t\t\tthis.translation['deleting'] = 'Удаление...';\r\n\t\t\tthis.translation['procPerformedMessage'] = 'Процедура выполняется';\r\n\t\t\tthis.translation['rptGenerateMessage'] = 'Отчет формируется';\r\n\t\t\tthis.translation['ifcNotExistMessage'] = 'Не задан интерфейс';\r\n\t\t\tthis.translation['passChange'] = 'Сменя пароля';\r\n\t\t\tthis.translation['change'] = 'Изменить';\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic get(key) {\r\n\t\treturn translation[key];\r\n\t}\r\n}","import {InterfaceController} from './ifc.js';\r\nimport {Translation} from './translation.js';\r\n\r\nexport class Util {\r\n\tstatic INFO = 0;\r\n\tstatic ERROR = 1;\r\n\tstatic WARNING = 2;\r\n\t\r\n\tstatic DLG_ALERT = 0;\r\n\tstatic DLG_CONFIRM = 10;\r\n\t\r\n\tstatic DLG_NO_SEND = 1;\r\n\tstatic DLG_TREE_FIELD = 2;\r\n\tstatic DLG_OPEN_AT_START = 3;\r\n\tstatic DLG_POPUP_IFC = 4;\r\n\tstatic DLG_CHANGE_PD = 5;\r\n\tstatic DLG_ERRORS = 6;\r\n\tstatic DLG_POPUP_ERRORS = 7;\r\n\t\r\n\tstatic alertOldZindex;\r\n\tstatic dialogZindex = 345000;\r\n\tstatic messagerZindex = 350000;\r\n\tstatic alertCommand = false;\r\n\tstatic alertIsLogout = false;\r\n\t\r\n\tstatic restUrl = \"\";\r\n\r\n\tstatic rnd() {\r\n\t\tvar array = new Uint32Array(1);\r\n\t\tvar crypto = window.crypto || window.msCrypto;\r\n\t\tcrypto.getRandomValues(array);\r\n\t\treturn array[0];\r\n\t};\r\n\t\r\n\tstatic generateGUID() {\r\n\t\tvar array = new Uint16Array(8);\r\n\t\tvar crypto = window.crypto || window.msCrypto;\r\n\t\tcrypto.getRandomValues(array);\r\n\t\t\r\n\t\tvar res = ('000' + array[0].toString(16)).substr(-4) +\r\n\t\t\t('000' + array[1].toString(16)).substr(-4) + '-' +\r\n\t\t\t('000' + array[2].toString(16)).substr(-4) + '-' +\r\n\t\t\t('000' + array[3].toString(16)).substr(-4) + '-' +\r\n\t\t\t('000' + array[4].toString(16)).substr(-4) + '-' +\r\n\t\t\t('000' + array[5].toString(16)).substr(-4) +\r\n\t\t\t('000' + array[6].toString(16)).substr(-4) +\r\n\t\t\t('000' + array[7].toString(16)).substr(-4);\r\n\t\t\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\tstatic parseHash(url) {\r\n\t\treturn (function() {\r\n\t\t\t\tvar ret = {}, seg = url.replace(/^\\#/, '').split('&');\r\n\t\t\t\t\r\n\t\t\t\tfor (var i=0; i < seg.length; i++) {\r\n\t\t\t\t\tif (!seg[i]) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar s = seg[i].split('=');\r\n\t\t\t\t\tret[s[0]] = s[1];\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\t})();\r\n\t};\r\n\t\r\n\tstatic makeUrl(pars) {\r\n\t\tvar url = window.mainUrl;\r\n\t\tfor (var prop in pars) {\r\n\t\t\turl += \"&\" + encodeURIComponent(prop) + \"=\" + encodeURIComponent(pars[prop]);\r\n\t\t}\r\n\t\treturn url;\r\n\t};\r\n\t\r\n\tstatic delay(ms) {\r\n\t  return new Promise((resolve, reject) => {\r\n\t    setTimeout(resolve, ms);\r\n\t  });\r\n\t};\r\n\t\r\n\tstatic slide(msg) {\r\n\t\t$.messager.show({\r\n\t\t\tmsg: msg,\r\n\t\t\ttimeout: 8000,\r\n\t\t\tshowType:'slide'\r\n\t\t});\r\n\t}\r\n\tstatic alert(msg, type, command, isLogout) {\r\n\t\tlet _this = this;\r\n\t\tlet language = \"ru\";\r\n\r\n\t\t_this.alertCommand = command;\r\n\t\t_this.alertIsLogout = isLogout;\r\n\t\t\r\n\t\t// здесь код поменял Жаркын, чтобы узнать на каком языке показывать текст =========\r\n\t\tif($('#topLangKz').hasClass(\"selected\")) {\r\n\t\t\tlanguage = \"kz\";\r\n\t\t} else {\r\n\t\t\tlanguage = \"ru\";\r\n\t\t}\r\n\r\n\t\tif (msg == null || msg.length == 0) msg = language == \"ru\" ? \"-Пустое сообщение-\" : \"- Бос хабарлама-\";\r\n\t\r\n\t\tvar alertTitle = '';\r\n\t\tvar icon='';\r\n\t\r\n\t\tif(type == _this.ERROR){\r\n\t\t\talertTitle = language == \"ru\" ? 'Ошибка' : 'Қателік';\r\n\t\t\ticon='error';\r\n\t\t}\r\n\t\telse if(type == _this.WARNING){\r\n\t\t\talertTitle = language == \"ru\" ? 'Предупреждение' : 'Ескерту';\r\n\t\t\ticon='warning';\r\n\t\t}\r\n\t\telse if(type == _this.INFO){\r\n\t\t\talertTitle = language == \"ru\" ? 'Уведомление' : 'Хабарлама';\r\n\t\t\ticon='info';\r\n\t\t}\r\n\t\r\n\t\tvar a = msg.length;\r\n\t\tvar width = '200';\r\n\t\tif (a < 20){\r\n\t\t\twidth = '200';\r\n\t\t} else if (a<61) {\r\n\t\t\twidth = '450'\r\n\t\t} else {\r\n\t\t\twidth = '600'\r\n\t\t}\r\n\t\tmsg = \"<div style='text-align:left'>\" + (msg.replace ? msg.replace(/\\n/g, '<br/>') : msg) + \"</div>\";\r\n\t\r\n\t\tvar oldZindex = $.fn.window.defaults.zIndex;\r\n\t\t_this.alertOldZindex = oldZindex;\r\n\t\t$.fn.window.defaults.zIndex = _this.messagerZindex++;\r\n\t\t$.messager.defaults.zIndex = ++_this.messagerZindex;\r\n\t\r\n\t\tInterfaceController.popDlg.push(0);\r\n\t\tInterfaceController.popDlgType.push(_this.DLG_ALERT);\r\n\t\t$.messager.alert({\r\n\t\t\tclosable: false,\r\n\t\t\ttitle: alertTitle,\r\n\t        msg:msg,\r\n\t        width: width,\r\n\t        height: a>3000 ? 500 : 'auto',\r\n\t        icon:icon,\r\n\t        showType:null,\r\n\t        fn: function(e){\r\n\t        \tif(InterfaceController.popDlgType[InterfaceController.popDlgType.length-1] == _this.DLG_ALERT){\r\n\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t        \tInterfaceController.popDlgType.pop();\r\n\t        \t}\r\n\t        \t$.fn.window.defaults.zIndex = oldZindex;\r\n\t        \tif (command) {\r\n\t        \t\tif (isLogout) {\r\n\t        \t\t\t_this.logout();\r\n\t        \t\t} else {\r\n\t        \t\t\t_this.query({\"alert\":\"0\"});\r\n\t        \t\t}\r\n\t        \t}\r\n\t        }\r\n\t    });\r\n\t}\r\n\t\r\n\tstatic confirmMessage(msg, resolve) {\r\n\t\tlet _this = this;\r\n\t\tlet myTitle = \"Сообщение\",\r\n\t\t\tokay = \"Да\",\r\n\t\t\tcancel = \"Отмена\";\r\n\r\n\t\tvar a = msg.length;\r\n\t\tvar width = '200';\r\n\t\tif (a<20){\r\n\t\t\twidth = '200';\r\n\t\t\tmsg = \"<div style='text-align:left'>\"+msg+\"</div>\";\r\n\t\t} else if (a<61) {\r\n\t\t\twidth = '450'\r\n\t\t} else {\r\n\t\t\twidth = '600'\r\n\t\t}\r\n\t\tvar oldZindex = $.fn.window.defaults.zIndex;\r\n\t\t_this.alertOldZindex = oldZindex;\r\n\t\r\n\t\t$.fn.window.defaults.zIndex = _this.messagerZindex++;\r\n\t\t$.messager.defaults.zIndex = ++_this.messagerZindex;\r\n\t\t\r\n\t\tif (typeof resolve !== \"function\") {\r\n\t\t\tInterfaceController.popDlg.push(0);\r\n\t\t\tInterfaceController.popDlgType.push(_this.DLG_CONFIRM);\r\n\t\t}\r\n\t\t// здесь код поменял Жаркын, чтобы узнать на каком языке показывать текст =========\r\n\t\tif($('#topLangKz').hasClass(\"selected\")) {\r\n\t\t\tmyTitle = \"Хабарлама\";\r\n\t\t\tokay = \"Ия\";\r\n\t\t\tcancel = \"Болдырмау\";\r\n\t\t} else {\r\n\t\t\tmyTitle = \"Сообщение\";\r\n\t\t\tokay = \"Да\";\r\n\t\t\tcancel = \"Отмена\";\r\n\t\t}\r\n\r\n\t\t$.messager.confirm({\r\n\t\t\ttitle: myTitle,\r\n\t\t\tok: okay,\r\n\t\t\tcancel: cancel,\r\n\t        msg:msg,\r\n\t        width: width,\r\n\t        height: a>3000 ? 500 : 'auto',\r\n\t        icon:'question',\r\n\t        showType:null,\r\n\t        fn: (typeof resolve === \"function\") ? resolve : function(e){\r\n\t        \t$.fn.window.defaults.zIndex = oldZindex;\r\n\t        \tif(InterfaceController.popDlgType[InterfaceController.popDlgType.length-1] == _this.DLG_CONFIRM){\r\n\t        \t\tInterfaceController.popDlg.pop();\r\n\t\t        \tInterfaceController.popDlgType.pop();\r\n\t        \t}\r\n\t    \t\tif (e) {\r\n\t    \t\t\t_this.query({\"confirm\":\"3\"});\r\n\t    \t\t} else {\r\n\t    \t\t\t_this.query({\"confirm\":\"4\"});\r\n\t    \t\t}\r\n\t    \t}\r\n\t    });\r\n    }\r\n\t\r\n\tstatic blockPage(title) {\r\n\t\tif (typeof title == 'undefined') {\r\n\t\t\ttitle = Translation.translation['wait'];\r\n\t\t}\r\n\t\t$('body').block({\r\n\t\t\tmessage: '<img src=\"'+window.contextName+'/jsp/media/img/loader.gif\"><h1 style=\"color:#fff;font-size:16px;margin-top:10px;\">'+title+'</h1>', \r\n\t\t\toverlayCSS: {\r\n\t\t\t\tbackgroundColor: '#000',\r\n\t\t\t\topacity: 0.3,\r\n\t\t\t\tcursor: 'wait'\r\n\t\t\t},\r\n\t\t\tcss: {\r\n\t\t\t\tborder: 'none',\r\n\t\t\t\twidth: '10%',\r\n\t\t\t\tpadding: '15px',\r\n\t\t\t\tbackgroundColor: '#000',\r\n\t\t\t\t'border-radius': '10px',\r\n\t\t\t\tcolor: '#fff'\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\t\r\n\tstatic blockDialog(dlg, title) {\r\n\t\tif (typeof title == 'undefined') {\r\n\t\t\ttitle = Translation.translation['wait'];\r\n\t\t}\r\n\t\tdlg.block({\r\n\t\t\tmessage: '<img src=\"'+window.contextName+'/jsp/media/img/loader.gif\"><h1 style=\"color:#fff;font-size:16px;margin-top:10px;\">'+title+'</h1>', \r\n\t\t\toverlayCSS: {\r\n\t\t\t\tbackgroundColor: '#000',\r\n\t\t\t\topacity: 0.3,\r\n\t\t\t\tcursor: 'wait'\r\n\t\t\t},\r\n\t\t\tcss: {\r\n\t\t\t\tborder: 'none',\r\n\t\t\t\twidth: '10%',\r\n\t\t\t\tpadding: '15px',\r\n\t\t\t\tbackgroundColor: '#000',\r\n\t\t\t\t'border-radius': '10px',\r\n\t\t\t\tcolor: '#fff'\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\tstatic logErrorInfo(msg, err) {\r\n\t\tconsole.log(msg);\r\n\t\t\r\n\t\tif (console.trace)\r\n\t\t\tconsole.trace();\r\n\t\tif (err.stack)\r\n\t\t\tconsole.log(err.stack);\r\n\t}\r\n\r\n\tstatic sanitizeHtml(s) {\r\n\t\treturn this.encodeHTML(s).replace('/\\r/g', '').replace(/\\n/g, '');\r\n\t}\r\n\t\r\n\tstatic encodeHTML(s) {\r\n\t    return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&apos;')\r\n\t    \t\t.replace(/\\//g,'&#47;').replace(/\\\\/g,'&#92;');\r\n\t}\r\n\tstatic openDocument(id, ext, fn) {\r\n\t\tvar url = Util.restUrl;\r\n\t\tif (ext == null && fn == null) {\r\n\t\t\turl += \"&trg=frm&cmd=opf&fn=\" + encodeURIComponent(id);\r\n\t\t\tif (url.indexOf(\"/\") > 0) url = \"/\" + url;\r\n\t\t\turl += \"&rnd=\" + Util.rnd();\r\n\t\t} else {\r\n\t\t\turl += \"&sfunc&cls=XmlUtil&name=getHelpFile&ext=\" + ext + \"&fn=\" + encodeURIComponent(fn) + \"&arg0=\" + id + \"&rnd=\" + Util.rnd();\r\n\t\t}\r\n\t\t$('#report_frame').attr('src', url);\r\n\t}\r\n\r\n\tstatic query(params) {\r\n\t\treturn fetch(this.restUrl, {\r\n\t\t\tmethod: 'POST',\r\n\t    \tcredentials: 'include',\r\n\t\t\tbody: $.param(params)\r\n\t    });\r\n\t}\r\n\r\n\tstatic post2(par) {\r\n\t\tlet _this = this; \r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t$.post(_this.restUrl, par, resolve, 'json');\r\n\t\t});\r\n\t}\r\n\r\n\t\r\n\tstatic post(par) {\r\n\t\tlet _this = this; \r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t_this.query(par).then(response => {\r\n\t\t\t\tresponse.json().then(json => {\r\n\t\t\t\t\tDataChecker.checkData(json).then(data => {\r\n\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tstatic logout() {\r\n\t\tthis.post({\"cmd\":\"ext\", \"json\":1}).then(data => {\r\n\t\t\twindow.location.href = window.contextName + \"/qyzmet/login.jsp?rnd=\" + Util.rnd();\r\n\t\t});\r\n\t}\r\n\t\r\n\tstatic playNoteSound() {\r\n\t}\r\n\t\r\n\tstatic b64DecodeUnicode(str) {\r\n\t    return decodeURIComponent(atob(str).split('').map(function(c) {\r\n\t        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n\t    }).join(''));\r\n\t}\r\n\t\r\n\tstatic b64EncodeUnicode(str) {\r\n\t    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,\r\n\t        function toSolidBytes(match, p1) {\r\n\t            return String.fromCharCode('0x' + p1);\r\n\t    }));\r\n\t}\r\n}\r\n\r\nexport class DataChecker {\r\n\tstatic checkData(data) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (data && data.session && data.session == \"off\") {\r\n\t\t\t\twindow.location.href = window.contextName + \"/qyzmet/login.jsp?rnd=\" + Util.rnd();\r\n\t\t\t\treject(data);\r\n\t\t\t}\r\n\t\t\tresolve(data);\r\n\t\t});\r\n\t}\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {PortletApp} from './main.js';\r\nimport {InterfaceController} from './ifc.js';\r\nimport {Util} from './util.js';\r\nimport {Login} from './login.js';\r\n\r\nexport {PortletApp, InterfaceController, Util, Login}\r\n"],"names":[],"sourceRoot":""}